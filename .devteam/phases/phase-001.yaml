phase_id: 1
description: "Fixes for CR-205 (invite error handling), CR-206 (language code mismatch toDbLocale), CR-207 (WhatsApp template disconnect)"
status: completed
features:
  - id: F140
    name: "Invite mutation error handling fix"
    cr: CR-205
    status: completed
  - id: F141
    name: "Language code mismatch fix (toDbLocale) + WhatsApp template reset"
    cr: CR-206
    status: completed
  - id: F142
    name: "WhatsApp template disconnect fix"
    cr: CR-207
    status: completed
artifacts_produced:
  - docs/specs/SPEC_F140_F141_F142.yaml
  - docs/arch/ARCH_M038.yaml
  - docs/plans/PLAN_P038.yaml
  - docs/qa/QA_PLAN_009.yaml
commits:
  - {hash: "6681194", message: "fix(invite): show server error message and suppress duplicate alert (CR-205)"}
  - {hash: "73cc06e", message: "revert: remove CR-206 (F141) changes from Phase 1 - moved to Phase 2"}
  - {hash: "195cd95", message: "fix(i18n): add toDbLocale mapping to fix language code mismatch in collections (CR-206)"}
  - {hash: "396b23c", message: "fix(settings): reset whatsapp_template on language switch and initialized flag (CR-206)"}
  - {hash: "1e609f9", message: "fix(invite): use ward template and wardLanguage in InviteManagementSection (CR-207)"}
  - {hash: "ea0461f", message: "docs(code): update CODE_LEDGER with Batch 23 Phase 1 commits"}
  - {hash: "ca8915d", message: "docs(code): update CODE_LEDGER with corrected CR-206 commits"}
  - {hash: "151b245", message: "test(batch23): add tests for F140 and F142 (50 tests)"}
  - {hash: "f8b2194", message: "test(batch23): update TEST_CONSOLIDATED"}
  - {hash: "17feed7", message: "fix(test): update batch19 assertions to match toDbLocale() (R-1)"}
  - {hash: "9b52184", message: "docs(code): update CODE_LEDGER hash for R-1 test fix"}
decisions:
  - "CR-206: toDbLocale() mapping instead of seed migration (data already exists with en-US/es-ES)"
  - "CR-207: useQuery ['ward', wardId] shares cache with whatsapp.tsx"
handoff_notes: "Phase 2 pending: CR-204 (Supabase Edge Function HTML rendering - text/plain override)"
