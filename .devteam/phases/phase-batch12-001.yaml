phase_id: 1
description: "Add integration tests covering core user flows (CR-139, F082)"
status: completed
features: [{id: F082, name: "Integration Tests", status: completed}]
artifacts_produced:
  - "docs/specs/SPEC_F082.yaml"
  - "docs/arch/ARCH_M023.yaml"
  - "docs/plans/PLAN_P023.yaml"
  - "docs/qa/QA_PLAN_012.yaml"
  - "src/__tests__/integration/setup-integration.ts"
  - "src/__tests__/integration/hooks-supabase.integration.test.ts"
  - "src/__tests__/integration/permissions-roles.integration.test.ts"
  - "src/__tests__/integration/sync-realtime.integration.test.ts"
  - "src/__tests__/integration/sunday-types-auto.integration.test.ts"
  - "src/__tests__/integration/speech-lifecycle.integration.test.ts"
commits:
  - {hash: "7328fd5", message: "feat(auth): export AuthContext const for integration test wrapper (CR-139)"}
  - {hash: "52dbb00", message: "test(integration): add shared test infrastructure with TestWrapper and mock factories (CR-139)"}
  - {hash: "bc14ca4", message: "refactor(integration): add renderHook/act/waitFor using react-test-renderer (CR-139)"}
  - {hash: "6f75162", message: "test(integration): add hooks-supabase integration tests for 9 hooks with ReactQuery (CR-139)"}
  - {hash: "88f2dfe", message: "test(integration): add permissions-roles integration tests for RBAC matrix (CR-139)"}
  - {hash: "5c7b01c", message: "test(integration): add sync-realtime integration tests for offline queue and connection (CR-139)"}
  - {hash: "c63fc52", message: "test(integration): add sunday-types-auto integration tests for auto-assignment rules (CR-139)"}
  - {hash: "48562ca", message: "test(integration): add speech-lifecycle integration tests for status transitions (CR-139)"}
  - {hash: "0781c5d", message: "docs(tests): update TEST_CONSOLIDATED with F082 integration tests (107 new tests)"}
  - {hash: "5434985", message: "docs(ledger): update CODE_LEDGER with CR-139 integration test commits (CHG-273 to CHG-281)"}
decisions:
  - "ADR-057: Chainable Supabase mock via Proxy pattern"
  - "ADR-058: TestWrapper uses AuthContext.Provider directly (not AuthProvider)"
  - "ADR-059: vi.mock() called per test file (not in shared setup)"
  - "ADR-060: Export AuthContext const for direct use in tests"
  - "Used react-test-renderer for renderHook/act/waitFor instead of @testing-library/react-native (node env constraint)"
  - "Reorganized test categories around domain boundaries instead of architectural layers"
handoff_notes: "107 integration tests added covering hooks+supabase, permissions, sync/offline, sunday types, and speech lifecycle. 16/30 SPEC ACs require react-native runtime for component rendering (deferred to future E2E phase). All 3649 tests passing."
