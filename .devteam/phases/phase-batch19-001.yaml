phase_id: 1
description: "Data model & architecture: language control, pianist/conductor split, optional 2nd speech, password reset bug"
status: completed
features:
  - id: F116
    name: "Separate language control: app (per-user) vs ward"
    cr_id: CR-178
    status: completed
  - id: F117
    name: "Split Music actor type into Pianist and Conductor"
    cr_id: CR-180
    status: completed
  - id: F118
    name: "Optional 2nd speech toggle per Sunday"
    cr_id: CR-181
    status: completed
  - id: F119
    name: "Fix password reset redirect showing HTML as plain-text"
    cr_id: CR-191
    status: completed
artifacts_produced:
  - "docs/specs/SPEC_F116_F119.yaml"
  - "docs/arch/ARCH_M032.yaml"
  - "docs/plans/PLAN_P032.yaml"
  - "docs/qa/QA_PLAN_021.yaml"
commits:
  - {hash: "59023f2", message: "feat(db): migration 017 split can_music (F117)"}
  - {hash: "07e499f", message: "feat(db): migration 018 has_second_speech (F118)"}
  - {hash: "1ee6c93", message: "feat(types): MeetingActor + SundayAgenda updates (F117+F118)"}
  - {hash: "b3602d9", message: "feat(auth): language control split + Observer Settings (F116)"}
  - {hash: "ae974a5", message: "feat(actors): useActors + ActorSelector + AgendaForm (F117)"}
  - {hash: "edee1fc", message: "feat(i18n): WhatsApp placeholders + ward language topics (F116)"}
  - {hash: "02f6dcc", message: "feat(speeches): 2nd speech toggle + collapsed + presentation (F118)"}
  - {hash: "1c05840", message: "feat(i18n): new keys for 3 locales (F116+F117+F118)"}
  - {hash: "b7329ca", message: "fix(edge): reset-redirect charset + Cache-Control (F119)"}
  - {hash: "8ea40d9", message: "docs(code): CODE_LEDGER update"}
  - {hash: "c6e881b", message: "test(batch19): tests for F116-F119"}
  - {hash: "01590bb", message: "docs(tests): TEST_CONSOLIDATED update"}
  - {hash: "ed821b6", message: "fix(edge): can_music -> can_pianist/can_conductor in Edge Functions"}
  - {hash: "8d7b9f5", message: "fix(speeches): SpeechSlot toggle restricted to Bispado"}
  - {hash: "b4f500a", message: "docs(code): CODE_LEDGER review fix commits"}
  - {hash: "4149fb1", message: "test(batch19): fix stale can_music refs in tests"}
  - {hash: "a8baf6f", message: "docs(code): CODE_LEDGER QA POST fix commit"}
decisions:
  - "ADR-079: Per-user app language in Supabase Auth user_metadata"
  - "ADR-080: Mutual exclusivity CHECK constraint for can_pianist/can_conductor"
  - "Observer gets limited Settings tab (app language, theme, about)"
  - "Collection reactivation bug fixed (auto-activate on ward language change)"
  - "WhatsApp placeholder names translated per APP language"
handoff_notes: "Phase 1 complete. 3 pending deploys: migration 017 (destructive), migration 018 (additive), 4 Edge Functions. Deploy migrations first, then Edge Functions."
