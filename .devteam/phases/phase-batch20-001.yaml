phase_id: 1
description: "Bug fixes: actor roles, language switch, 2nd speech, password reset email language, password reset HTML sandbox (CR-194, CR-195, CR-196, CR-197, CR-198)"
status: completed
features:
  - {id: F130, name: "Fix TypeScript errors and actor role naming consistency", status: completed}
  - {id: F131, name: "Fix ward language switch not updating AuthContext state", status: completed}
  - {id: F132, name: "Fix multiple bugs in 2nd speech toggle functionality", status: completed}
  - {id: F133, name: "Fix password reset email to use user app language", status: completed}
  - {id: F134, name: "Fix password reset redirect to work without JavaScript", status: completed}
artifacts_produced:
  - "docs/specs/SPEC_F130_F134.yaml"
  - "docs/arch/ARCH_M035.yaml"
  - "docs/plans/PLAN_P035.yaml"
  - "docs/qa/QA_PLAN_batch20_phase1.yaml"
  - "src/__tests__/batch21-f130-f134.test.ts"
commits:
  - {hash: "fa31e0d", message: "fix(types): resolve 15 TypeScript compilation errors (F130)"}
  - {hash: "e1df02e", message: "docs(naming): fix can_piano -> can_pianist (F130)"}
  - {hash: "6f6a4fb", message: "fix(auth): expose setWardLanguage in AuthContext (F131)"}
  - {hash: "62c0c29", message: "fix(speeches): clear topic fields when toggling off 2nd speech (F132)"}
  - {hash: "e39e2e7", message: "fix(speech-slot): show 2 visible disabled fields (F132)"}
  - {hash: "38c7d2e", message: "fix(agenda): dynamic speaker counts and always-visible 2nd speaker row (F132)"}
  - {hash: "8771dfa", message: "test(f132): add comprehensive tests for 2nd speech toggle (F132)"}
  - {hash: "74cf461", message: "fix(reset-email): use user metadata language (F133)"}
  - {hash: "490f50a", message: "fix(reset-redirect): remove script tag (F134)"}
  - {hash: "c9aa69c", message: "test(batch21): comprehensive tests for F130, F131, F133, F134"}
  - {hash: "43a8dcf", message: "docs(code): update CODE_LEDGER"}
  - {hash: "44105e0", message: "test(tester): additional test coverage validation"}
decisions:
  - "ADR-085: Separate direct Supabase update for topic fields when toggling off 2nd speech"
  - "ADR-086: User metadata language priority for password reset email"
  - "OQ-3: setWardLanguage exposed in AuthContextValue interface"
  - "CR-196.3: Not a bug - user confirmed desired behavior (visible+disabled+placeholder)"
handoff_notes: "Phase 2 has 3 CRs: CR-193 (settings reorganization), CR-199 (status circle alignment), CR-200 (play icon resize). 2 Edge Function deploys pending (send-reset-email, reset-redirect)."
