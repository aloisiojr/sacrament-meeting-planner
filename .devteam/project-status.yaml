project:
  name: "Batch 20 - Settings reorganization, Actor roles fix, Language switch fix, 2nd speech bugs, Password reset fixes, UI alignment & play icon"
  type: feature_request
  created_at: "2026-02-22"
  user_request: |
    8 pedidos agrupados:
    1. Reorganizar aba Configurações em 2 grupos: "Configurações da Ala" (Discursantes, Biblioteca de Temas, Modelo de Convite pelo WhatsApp, Idioma da Ala, Fuso Horário) e "Configurações do App" (Usuários do App, Histórico de Uso, Idioma do App, Tema Claro/Escuro, Sobre). Label com nome de cada grupo antes dos cards.
    2. Revisão geral dos papéis dos atores, principalmente nos testes. Problemas de TS, testes não passando, inconsistência "can_conduct" vs "can_conductor" no código.
    3. Botão de troca de idioma da Ala não funciona. Ao clicar e confirmar, não troca seleção, não troca idioma das coleções nem do modelo do WhatsApp.
    4. Funcionalidade de 2º Discurso opcional com múltiplos erros: (4.1) toggle desligado apaga só discursante, deveria apagar tema também; (4.2) aba Discursos card expandido toggle desligado troca campos por mensagem de aviso ao invés de só desativar; (4.3) aba Agendas card expandido sem 2º discurso mostra texto no campo desabilitado; (4.4) card contraído agenda com 2º discurso desabilitado deve mostrar X/2 ao invés de X/3.
    5. Email de recuperação de senha deve usar idioma do app, não da ala.
    6. Botão de reset de senha no email resulta em HTML estático. Erro sandbox: allow-scripts permission not set. Edge Function reset-redirect precisa redirecionar sem scripts.
    7. Card expandido de discursos: alinhar direita do círculo de status com direita do campo do discursante sem mexer posição do X.
    8. Trocar botão de play (Iniciar Reunião e card de agenda) por ícone bem maior (altura da fonte). Atual muito pequeno e colado na seta.

phases:
  total: 2
  current: 1
  summary:
    - phase: 1
      description: "Bug fixes: actor roles, language switch, 2nd speech, password reset email language, password reset HTML sandbox (CR-194, CR-195, CR-196, CR-197, CR-198)"
      status: completed
    - phase: 2
      description: "UI improvements: settings reorganization, status circle alignment, play icon resize (CR-193, CR-199, CR-200)"
      status: pending

current_phase:
  id: 1
  started_at: "2026-02-22"
  features: [F130, F131, F132, F133, F134]
  change_requests: [CR-194, CR-195, CR-196, CR-197, CR-198]
  current_agent: "none"
  current_step: "Phase 1 DONE"
  completed_steps:
    - "QA PRE validation (validated=true, QA_PLAN_batch20_phase1, 22 checks, 15 must_pass)"
    - "Requirements extraction (F130-F134, 38 ACs, 17 ECs, 0 OQs remaining, status=complete)"
    - "Architecture definition (ARCH_M035, ADR-085/086, 13 component mods, 0 new components)"
    - "Implementation plan (PLAN_P035, 10 steps, 44 ACs, 15 ECs, 100% coverage)"
    - "Code implementation (12 commits, 56 new tests, 5124/5124 passing, S01-S10 complete)"
    - "Testing (56 tests, 38/38 ACs, 17/17 ECs, verdict approved, 5124/5124 passing)"
    - "Code review (verdict: approved, 0 P0, 0 P1, 0 P2, chain intact)"
    - "QA POST validation (verdict: passed, 15/15 must_pass, 6/7 should_pass)"

artifacts:
  spec_consolidated: "docs/specs/SPEC_CONSOLIDATED.yaml"
  arch_consolidated: "docs/arch/ARCH_CONSOLIDATED.yaml"
  plan_consolidated: "docs/plans/PLAN_CONSOLIDATED.yaml"
  code_ledger: "docs/code/CODE_LEDGER.yaml"
  test_consolidated: "docs/tests/TEST_CONSOLIDATED.yaml"
  review_consolidated: "docs/reviews/REVIEW_CONSOLIDATED.yaml"
  qa_consolidated: "docs/qa/QA_CONSOLIDATED.yaml"

pending_deploys:
  - type: "edge_function"
    description: "Deploy send-reset-email Edge Function (F133)"
    instructions: "supabase functions deploy send-reset-email --project-ref <ref>"
  - type: "edge_function"
    description: "Deploy reset-redirect Edge Function (F134)"
    instructions: "supabase functions deploy reset-redirect --project-ref <ref>"
last_updated: "2026-02-22"
