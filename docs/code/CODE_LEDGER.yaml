# =============================================================================
# CODE_LEDGER.yaml
# Tracks commits made for CR-82, CR-80, CR-83, CR-84, CR-85, CR-86, CR-90,
# CR-87, CR-88, CR-89, CR-91, CR-92, CR-93, CR-95, CR-98,
# CR-94, CR-96, CR-97, CR-99, CR-100,
# CR-101, CR-102, CR-103, CR-104, CR-108, CR-109,
# CR-105, CR-106, CR-107, CR-110, CR-111,
# CR-112, CR-113, CR-117, CR-122, CR-125,
# CR-114, CR-115, CR-116, CR-119, CR-121,
# CR-118, CR-120, CR-123,
# CR-126, CR-127, CR-129, CR-130,
# CR-128, CR-131, CR-132, CR-133,
# CR-134, CR-135, CR-136, CR-137, CR-138, CR-139,
# CR-140, CR-141, CR-142, CR-143, CR-144,
# CR-145, CR-146, CR-147, CR-148, CR-149,
# CR-150, CR-151, CR-152, CR-153,
# CR-156, CR-157, CR-158, CR-159, CR-160, CR-161, CR-162, CR-163,
# CR-155, CR-164,
# CR-172, CR-173, CR-174,
# CR-175, CR-176, CR-177,
# CR-178, CR-180, CR-181, CR-191,
# CR-179, CR-182, CR-183, CR-187, CR-189, CR-192
# Generated: 2026-02-22
# =============================================================================

metadata:
  project: Sacrament Meeting Planner
  change_requests: [CR-82, CR-80, CR-83, CR-84, CR-85, CR-86, CR-90, CR-87, CR-88, CR-89, CR-91, CR-92, CR-93, CR-95, CR-98, CR-94, CR-96, CR-97, CR-99, CR-100, CR-101, CR-102, CR-103, CR-104, CR-108, CR-109, CR-105, CR-106, CR-107, CR-110, CR-111, CR-112, CR-113, CR-117, CR-122, CR-125, CR-114, CR-115, CR-116, CR-119, CR-121, CR-118, CR-120, CR-123, CR-126, CR-127, CR-129, CR-130, CR-128, CR-131, CR-132, CR-133, CR-134, CR-135, CR-136, CR-137, CR-138, CR-139, CR-140, CR-141, CR-142, CR-143, CR-144, CR-145, CR-146, CR-147, CR-148, CR-149, CR-156, CR-157, CR-158, CR-159, CR-160, CR-161, CR-162, CR-163, CR-155, CR-164, CR-172, CR-173, CR-174, CR-175, CR-176, CR-177, CR-178, CR-180, CR-181, CR-191, CR-179, CR-182, CR-183, CR-187, CR-189, CR-192]
  plan_ref: plans/PLAN_P025.yaml
  arch_ref: arch/ARCH_M025.yaml
  spec_ref: "specs/SPEC_F088.yaml, specs/SPEC_F089.yaml, specs/SPEC_F090.yaml, specs/SPEC_F091.yaml, specs/SPEC_F092.yaml"

commits:

  # --- CR-82 commits ---

  - step: 1
    cr: CR-82
    hash: ee9d84d
    message: "fix(layout): add GestureHandlerRootView wrapper to root layout (CR-82)"
    files_changed:
      - src/app/_layout.tsx
    changes:
      - id: CHG-01
        description: "Added import { GestureHandlerRootView } from 'react-native-gesture-handler'"
      - id: CHG-02
        description: "Wrapped provider tree with <GestureHandlerRootView style={{ flex: 1 }}> inside ErrorBoundary"
    acs_covered: [AC-001, AC-002, AC-003, AC-004, AC-005, AC-006]
    ecs_covered: [EC-001]

  - step: 2
    cr: CR-82
    hash: 37e880b
    message: "test(layout): add tests for GestureHandlerRootView wrapper (CR-82)"
    files_changed:
      - src/__tests__/cr082-gesture-handler-root.test.ts
    tests_added: 9
    test_ids: [T-001, T-002, T-003, T-004, T-005, T-006, T-007, T-008, T-009]
    acs_covered: [AC-001, AC-002, AC-003, AC-004, AC-005, AC-006]
    ecs_covered: [EC-001, EC-002]

  # --- CR-80 commits ---

  - step: 1
    cr: CR-80
    plan_ref: plans/PLAN_P010.yaml
    plan_step: STEP-01
    hash: 9359348
    message: "feat(i18n): add members.description and members.csvHelp keys in pt-BR/en/es (CR-80)"
    files_changed:
      - src/i18n/locales/en.json
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-03
        description: "Added members.description key with English text to en.json"
      - id: CHG-04
        description: "Added members.csvHelp key with English text to en.json"
      - id: CHG-05
        description: "Added members.description key with Portuguese text to pt-BR.json"
      - id: CHG-06
        description: "Added members.csvHelp key with Portuguese text to pt-BR.json"
      - id: CHG-07
        description: "Added members.description key with Spanish text to es.json"
      - id: CHG-08
        description: "Added members.csvHelp key with Spanish text to es.json"
    acs_covered: [AC-4, AC-5, AC-6]
    ecs_covered: [EC-2]

  - step: 2
    cr: CR-80
    plan_ref: plans/PLAN_P010.yaml
    plan_step: STEP-02
    hash: 84bea70
    message: "feat(members): add description and csvHelp explanatory texts (CR-80)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
    changes:
      - id: CHG-09
        description: "Added <Text> with t('members.description') between header and searchContainer"
      - id: CHG-10
        description: "Added <Text> with t('members.csvHelp') inside canImport block after csvActions"
      - id: CHG-11
        description: "Added description style (fontSize 13, textAlign center, paddingHorizontal 16, marginBottom 8)"
      - id: CHG-12
        description: "Added csvHelp style (fontSize 12, paddingHorizontal 16, marginBottom 8)"
      - id: CHG-13
        description: "Wrapped canImport block content with React Fragment to include csvHelp text"
    acs_covered: [AC-1, AC-2, AC-3]
    ecs_covered: [EC-1, EC-3]

  - step: 3
    cr: CR-80
    plan_ref: plans/PLAN_P010.yaml
    plan_step: STEP-03
    hash: null
    message: "Regression verification (no code changes)"
    files_changed: []
    changes: []
    acs_covered: [AC-7]
    ecs_covered: [EC-2]

  # --- Batch 6, Phase 1: CR-83, CR-84, CR-85, CR-86, CR-90 ---

  - step: STEP-01
    cr: CR-90
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-01
    hash: 298258c
    message: "fix(swipeable): add pointerEvents box-none to fix Delete button touch (CR-90)"
    files_changed:
      - src/components/SwipeableCard.tsx
    changes:
      - id: CHG-14
        description: "Added pointerEvents='box-none' to Animated.View wrapping card content"
      - id: CHG-15
        description: "Moved backgroundColor from Animated.View style to inner <View> wrapper"
    acs_covered: [AC-F031-01, AC-F031-02, AC-F031-03, AC-F031-04]

  - step: STEP-02
    cr: CR-83
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-02
    hash: 89b5dc9
    message: "feat(members): replace onBlur auto-save with Save/Cancel buttons (CR-83)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
    changes:
      - id: CHG-16
        description: "Removed onBlur={handleSave} from name and phone TextInputs"
      - id: CHG-17
        description: "Made onCancel required in MemberEditorProps"
      - id: CHG-18
        description: "Added Save/Cancel Pressable buttons below phone row"
      - id: CHG-19
        description: "Added editorButtons, cancelButton, saveButton styles"
      - id: CHG-20
        description: "Updated MemberRow to pass onCancel to MemberEditor"
    acs_covered: [AC-F027-01, AC-F027-02, AC-F027-03, AC-F027-04, AC-F027-08]

  - step: STEP-03
    cr: CR-83
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-03
    hash: 1970e71
    message: "feat(topics): replace onBlur auto-save with Save/Cancel buttons (CR-83)"
    files_changed:
      - src/app/(tabs)/settings/topics.tsx
    changes:
      - id: CHG-21
        description: "Removed onBlur={handleSave} from title and link TextInputs"
      - id: CHG-22
        description: "Added onCancel prop to TopicEditorProps (required)"
      - id: CHG-23
        description: "Added Save/Cancel buttons below link input"
      - id: CHG-24
        description: "Updated TopicRow to pass onCancel to TopicEditor"
    acs_covered: [AC-F027-05, AC-F027-06, AC-F027-07, AC-F027-08]

  - step: STEP-04
    cr: CR-85
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-04
    hash: 8d0f6c4
    message: "feat(lib): create countryCodes.ts with ~200 country codes and splitPhoneNumber (CR-85)"
    files_changed:
      - src/lib/countryCodes.ts
    changes:
      - id: CHG-25
        description: "Created countryCodes.ts with CountryCode interface, 172 entries, getFlagForCode, splitPhoneNumber"
    acs_covered: [AC-F029-01, AC-F029-02, AC-F029-04, AC-F029-05]

  - step: STEP-05
    cr: CR-85
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-05
    hash: 59eaba7
    message: "refactor(members,csv): use shared countryCodes.ts as single source of truth (CR-85)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
      - src/lib/csvUtils.ts
    changes:
      - id: CHG-26
        description: "Removed local CountryCode, COUNTRY_CODES, getFlagForCode from members.tsx"
      - id: CHG-27
        description: "Added import from countryCodes.ts in members.tsx"
      - id: CHG-28
        description: "Removed local splitPhoneNumber from csvUtils.ts, re-exported from countryCodes"
    acs_covered: [AC-F029-03]

  - step: STEP-06
    cr: CR-86
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-06
    hash: 5d65fb1
    message: "feat(i18n): add members.importConfirmTitle and importConfirmMessage keys (CR-86)"
    files_changed:
      - src/i18n/locales/en.json
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-29
        description: "Added importConfirmTitle and importConfirmMessage keys in en, pt-BR, es"
    acs_covered: [AC-F030-05]

  - step: STEP-07
    cr: CR-86
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-07
    hash: 5837628
    message: "feat(members): add confirmation dialog before CSV import (CR-86)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
    changes:
      - id: CHG-30
        description: "Renamed handleImport to performImport (file picker logic)"
      - id: CHG-31
        description: "Created new handleImport with Alert.alert confirmation before import"
    acs_covered: [AC-F030-01, AC-F030-02, AC-F030-03, AC-F030-04]

  - step: STEP-08
    cr: CR-84
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-08
    hash: 8f2b42a
    message: "feat(components): create SearchInput component with clear X button (CR-84)"
    files_changed:
      - src/components/SearchInput.tsx
    changes:
      - id: CHG-32
        description: "Created SearchInput with useTheme internally, clear X button, paddingRight 36"
    acs_covered: [AC-F028-01, AC-F028-02, AC-F028-03, AC-F028-04, AC-F028-05]

  - step: STEP-09
    cr: CR-84
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-09
    hash: 27daf39
    message: "feat(settings): migrate search fields to SearchInput in 4 settings screens (CR-84)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
      - src/app/(tabs)/settings/topics.tsx
      - src/app/(tabs)/settings/history.tsx
      - src/app/(tabs)/settings/timezone.tsx
    changes:
      - id: CHG-33
        description: "Replaced search TextInput with SearchInput in members, topics, history, timezone"
      - id: CHG-34
        description: "Removed unused searchInput styles and TextInput imports where applicable"
    acs_covered: [AC-F028-06]

  - step: STEP-10
    cr: CR-84
    plan_ref: plans/PLAN_P011.yaml
    plan_step: STEP-10
    hash: ede8904
    message: "feat(components): migrate search fields to SearchInput in 6 modal/selector components (CR-84)"
    files_changed:
      - src/components/HymnSelector.tsx
      - src/components/MemberSelectorModal.tsx
      - src/components/TopicSelectorModal.tsx
      - src/components/PrayerSelector.tsx
      - src/components/ActorSelector.tsx
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-35
        description: "Replaced search TextInput with SearchInput in 6 modal/selector components"
      - id: CHG-36
        description: "Removed unused TextInput imports where applicable"
    acs_covered: [AC-F028-06]

  # --- Regression fixes from Phase 1 review ---

  - step: R-B6P1-01
    cr: CR-84
    hash: ac4b489
    message: "fix(tests): update CR-39 tests for SearchInput migration in topics.tsx (R-B6P1-01)"
    files_changed:
      - src/__tests__/cr003-qa.test.ts
    changes:
      - id: CHG-37
        description: "Updated AC-39.1 test to check for 'SearchInput' instead of 'searchInput' style"
      - id: CHG-38
        description: "Updated AC-39.5 test to verify SearchInput import and component styles"

  - step: R-B6P1-02
    cr: CR-86
    hash: 27a4383
    message: "fix(tests): update CSV import test to reference performImport after CR-86 refactor (R-B6P1-02)"
    files_changed:
      - src/__tests__/cr004-f005-csv-members.test.ts
    changes:
      - id: CHG-39
        description: "Updated test to extract performImport body instead of handleImport for error handling check"

  - step: R-B6P1-03
    cr: CR-84
    hash: 3b780d4
    message: "fix(tests): update CR-80 regression test for SearchInput migration in members.tsx (R-B6P1-03)"
    files_changed:
      - src/__tests__/cr080-f026-members-explanatory-texts.test.ts
    changes:
      - id: CHG-40
        description: "Updated AC-7 regression test to check for 'SearchInput' instead of 'searchInput'"

  # --- Batch 6, Phase 2: CR-87, CR-88, CR-89 ---

  - step: STEP-01
    cr: CR-87
    plan_ref: plans/PLAN_P012.yaml
    plan_step: STEP-01
    hash: 4e0fbb7
    message: "feat(swipeable): replace Edit/Delete text with Unicode icons pencil/trash (CR-87)"
    files_changed:
      - src/components/SwipeableCard.tsx
    changes:
      - id: CHG-41
        description: "Replaced Edit button Text content from editLabel to pencil Unicode character (U+270F)"
      - id: CHG-42
        description: "Replaced Delete button Text content from deleteLabel to wastebasket Unicode character (U+1F5D1)"
      - id: CHG-43
        description: "Changed both Text styles from styles.actionText to styles.actionIcon"
      - id: CHG-44
        description: "Added actionIcon style with fontSize 20 and textAlign center"
    acs_covered: [AC-F032-01, AC-F032-02, AC-F032-03, AC-F032-04, AC-F032-05]

  - step: STEP-02
    cr: CR-88
    plan_ref: plans/PLAN_P012.yaml
    plan_step: STEP-02
    hash: 98dbee2
    message: "feat(i18n): add topics.description and topics.noTopics keys in 3 locales (CR-88)"
    files_changed:
      - src/i18n/locales/en.json
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-45
        description: "Added topics.description key with explanatory text in en.json"
      - id: CHG-46
        description: "Added topics.noTopics key ('No topics in this collection') in en.json"
      - id: CHG-47
        description: "Added topics.description key with Portuguese text in pt-BR.json"
      - id: CHG-48
        description: "Added topics.noTopics key ('Nenhum tema nesta colecao') in pt-BR.json"
      - id: CHG-49
        description: "Added topics.description key with Spanish text in es.json"
      - id: CHG-50
        description: "Added topics.noTopics key ('No hay temas en esta coleccion') in es.json"
    acs_covered: [AC-F033-03, AC-F033-06]

  - step: STEP-03
    cr: CR-88
    plan_ref: plans/PLAN_P012.yaml
    plan_step: STEP-03
    hash: 8431360
    message: "feat(topics): add explanatory description text below header (CR-88)"
    files_changed:
      - src/app/(tabs)/settings/topics.tsx
    changes:
      - id: CHG-51
        description: "Added <Text> with t('topics.description') between header and Ward Topics section"
      - id: CHG-52
        description: "Added description style (fontSize 13, textAlign center, paddingHorizontal 16, marginBottom 8)"
    acs_covered: [AC-F033-01, AC-F033-02, AC-F033-04, AC-F033-05]

  - step: STEP-04
    cr: CR-89
    plan_ref: plans/PLAN_P012.yaml
    plan_step: STEP-04
    hash: 445f7b7
    message: "feat(hooks): add useCollectionTopics hook for lazy-loading collection topics (CR-89)"
    files_changed:
      - src/hooks/useTopics.ts
    changes:
      - id: CHG-53
        description: "Added collectionTopics key function to topicKeys"
      - id: CHG-54
        description: "Added useCollectionTopics hook that queries general_topics by collection_id, ordered by title"
    acs_covered: [AC-F034-03]

  - step: STEP-05
    cr: CR-89
    plan_ref: plans/PLAN_P012.yaml
    plan_step: STEP-05
    hash: d2c9c0a
    message: "feat(topics): make CollectionRow tappable with chevron indicator (CR-89)"
    files_changed:
      - src/app/(tabs)/settings/topics.tsx
    changes:
      - id: CHG-55
        description: "Added isExpanded and onPress props to CollectionRowProps interface"
      - id: CHG-56
        description: "Wrapped chevron + name in Pressable with onPress handler"
      - id: CHG-57
        description: "Added chevron Text showing U+25B6 (collapsed) or U+25BC (expanded)"
      - id: CHG-58
        description: "Added collectionPressable and chevron styles"
    acs_covered: [AC-F034-06, AC-F034-08]

  - step: STEP-06
    cr: CR-89
    plan_ref: plans/PLAN_P012.yaml
    plan_step: STEP-06
    hash: 9e41fec
    message: "feat(topics): add expand/collapse collection topics view with accordion pattern (CR-89)"
    files_changed:
      - src/app/(tabs)/settings/topics.tsx
    changes:
      - id: CHG-59
        description: "Added ActivityIndicator import and useCollectionTopics import"
      - id: CHG-60
        description: "Added expandedCollectionId state (string | null)"
      - id: CHG-61
        description: "Added handleCollectionPress handler with toggle logic"
      - id: CHG-62
        description: "Created CollectionTopicsList inline component with loading, empty, and topics list states"
      - id: CHG-63
        description: "Updated collections map to use React.Fragment with CollectionRow + conditional CollectionTopicsList"
      - id: CHG-64
        description: "Added 7 new styles: collectionTopicsContainer, collectionTopicItem, collectionTopicTitle, collectionTopicLink, collectionTopicsLoading, collectionTopicsEmpty, collectionTopicsEmptyText"
    acs_covered: [AC-F034-01, AC-F034-02, AC-F034-03, AC-F034-04, AC-F034-05, AC-F034-07, AC-F034-08]

test_results:
  new_tests: 106
  new_tests_passing: 106
  full_suite_tests: 2716
  full_suite_passing: 2716
  full_suite_files: 56
  regressions: 0

  # --- Batch 7, Phase 1: CR-91, CR-92, CR-93, CR-95, CR-98 ---

  - step: STEP-01
    cr: CR-91
    plan_ref: plans/PLAN_P013.yaml
    plan_step: STEP-01
    hash: bdba1aa
    message: "fix(db): add SECURITY DEFINER to enqueue_speech_notification trigger (CR-91)"
    files_changed:
      - supabase/migrations/013_fix_notification_trigger_security_definer.sql
    changes:
      - id: CHG-65
        description: "Created migration 013 with CREATE OR REPLACE FUNCTION enqueue_speech_notification() SECURITY DEFINER"
    acs_covered: [AC-F035-01, AC-F035-02, AC-F035-03, AC-F035-04]
    ecs_covered: [EC-F035-01, EC-F035-02, EC-F035-03, EC-F035-04]

  - step: STEP-02
    cr: CR-92
    plan_ref: plans/PLAN_P013.yaml
    plan_step: STEP-02
    hash: e091833
    message: "fix(members): change keyExtractor to item.label to fix duplicate key warning (CR-92)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
    changes:
      - id: CHG-66
        description: "Changed FlatList keyExtractor from item.code to item.label in country code picker"
    acs_covered: [AC-F036-01, AC-F036-02, AC-F036-03, AC-F036-04, AC-F036-05]
    ecs_covered: [EC-F036-01]

  - step: STEP-03
    cr: CR-93
    plan_ref: plans/PLAN_P013.yaml
    plan_step: STEP-03
    hash: 313dc67
    message: "fix(deeplink): change protocol from wardmanager:// to sacrmeetman:// (CR-93)"
    files_changed:
      - app.json
      - supabase/functions/create-invitation/index.ts
    changes:
      - id: CHG-67
        description: "Changed expo.scheme from 'wardmanager' to 'sacrmeetman' in app.json"
      - id: CHG-68
        description: "Changed deep link from wardmanager://invite/ to sacrmeetman://invite/ in create-invitation Edge Function"
    acs_covered: [AC-F037-01, AC-F037-02, AC-F037-03, AC-F037-04]
    ecs_covered: [EC-F037-01, EC-F037-02]

  - step: STEP-04
    cr: CR-95
    plan_ref: plans/PLAN_P013.yaml
    plan_step: STEP-04
    hash: 1420ed2
    message: "fix(speeches): hide speech slots for all non-speeches types (CR-95)"
    files_changed:
      - src/app/(tabs)/speeches.tsx
      - src/__tests__/cr002-qa.test.ts
      - src/__tests__/cr001-qa-extended.test.ts
    changes:
      - id: CHG-69
        description: "Removed import of isExcludedFromAgenda from useAgenda in speeches.tsx"
      - id: CHG-70
        description: "Changed rendering condition from !(exception && isExcludedFromAgenda(exception.reason)) to (!exception || exception.reason === 'speeches')"
      - id: CHG-71
        description: "Updated cr002-qa.test.ts to assert speeches.tsx does NOT contain isExcludedFromAgenda and contains new pattern"
      - id: CHG-72
        description: "Updated cr001-qa-extended.test.ts to verify speeches.tsx uses direct type check instead of isExcludedFromAgenda"
    acs_covered: [AC-F038-01, AC-F038-02, AC-F038-03, AC-F038-04, AC-F038-05, AC-F038-06, AC-F038-07, AC-F038-08, AC-F038-09]
    ecs_covered: [EC-F038-01, EC-F038-02]

  - step: STEP-05
    cr: CR-98
    plan_ref: plans/PLAN_P013.yaml
    plan_step: STEP-05
    hash: 7a60ea8
    message: "fix(prayer): add visible/onClose props to PrayerSelector for immediate modal open (CR-98)"
    files_changed:
      - src/components/PrayerSelector.tsx
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-73
        description: "Added useEffect import to PrayerSelector.tsx"
      - id: CHG-74
        description: "Added visible?: boolean and onClose?: () => void props to PrayerSelectorProps interface"
      - id: CHG-75
        description: "Added useEffect to sync modalVisible with visible prop"
      - id: CHG-76
        description: "Added onClose?.() calls to all modal close handlers (cancel button, onRequestClose, handleSelectMember, handleCustomName)"
      - id: CHG-77
        description: "Added visible={true} and onClose={() => setSelectorModal(null)} to PrayerSelector in AgendaForm.tsx"
    acs_covered: [AC-F039-01, AC-F039-02, AC-F039-03, AC-F039-04, AC-F039-05, AC-F039-06, AC-F039-07]
    ecs_covered: [EC-F039-01, EC-F039-02, EC-F039-03]

batch7_phase1_test_results:
  full_suite_tests: 2716
  full_suite_passing: 2716
  full_suite_files: 56
  regressions: 0

  # --- Batch 7, Phase 2: CR-94, CR-96, CR-97, CR-99, CR-100 ---

  - step: STEP-01
    cr: CR-99
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-01
    hash: 88e7469
    message: "feat(i18n): change speeches.speaker label from Orador/Speaker to Discurso/Speech (CR-99)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-78
        description: "Changed speeches.speaker value from 'Orador' to 'Discurso' in pt-BR.json"
      - id: CHG-79
        description: "Changed speeches.speaker value from 'Speaker' to 'Speech' in en.json"
      - id: CHG-80
        description: "Changed speeches.speaker value from 'Orador' to 'Discurso' in es.json"
    acs_covered: [AC-F043-01, AC-F043-02, AC-F043-03]

  - step: STEP-02
    cr: CR-94
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-02
    hash: 390c518
    message: "feat(whatsapp): add i18n default templates EN/ES and language param to buildWhatsAppUrl (CR-94)"
    files_changed:
      - src/lib/whatsappUtils.ts
      - src/lib/whatsapp.ts
    changes:
      - id: CHG-81
        description: "Added DEFAULT_TEMPLATE_EN and DEFAULT_TEMPLATE_ES constants"
      - id: CHG-82
        description: "Added getDefaultTemplate(language) function with fallback to pt-BR"
      - id: CHG-83
        description: "Added language parameter to buildWhatsAppUrl with default 'pt-BR'"
      - id: CHG-84
        description: "Updated whatsapp.ts re-exports to include new symbols"
    acs_covered: [AC-F040-01, AC-F040-02, AC-F040-03, AC-F040-04]

  - step: STEP-03
    cr: CR-94
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-03
    hash: 4ba9413
    message: "feat(invite): pass ward language to buildWhatsAppUrl for i18n template selection (CR-94)"
    files_changed:
      - src/components/InviteManagementSection.tsx
    changes:
      - id: CHG-85
        description: "Passed locale as 5th argument to buildWhatsAppUrl in handleNotInvitedAction"
      - id: CHG-86
        description: "Passed locale as 5th argument to buildWhatsAppUrl in handleInvitedAction"
    acs_covered: [AC-F040-05, AC-F040-06]

  - step: STEP-04
    cr: CR-96
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-04
    hash: 694d188
    message: "fix(members): ensure SearchInput stays fixed above scrollable FlatList (CR-96)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
    changes:
      - id: CHG-87
        description: "Added style={styles.flex} to FlatList to fill remaining space below fixed elements"
    acs_covered: [AC-F041-01, AC-F041-02]

  - step: STEP-05
    cr: CR-96
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-05
    hash: 3def318
    message: "fix(topics): move SearchInput outside ScrollView to keep it fixed at top (CR-96)"
    files_changed:
      - src/app/(tabs)/settings/topics.tsx
    changes:
      - id: CHG-88
        description: "Moved header, description, section header with add button, and SearchInput above ScrollView"
      - id: CHG-89
        description: "ScrollView now contains only ward topics list and collections section"
    acs_covered: [AC-F041-03, AC-F041-04]

  - step: STEP-06
    cr: CR-97
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-06
    hash: 4a7b26b
    message: "feat(actor): add multiSelect and selectedNames props to ActorSelector (CR-97)"
    files_changed:
      - src/components/ActorSelector.tsx
    changes:
      - id: CHG-90
        description: "Added multiSelect and selectedNames optional props to ActorSelectorProps"
      - id: CHG-91
        description: "Updated handleSelect to keep modal open when multiSelect=true"
      - id: CHG-92
        description: "Updated handleAdd to keep modal open when multiSelect=true"
      - id: CHG-93
        description: "Added checkmark prefix to selected actor names in renderItem"
    acs_covered: [AC-F042-01, AC-F042-02, AC-F042-03]

  - step: STEP-07
    cr: CR-97
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-07
    hash: ea47454
    message: "feat(agenda): add toggle multi-select for recognized_names field (CR-97)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-94
        description: "Changed recognizing handler to toggle names in/out of recognized_names array"
      - id: CHG-95
        description: "Added multiSelect=true and selectedNames props when field is recognizing"
    acs_covered: [AC-F042-04, AC-F042-05, AC-F042-06]

  - step: STEP-08
    cr: CR-100
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-08
    hash: ba0c775
    message: "feat(db): add speaker_1/2/3_override fields to sunday_agendas for last-minute swap (CR-100)"
    files_changed:
      - supabase/migrations/014_add_speaker_overrides.sql
      - src/types/database.ts
    changes:
      - id: CHG-96
        description: "Created migration 014 adding speaker_1/2/3_override TEXT columns to sunday_agendas"
      - id: CHG-97
        description: "Added speaker_1/2/3_override fields to SundayAgenda TypeScript interface"
    acs_covered: [AC-F044-01, AC-F044-02]

  - step: STEP-09
    cr: CR-100
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-09
    hash: 5038cf4
    message: "feat(agenda): rewrite SpeakerField with read-only display and inline override editing (CR-100)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-98
        description: "Rewrote SpeakerField with read-only name, pencil icon for edit, X icon for revert"
      - id: CHG-99
        description: "Removed MemberSelectorModal, useAssignSpeaker, useLazyCreateSpeeches, useMembers imports"
      - id: CHG-100
        description: "Removed speakerModalPosition state and handleSpeakerAssign callback"
      - id: CHG-101
        description: "Added speakerEditRow, speakerEditInput, speakerReadRow, speakerReadText, speakerIconBtn, speakerIcon styles"
    acs_covered: [AC-F044-03, AC-F044-04, AC-F044-05, AC-F044-06]

  - step: STEP-10
    cr: CR-100
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-10
    hash: 609a36a
    message: "feat(presentation): use speaker override names in presentation mode cards (CR-100)"
    files_changed:
      - src/hooks/usePresentationMode.ts
    changes:
      - id: CHG-102
        description: "Updated buildPresentationCards to use agenda.speaker_N_override ?? speech.speaker_name for all 3 positions"
    acs_covered: [AC-F044-07]

  - step: STEP-11
    cr: CR-100
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-11
    hash: 9307718
    message: "test(agenda): add speaker_override fields to makeAgenda test helper (CR-100)"
    files_changed:
      - src/__tests__/phase04-agenda-presentation.test.ts
    changes:
      - id: CHG-103
        description: "Added speaker_1/2/3_override: null to makeAgenda test helper for type compatibility"
    acs_covered: [AC-F044-08]

  - step: STEP-12
    cr: CR-94
    plan_ref: plans/PLAN_P014.yaml
    plan_step: STEP-12
    hash: aadab00
    message: "test(whatsapp): add tests for getDefaultTemplate and buildWhatsAppUrl language param (CR-94)"
    files_changed:
      - src/__tests__/whatsapp-utils.test.ts
    changes:
      - id: CHG-104
        description: "Added 6 tests for getDefaultTemplate (pt-BR, en, es, fallback, EN content, ES content)"
      - id: CHG-105
        description: "Added 5 tests for buildWhatsAppUrl language parameter (en, es, pt-BR, custom override, default)"
    acs_covered: [AC-F040-07]

  # --- Regression fixes from Phase 2 code review ---

  - step: R-B7P2-01
    cr: [CR-97, CR-100]
    hash: 8d6b6e9
    message: "fix(tests): update agenda-actors tests for multi-select recognizing and SpeakerField override (CR-97, CR-100)"
    files_changed:
      - src/__tests__/cr004-f008-agenda-actors.test.ts
    changes:
      - id: CHG-106
        description: "Updated recognizing test to verify toggle array behavior instead of single-set"
      - id: CHG-107
        description: "Updated speaker modal test to verify SpeakerField with override support instead of MemberSelectorModal"

  - step: R-B7P2-02
    cr: CR-96
    hash: b640e5a
    message: "fix(topics): restore original comment format for test compatibility (CR-96)"
    files_changed:
      - src/app/(tabs)/settings/topics.tsx
    changes:
      - id: CHG-108
        description: "Removed '(fixed)' suffix from JSX comments to match existing test assertions"

batch7_phase2_test_results:
  full_suite_tests: 2800
  full_suite_passing: 2800
  full_suite_files: 57
  regressions: 0

  # --- Batch 8, Phase 1: CR-101, CR-102, CR-103, CR-104, CR-108, CR-109 ---

  - step: STEP-01
    cr: CR-101
    plan_ref: plans/PLAN_P015.yaml
    plan_step: STEP-01
    hash: 63a72ea
    message: "fix(sunday-card): conditionally render LEDs only for speeches type (CR-101)"
    files_changed:
      - src/components/SundayCard.tsx
    changes:
      - id: CHG-109
        description: "Wrapped LED section (StatusLED map) with {isSpeechesType && (...)} conditional"
    acs_covered: [AC-F045-01, AC-F045-02, AC-F045-03, AC-F045-04]
    ecs_covered: [EC-F045-01, EC-F045-02]

  - step: STEP-02
    cr: CR-102
    plan_ref: plans/PLAN_P015.yaml
    plan_step: STEP-02
    hash: 81c4181
    message: "fix(agenda): hide exception label for speeches type sundays (CR-102)"
    files_changed:
      - src/app/(tabs)/agenda.tsx
    changes:
      - id: CHG-110
        description: "Changed exceptionLabel computation to return null when exception.reason === 'speeches'"
    acs_covered: [AC-F046-01, AC-F046-02, AC-F046-03]
    ecs_covered: [EC-F046-01]

  - step: STEP-03
    cr: CR-109
    plan_ref: plans/PLAN_P015.yaml
    plan_step: STEP-03
    hash: 781eb7d
    message: "fix(home): fix SpeechSlots condition to render for speeches type sundays (CR-109)"
    files_changed:
      - src/components/NextSundaysSection.tsx
    changes:
      - id: CHG-111
        description: "Changed condition from !entry.exception to (!entry.exception || entry.exception.reason === 'speeches')"
    acs_covered: [AC-F049-01, AC-F049-02, AC-F049-03]
    ecs_covered: [EC-F049-01, EC-F049-02]

  - step: STEP-04
    cr: CR-104
    plan_ref: plans/PLAN_P015.yaml
    plan_step: STEP-04
    hash: 0ccc825
    message: "fix(whatsapp): add quotes around {titulo} placeholder in default templates (CR-104)"
    files_changed:
      - src/lib/whatsappUtils.ts
    changes:
      - id: CHG-112
        description: "Changed {titulo} to \"{titulo}\" in DEFAULT_TEMPLATE_PT_BR"
      - id: CHG-113
        description: "Changed {titulo} to \"{titulo}\" in DEFAULT_TEMPLATE_EN"
      - id: CHG-114
        description: "Changed {titulo} to \"{titulo}\" in DEFAULT_TEMPLATE_ES"
    acs_covered: [AC-F048-03, AC-F048-08]
    ecs_covered: [EC-F048-03]

  - step: STEP-05
    cr: CR-103
    plan_ref: plans/PLAN_P015.yaml
    plan_step: STEP-05
    hash: 6ac1c9d
    message: "fix(settings): initialize WhatsApp template with language-aware default fallback (CR-103)"
    files_changed:
      - src/app/(tabs)/settings/whatsapp.tsx
    changes:
      - id: CHG-115
        description: "Added import of getDefaultTemplate from whatsappUtils.ts"
      - id: CHG-116
        description: "Changed query .select('whatsapp_template') to .select('whatsapp_template, language')"
      - id: CHG-117
        description: "Updated useEffect to handle 3 cases: null -> getDefaultTemplate(ward.language), '' -> '', value -> value"
    acs_covered: [AC-F047-01, AC-F047-02, AC-F047-03, AC-F047-04, AC-F047-05]
    ecs_covered: [EC-F047-01, EC-F047-02]

  - step: STEP-06
    cr: [CR-104, CR-108]
    plan_ref: plans/PLAN_P015.yaml
    plan_step: STEP-06
    hash: 8e2cc8f
    message: "fix(invite): add collection/link vars and human-readable date to WhatsApp message (CR-104, CR-108)"
    files_changed:
      - src/components/InviteManagementSection.tsx
    changes:
      - id: CHG-118
        description: "Added import of formatDateHumanReadable from dateUtils.ts and SupportedLanguage from i18n"
      - id: CHG-119
        description: "Added collection: speech.topic_collection ?? '' to WhatsAppVariables in handleNotInvitedAction"
      - id: CHG-120
        description: "Added link: speech.topic_link ?? '' to WhatsAppVariables in handleNotInvitedAction"
      - id: CHG-121
        description: "Replaced formatDate with formatDateHumanReadable for date field in handleNotInvitedAction"
      - id: CHG-122
        description: "Added collection: speech.topic_collection ?? '' to WhatsAppVariables in handleInvitedAction"
      - id: CHG-123
        description: "Added link: speech.topic_link ?? '' to WhatsAppVariables in handleInvitedAction"
      - id: CHG-124
        description: "Replaced formatDate with formatDateHumanReadable for date field in handleInvitedAction"
    acs_covered: [AC-F048-01, AC-F048-02, AC-F048-04, AC-F048-05, AC-F048-06, AC-F048-07]
    ecs_covered: [EC-F048-01, EC-F048-02]

  - step: STEP-07
    cr: [CR-101, CR-102, CR-103, CR-104, CR-108, CR-109]
    plan_ref: plans/PLAN_P015.yaml
    plan_step: STEP-07
    hash: 054fe33
    message: "test(batch8-phase1): add tests for F045, F046, F047, F048, F049"
    files_changed:
      - src/__tests__/batch8-phase1.test.ts
    tests_added: 60
    acs_covered: [AC-F045-01, AC-F045-02, AC-F046-01, AC-F046-02, AC-F047-01, AC-F047-02, AC-F048-01, AC-F048-04, AC-F049-01, AC-F049-02]
    ecs_covered: [EC-F045-01, EC-F046-01, EC-F047-01, EC-F048-01, EC-F049-01]

batch8_phase1_test_results:
  new_tests: 60
  new_tests_passing: 60
  full_suite_tests: 2983
  full_suite_passing: 2983
  full_suite_files: 59
  regressions: 0

  # --- Batch 8, Phase 2: CR-105, CR-106, CR-107, CR-110, CR-111 ---

  - step: STEP-01
    cr: CR-110
    plan_ref: plans/PLAN_P016.yaml
    plan_step: STEP-01
    hash: 9ee783e
    message: "feat(permissions): add home:invite_mgmt to bishopric role (CR-110)"
    files_changed:
      - src/lib/permissions.ts
      - src/components/InviteManagementSection.tsx
    changes:
      - id: CHG-125
        description: "Added 'home:invite_mgmt' to bishopric permission set in permissions.ts"
      - id: CHG-126
        description: "Updated docstring and comment to reflect 'Secretary and Bishopric' visibility"
    acs_covered: [AC-F053-01, AC-F053-02, AC-F053-03, AC-F053-04, AC-F053-05]
    ecs_covered: [EC-F053-01]

  - step: STEP-02
    cr: CR-111
    plan_ref: plans/PLAN_P016.yaml
    plan_step: STEP-02
    hash: c5d8288
    message: "feat(speech-slot): increase row gap to 12 and X fontSize to 24 (CR-111)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-127
        description: "Changed row style gap from 8 to 12"
      - id: CHG-128
        description: "Changed removeButton style fontSize from 20 to 24"
    acs_covered: [AC-F054-01, AC-F054-02, AC-F054-03, AC-F054-04]
    ecs_covered: [EC-F054-01, EC-F054-02]

  - step: STEP-03
    cr: CR-107
    plan_ref: plans/PLAN_P016.yaml
    plan_step: STEP-03
    hash: 83fadef
    message: "feat(invite): show speech slot label, StatusLED, and status name in second line (CR-107)"
    files_changed:
      - src/components/InviteManagementSection.tsx
    changes:
      - id: CHG-129
        description: "Imported StatusLED component"
      - id: CHG-130
        description: "Replaced simple position text with speechInfoRow View containing slot label, separator, StatusLED, and status name"
      - id: CHG-131
        description: "Added speechInfoRow and statusName styles"
    acs_covered: [AC-F052-01, AC-F052-02, AC-F052-03, AC-F052-04, AC-F052-05]
    ecs_covered: [EC-F052-01, EC-F052-02]

  - step: STEP-04
    cr: CR-105
    plan_ref: plans/PLAN_P016.yaml
    plan_step: STEP-04
    hash: 96944bc
    message: "feat(invite): replace text buttons with WhatsApp SVG icon and Unicode three-dots (CR-105)"
    files_changed:
      - src/components/InviteManagementSection.tsx
    changes:
      - id: CHG-132
        description: "Added Svg and Path imports from react-native-svg"
      - id: CHG-133
        description: "Created WhatsAppIcon inline component with SVG path"
      - id: CHG-134
        description: "Replaced text content with WhatsAppIcon for isNotInvited and Unicode U+22EE for invited"
      - id: CHG-135
        description: "Changed actionButton to fixed 36x36 with centered content, replaced actionText with actionIcon"
      - id: CHG-136
        description: "Added accessibilityLabel to both button variants"
    acs_covered: [AC-F050-01, AC-F050-02, AC-F050-03, AC-F050-04, AC-F050-05]
    ecs_covered: [EC-F050-01, EC-F050-02]

  - step: STEP-05
    cr: CR-106
    plan_ref: plans/PLAN_P016.yaml
    plan_step: STEP-05
    hash: 152b3b4
    message: "feat(speeches): export STATUS_INDICATOR_COLORS and add assigned_invited -> assigned_not_invited transition (CR-106)"
    files_changed:
      - src/components/StatusChangeModal.tsx
      - src/hooks/useSpeeches.ts
      - src/__tests__/useSpeeches-utils.test.ts
      - src/__tests__/phase03-speech-lifecycle.test.ts
    changes:
      - id: CHG-137
        description: "Exported STATUS_INDICATOR_COLORS constant from StatusChangeModal"
      - id: CHG-138
        description: "Added 'assigned_not_invited' to assigned_invited transitions in VALID_TRANSITIONS"
      - id: CHG-139
        description: "Updated test assertions for new transition count (3 -> 4)"
    acs_covered: [AC-F051-04]

  - step: STEP-06
    cr: CR-106
    plan_ref: plans/PLAN_P016.yaml
    plan_step: STEP-06
    hash: 94b1a24
    message: "feat(i18n): add home.viewConversation key in 3 locales (CR-106)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-140
        description: "Added home.viewConversation key: 'Ver conversa' in pt-BR.json"
      - id: CHG-141
        description: "Added home.viewConversation key: 'View conversation' in en.json"
      - id: CHG-142
        description: "Added home.viewConversation key: 'Ver conversacion' in es.json"
    acs_covered: [AC-F051-02]

  - step: STEP-07
    cr: CR-106
    plan_ref: plans/PLAN_P016.yaml
    plan_step: STEP-07
    hash: ec883c5
    message: "feat(components): create InviteActionDropdown with 5 options for invite status management (CR-106)"
    files_changed:
      - src/components/InviteActionDropdown.tsx
    changes:
      - id: CHG-143
        description: "Created InviteActionDropdown component with Modal, overlay, and 5 options"
      - id: CHG-144
        description: "Option 1: View conversation with inline WhatsApp icon, disabled when no phone"
      - id: CHG-145
        description: "Option 2: Assigned/Confirmed with green indicator from STATUS_INDICATOR_COLORS"
      - id: CHG-146
        description: "Option 3: Assigned/Not invited (reverse transition) with yellow indicator"
      - id: CHG-147
        description: "Option 4: Gave up with red indicator"
      - id: CHG-148
        description: "Option 5: Cancel that closes dropdown"
    acs_covered: [AC-F051-01, AC-F051-02, AC-F051-03, AC-F051-04, AC-F051-05, AC-F051-06, AC-F051-07, AC-F051-08]
    ecs_covered: [EC-F051-01, EC-F051-02, EC-F051-03]

  - step: STEP-08
    cr: CR-106
    plan_ref: plans/PLAN_P016.yaml
    plan_step: STEP-08
    hash: c28bc63
    message: "feat(invite): integrate InviteActionDropdown replacing Alert.alert for status actions (CR-106)"
    files_changed:
      - src/components/InviteManagementSection.tsx
    changes:
      - id: CHG-149
        description: "Removed Alert import, added InviteActionDropdown import"
      - id: CHG-150
        description: "Added dropdownSpeech state (Speech | null)"
      - id: CHG-151
        description: "Simplified handleInvitedAction to setDropdownSpeech(speech)"
      - id: CHG-152
        description: "Added handleDropdownWhatsApp callback with null-then-open pattern"
      - id: CHG-153
        description: "Added handleDropdownStatusChange callback with null-then-mutate pattern"
      - id: CHG-154
        description: "Rendered InviteActionDropdown at end of section View"
    acs_covered: [AC-F051-01, AC-F051-07]

  - step: STEP-09
    cr: [CR-105, CR-106, CR-107, CR-110, CR-111]
    plan_ref: plans/PLAN_P016.yaml
    plan_step: STEP-09
    hash: ef42ed7
    message: "test(batch8-phase2): add tests for F050, F051, F052, F053, F054"
    files_changed:
      - src/__tests__/batch8-phase2.test.ts
      - src/__tests__/permissions.test.ts
    tests_added: 78
    changes:
      - id: CHG-155
        description: "Created batch8-phase2.test.ts with 78 tests covering all 5 features"
      - id: CHG-156
        description: "Updated permissions.test.ts to reflect bishopric home:invite_mgmt = true and 24 permissions"
    acs_covered: [AC-F050-01, AC-F050-05, AC-F051-01, AC-F051-08, AC-F052-01, AC-F052-05, AC-F053-01, AC-F053-05, AC-F054-01, AC-F054-04]
    ecs_covered: [EC-F050-01, EC-F051-01, EC-F052-01, EC-F053-01, EC-F054-01]

batch8_phase2_test_results:
  new_tests: 78
  new_tests_passing: 78
  full_suite_tests: 3061
  full_suite_passing: 3061
  full_suite_files: 60
  regressions: 0

  # --- Batch 9, Phase 1: CR-113, CR-112, CR-122, CR-117, CR-125 ---

  - step: STEP-01
    cr: CR-113
    plan_ref: plans/PLAN_P017.yaml
    plan_step: STEP-01
    hash: cf1c8cf
    message: "fix(invite): change InviteActionDropdown title to i18n changeStatus label (CR-113)"
    files_changed:
      - src/components/InviteActionDropdown.tsx
    changes:
      - id: CHG-157
        description: "Replaced speech?.speaker_name with t('speeches.changeStatus') in dropdown title"
      - id: CHG-158
        description: "Updated JSX comment from 'speaker name' to 'i18n status change label'"
    acs_covered: [AC-F056-01, AC-F056-02, AC-F056-03]

  - step: STEP-02
    cr: CR-112
    plan_ref: plans/PLAN_P017.yaml
    plan_step: STEP-02
    hash: 3160210
    message: "feat(whatsapp): add buildWhatsAppConversationUrl for opening chat without message (CR-112)"
    files_changed:
      - src/lib/whatsappUtils.ts
      - src/lib/whatsapp.ts
    changes:
      - id: CHG-159
        description: "Added buildWhatsAppConversationUrl(phone) function returning https://wa.me/{cleanPhone} without ?text="
      - id: CHG-160
        description: "Added re-export of buildWhatsAppConversationUrl in whatsapp.ts barrel"
    acs_covered: [AC-F055-01, AC-F055-02]

  - step: STEP-03
    cr: CR-112
    plan_ref: plans/PLAN_P017.yaml
    plan_step: STEP-03
    hash: 6ff6d4c
    message: "fix(invite): use buildWhatsAppConversationUrl for View Conversation action (CR-112)"
    files_changed:
      - src/components/InviteManagementSection.tsx
    changes:
      - id: CHG-161
        description: "Replaced buildWhatsAppUrl call in handleDropdownWhatsApp with buildWhatsAppConversationUrl"
      - id: CHG-162
        description: "Removed unused template/date/position/collection/link variables from handleDropdownWhatsApp"
      - id: CHG-163
        description: "Added buildWhatsAppConversationUrl to import statement"
    acs_covered: [AC-F055-03, AC-F055-04, AC-F055-05]

  - step: STEP-04
    cr: CR-122
    plan_ref: plans/PLAN_P017.yaml
    plan_step: STEP-04
    hash: 0005ea6
    message: "feat(i18n): add speeches.lastSpeech key and update 4 locations for position 3 (CR-122)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
      - src/components/SpeechSlot.tsx
      - src/components/AgendaForm.tsx
      - src/components/InviteManagementSection.tsx
      - src/hooks/usePresentationMode.ts
    changes:
      - id: CHG-164
        description: "Added speeches.lastSpeech key: pt-BR 'Último Discurso', en 'Final Speech', es 'Último Discurso'"
      - id: CHG-165
        description: "Updated getPositionLabel() in SpeechSlot.tsx to return t('speeches.lastSpeech') for position 3"
      - id: CHG-166
        description: "Updated AgendaForm speaker 3 label to use t('speeches.lastSpeech')"
      - id: CHG-167
        description: "Updated InviteManagementSection second line to use t('speeches.lastSpeech') for position 3"
      - id: CHG-168
        description: "Updated usePresentationMode card 4 label to use t('speeches.lastSpeech')"
    acs_covered: [AC-F058-01, AC-F058-02, AC-F058-03, AC-F058-04, AC-F058-05]

  - step: STEP-05
    cr: CR-117
    plan_ref: plans/PLAN_P017.yaml
    plan_step: STEP-05
    hash: 017b7a5
    message: "fix(country): reorder USA before Canada for +1 default and add getCountryByLabel (CR-117)"
    files_changed:
      - src/lib/countryCodes.ts
    changes:
      - id: CHG-169
        description: "Moved United States (+1) entry before Canada (+1) in COUNTRY_CODES array"
      - id: CHG-170
        description: "Added getCountryByLabel(label) function for unique country lookup"
    acs_covered: [AC-F057-01, AC-F057-02, AC-F057-03]

  - step: STEP-06
    cr: CR-117
    plan_ref: plans/PLAN_P017.yaml
    plan_step: STEP-06
    hash: fe1bfba
    message: "fix(members): highlight country by label instead of code to resolve +1 ambiguity (CR-117)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
    changes:
      - id: CHG-171
        description: "Added countryLabel state initialized from member's country_code"
      - id: CHG-172
        description: "Changed highlight comparison from item.code === countryCode to item.label === countryLabel"
      - id: CHG-173
        description: "Updated onPress to set both countryCode and countryLabel"
    acs_covered: [AC-F057-04, AC-F057-05]

  - step: STEP-07
    cr: CR-125
    plan_ref: plans/PLAN_P017.yaml
    plan_step: STEP-07
    hash: d3ec6a6
    message: "feat(prayer): add modalOnly prop to PrayerSelector to suppress inline button (CR-125)"
    files_changed:
      - src/components/PrayerSelector.tsx
    changes:
      - id: CHG-174
        description: "Added modalOnly?: boolean prop to PrayerSelectorProps interface"
      - id: CHG-175
        description: "Wrapped inline Pressable in {!modalOnly && (...)} conditional"
    acs_covered: [AC-F059-01, AC-F059-02]

  - step: STEP-08
    cr: CR-125
    plan_ref: plans/PLAN_P017.yaml
    plan_step: STEP-08
    hash: abfda79
    message: "fix(agenda): pass modalOnly={true} to PrayerSelector to fix field duplication (CR-125)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-176
        description: "Added modalOnly={true} prop to PrayerSelector in AgendaForm selectorModal rendering"
    acs_covered: [AC-F059-03, AC-F059-04, AC-F059-05]

  - step: STEP-TEST-FIX
    cr: [CR-112, CR-113, CR-117]
    plan_ref: plans/PLAN_P017.yaml
    hash: 8124f5f
    message: "test(batch9): update existing tests to reflect F055, F056, F057 changes"
    files_changed:
      - src/__tests__/batch6-f027-f031.test.ts
      - src/__tests__/batch7-f035-f039.test.ts
      - src/__tests__/batch8-phase1.test.ts
      - src/__tests__/batch8-phase2.test.ts
    changes:
      - id: CHG-177
        description: "Updated batch6 alphabetical order test to skip USA (ADR-043 reordering)"
      - id: CHG-178
        description: "Updated batch7 highlight test from code-based to label-based comparison (ADR-043)"
      - id: CHG-179
        description: "Updated batch8-phase1 test for handleDropdownWhatsApp now using buildWhatsAppConversationUrl"
      - id: CHG-180
        description: "Updated batch8-phase2 test for dropdown title now using t('speeches.changeStatus')"

batch9_phase1_test_results:
  full_suite_tests: 3061
  full_suite_passing: 3061
  full_suite_files: 60
  regressions: 0

  # --- Batch 9, Phase 2: CR-114, CR-115, CR-116, CR-119, CR-121 ---

  - step: STEP-01
    cr: CR-119
    plan_ref: plans/PLAN_P018.yaml
    plan_step: STEP-01
    hash: ec285bd
    message: "feat(speech-slot): reorder layout to [LED][Field][X] and align topic field (CR-119)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-181
        description: "Moved StatusLED before speaker Pressable in row"
      - id: CHG-182
        description: "Added marginLeft: 28 to topicField style to align with speaker field"
    acs_covered: [AC-F063-01, AC-F063-02, AC-F063-03]

  - step: STEP-02
    cr: CR-114
    plan_ref: plans/PLAN_P018.yaml
    plan_step: STEP-02
    hash: 5500894
    message: "feat(speech-slot): add onClearTopic prop and X button to topic field (CR-114)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-183
        description: "Added onClearTopic optional prop to SpeechSlotProps interface"
      - id: CHG-184
        description: "Added handleClearTopic callback that calls onClearTopic with speech.id"
      - id: CHG-185
        description: "Added X button (Pressable) in topic field when topicDisplay exists and canAssign"
    acs_covered: [AC-F060-01, AC-F060-02, AC-F060-03]

  - step: STEP-03
    cr: CR-114
    plan_ref: plans/PLAN_P018.yaml
    plan_step: STEP-03
    hash: 6d80369
    message: "feat(speeches): wire onClearTopic in speeches.tsx and NextSundaysSection (CR-114)"
    files_changed:
      - src/app/(tabs)/speeches.tsx
      - src/components/NextSundaysSection.tsx
    changes:
      - id: CHG-186
        description: "Added handleClearTopic callback in speeches.tsx calling assignTopic with null values"
      - id: CHG-187
        description: "Passed onClearTopic={handleClearTopic} to SpeechSlot in speeches.tsx"
      - id: CHG-188
        description: "Added handleClearTopic callback in NextSundaysSection.tsx calling assignTopic with null values"
      - id: CHG-189
        description: "Passed onClearTopic={handleClearTopic} to SpeechSlot in NextSundaysSection.tsx"
    acs_covered: [AC-F060-04, AC-F060-05]

  - step: STEP-04
    cr: CR-116
    plan_ref: plans/PLAN_P018.yaml
    plan_step: STEP-04
    hash: 429915d
    message: "feat(status-modal): add optional allowedStatuses prop for filtering transitions (CR-116)"
    files_changed:
      - src/components/StatusChangeModal.tsx
    changes:
      - id: CHG-190
        description: "Added allowedStatuses optional prop to StatusChangeModalProps"
      - id: CHG-191
        description: "Added filtering logic: intersect availableStatuses with allowedStatuses if provided"
      - id: CHG-192
        description: "Changed FlatList data from availableStatuses to filtered"
    acs_covered: [AC-F062-01, AC-F062-02]

  - step: STEP-05
    cr: CR-116
    plan_ref: plans/PLAN_P018.yaml
    plan_step: STEP-05
    hash: 97e8725
    message: "feat(speech-slot): filter LED click to confirmed/gave_up for assigned_invited (CR-116)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-193
        description: "Added ledAllowedStatuses variable filtering to confirmed/gave_up when status is assigned_invited"
      - id: CHG-194
        description: "Passed allowedStatuses={ledAllowedStatuses} to StatusChangeModal"
    acs_covered: [AC-F062-03, AC-F062-04]

  - step: STEP-06
    cr: CR-115
    plan_ref: plans/PLAN_P018.yaml
    plan_step: STEP-06
    hash: c95e1d3
    message: "feat(sunday-card): add confirmation dialog when changing type with assignments (CR-115)"
    files_changed:
      - src/components/SundayCard.tsx
    changes:
      - id: CHG-195
        description: "Added Alert import to SundayCard.tsx"
      - id: CHG-196
        description: "Added speeches prop to SundayTypeDropdownProps interface"
      - id: CHG-197
        description: "Added confirmation Alert when changing FROM speeches WITH speaker_name or topic_title assignments"
      - id: CHG-198
        description: "Passed speeches prop to SundayTypeDropdown"
    acs_covered: [AC-F061-01, AC-F061-02, AC-F061-03, AC-F061-04]

  - step: STEP-07
    cr: [CR-115, CR-121]
    plan_ref: plans/PLAN_P018.yaml
    plan_step: STEP-07
    hash: 8ec4f3a
    message: "feat(i18n): add changeConfirmTitle/Message and lastMinuteAssignment keys in 3 locales (CR-115, CR-121)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-199
        description: "Added sundayExceptions.changeConfirmTitle key in pt-BR, en, es"
      - id: CHG-200
        description: "Added sundayExceptions.changeConfirmMessage key in pt-BR, en, es"
      - id: CHG-201
        description: "Added agenda.lastMinuteAssignment key in pt-BR, en, es"
    acs_covered: [AC-F061-05, AC-F064-01]

  - step: STEP-08
    cr: CR-121
    plan_ref: plans/PLAN_P018.yaml
    plan_step: STEP-08
    hash: 162c74b
    message: "feat(agenda): show last-minute assignment label on speaker override (CR-121)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-202
        description: "Added useTranslation hook to SpeakerField sub-component"
      - id: CHG-203
        description: "Added italic '(Last-minute assignment)' Text below speakerReadRow when hasOverride"
      - id: CHG-204
        description: "Added lastMinuteLabel style (fontSize 11, fontStyle italic, marginTop 2)"
    acs_covered: [AC-F064-02, AC-F064-03, AC-F064-04]

batch9_phase2_test_results:
  full_suite_tests: 3128
  full_suite_passing: 3128
  full_suite_files: 61
  regressions: 0

  # --- Batch 9, Phase 3: CR-118, CR-120, CR-123 ---

  - step: STEP-01
    cr: CR-118
    plan_ref: plans/PLAN_P019.yaml
    plan_step: STEP-01
    hash: ff29a6a
    message: "fix(search-input): add flex:1 defensivo to SearchInput container (CR-118)"
    files_changed:
      - src/components/SearchInput.tsx
    changes:
      - id: CHG-205
        description: "Added flex: 1 to styles.container in SearchInput (ADR-046 flex defensivo)"
    acs_covered: [AC-F065-01]

  - step: STEP-02
    cr: CR-118
    plan_ref: plans/PLAN_P019.yaml
    plan_step: STEP-02
    hash: 244b6e3
    message: "feat(settings): add close button and row layout to search in 4 Settings screens (CR-118)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
      - src/app/(tabs)/settings/topics.tsx
      - src/app/(tabs)/settings/history.tsx
      - src/app/(tabs)/settings/timezone.tsx
    changes:
      - id: CHG-206
        description: "Added flexDirection:'row', alignItems:'center', gap:12 to searchContainer in 4 screens"
      - id: CHG-207
        description: "Added Pressable close button with t('common.close') that clears search in 4 screens"
      - id: CHG-208
        description: "Added closeButtonText style (fontSize 16, fontWeight 500) in 4 screens"
    acs_covered: [AC-F065-02, AC-F065-03, AC-F065-04, AC-F065-05, AC-F065-06, AC-F065-07, AC-F065-08, AC-F065-09, AC-F065-10]

  - step: STEP-03
    cr: CR-120
    plan_ref: plans/PLAN_P019.yaml
    plan_step: STEP-03
    hash: e7bd14e
    message: "feat(speeches): auto-scroll to expanded card on toggle (CR-120)"
    files_changed:
      - src/app/(tabs)/speeches.tsx
    changes:
      - id: CHG-209
        description: "Added scrollToIndex with viewPosition:0 after 300ms setTimeout in handleToggle expand branch (ADR-047)"
      - id: CHG-210
        description: "Added listItems to useCallback dependency array"
    acs_covered: [AC-F066-01, AC-F066-03, AC-F066-04, AC-F066-05]

  - step: STEP-04
    cr: CR-120
    plan_ref: plans/PLAN_P019.yaml
    plan_step: STEP-04
    hash: 8a8e56e
    message: "feat(agenda): auto-scroll to expanded card on toggle (CR-120)"
    files_changed:
      - src/app/(tabs)/agenda.tsx
    changes:
      - id: CHG-211
        description: "Added scrollToIndex with viewPosition:0 after 300ms setTimeout in handleToggle expand branch (ADR-047)"
      - id: CHG-212
        description: "Added listItems to useCallback dependency array"
    acs_covered: [AC-F066-02, AC-F066-03, AC-F066-04, AC-F066-05]

  - step: STEP-05
    cr: CR-123
    plan_ref: plans/PLAN_P019.yaml
    plan_step: STEP-05
    hash: 96fdc83
    message: "feat(agenda): replace SelectorField with Pressable for recognizing field (CR-123)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-213
        description: "Replaced SelectorField with custom Pressable that renders each recognized_name as individual Text (ADR-048)"
      - id: CHG-214
        description: "Added recognizingName style (fontSize 15, paddingVertical 2)"
    acs_covered: [AC-F067-01, AC-F067-02, AC-F067-03, AC-F067-04, AC-F067-05, AC-F067-06]

  - step: STEP-06
    cr: [CR-118, CR-120, CR-123]
    plan_ref: plans/PLAN_P019.yaml
    plan_step: STEP-07
    hash: 15ef52e
    message: "test(batch9-phase3): add tests for F065, F066, F067"
    files_changed:
      - src/__tests__/batch9-phase3.test.ts
    tests_added: 80
    acs_covered: [AC-F065-01, AC-F065-12, AC-F066-01, AC-F066-07, AC-F067-01, AC-F067-07]
    ecs_covered: [EC-F065-01, EC-F065-02, EC-F066-01, EC-F066-03, EC-F067-01, EC-F067-03]

  - step: STEP-07
    cr: CR-123
    plan_ref: plans/PLAN_P019.yaml
    plan_step: STEP-08
    hash: 97f1e5f
    message: "fix(tests): update recognizing field tests for CR-123 Pressable change"
    files_changed:
      - src/__tests__/cr004-f008-agenda-actors.test.ts
    changes:
      - id: CHG-215
        description: "Updated 3 tests expecting SelectorField and .join(', ') to expect Pressable and .map()"

  - step: STEP-08
    cr: CR-123
    plan_ref: plans/PLAN_P019.yaml
    plan_step: STEP-08
    hash: b9a010b
    message: "fix(tests): update batch7 recognizing field test for CR-123 change"
    files_changed:
      - src/__tests__/batch7-f040-f044.test.ts
    changes:
      - id: CHG-216
        description: "Updated AC-F042-03 test to expect .map() rendering instead of .join(', ')"

batch9_phase3_test_results:
  new_tests: 80
  new_tests_passing: 80
  full_suite_tests: 3296
  full_suite_passing: 3296
  full_suite_files: 63
  regressions: 0

  # --- Batch 10, Phase 1: CR-126, CR-127, CR-129, CR-130 ---

  - step: STEP-01
    cr: CR-126
    plan_ref: plans/PLAN_P020.yaml
    plan_step: STEP-01
    hash: d6519da
    message: "feat(status-led): redesign StatusLED to flat circle with new color scheme (CR-126)"
    files_changed:
      - src/components/StatusLED.tsx
    changes:
      - id: CHG-217
        description: "Removed 3D effect (outerRing, innerCircle, glowDot) and LEDColors interface"
      - id: CHG-218
        description: "Replaced with flat circle using single Animated.View and Record<SpeechStatus, string>"
      - id: CHG-219
        description: "New colors: gray #9CA3AF, orange #F97316, yellow #EAB308, green #22C55E, dark wine #7F1D1D"
    acs_covered: [AC-F069-01, AC-F069-02, AC-F069-03, AC-F069-04, AC-F069-05, AC-F069-06, AC-F069-07, AC-F069-08, AC-F069-10, AC-F069-11]

  - step: STEP-02
    cr: CR-126
    plan_ref: plans/PLAN_P020.yaml
    plan_step: STEP-02
    hash: 516b606
    message: "feat(status-modal): update STATUS_INDICATOR_COLORS to match new flat LED colors (CR-126)"
    files_changed:
      - src/components/StatusChangeModal.tsx
    changes:
      - id: CHG-220
        description: "Updated STATUS_INDICATOR_COLORS: assigned_not_invited #F97316, assigned_invited #EAB308, assigned_confirmed #22C55E, gave_up #7F1D1D"
    acs_covered: [AC-F069-09]

  - step: STEP-03
    cr: CR-127
    plan_ref: plans/PLAN_P020.yaml
    plan_step: STEP-03
    hash: c7a278c
    message: "feat(speeches): add useDeleteSpeechesByDate hook for sunday type cleanup (CR-127)"
    files_changed:
      - src/hooks/useSpeeches.ts
    changes:
      - id: CHG-221
        description: "Added useDeleteSpeechesByDate hook that deletes speeches by ward_id + sunday_date"
      - id: CHG-222
        description: "Added cache invalidation (speechKeys.all) and logAction for speech_cleanup"
    acs_covered: [AC-F070-01, AC-F070-06, AC-F070-07]

  - step: STEP-04
    cr: CR-130
    plan_ref: plans/PLAN_P020.yaml
    plan_step: STEP-04
    hash: fd63a3e
    message: "fix(members): use getCountryByLabel for flag display to fix shared dial code (CR-130)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
    changes:
      - id: CHG-223
        description: "Added import of getCountryByLabel from countryCodes.ts"
      - id: CHG-224
        description: "Changed flag display from getFlagForCode(countryCode) to getCountryByLabel(countryLabel)?.flag ?? getFlagForCode(countryCode)"
    acs_covered: [AC-F072-01, AC-F072-02, AC-F072-03, AC-F072-04, AC-F072-05]

  - step: STEP-05
    cr: CR-127
    plan_ref: plans/PLAN_P020.yaml
    plan_step: STEP-05
    hash: e6b8dd2
    message: "feat(sunday-card): add onDeleteSpeeches prop to SundayTypeDropdown for type change cleanup (CR-127)"
    files_changed:
      - src/components/SundayCard.tsx
    changes:
      - id: CHG-225
        description: "Added date and onDeleteSpeeches props to SundayTypeDropdownProps interface"
      - id: CHG-226
        description: "Added onDeleteSpeeches to SundayCardProps interface"
      - id: CHG-227
        description: "Call onDeleteSpeeches in destructive confirm and in no-assignments flow when changing from speeches"
    acs_covered: [AC-F070-02, AC-F070-03, AC-F070-04, AC-F070-05, AC-F070-08]

  - step: STEP-06
    cr: CR-127
    plan_ref: plans/PLAN_P020.yaml
    plan_step: STEP-06
    hash: 5ef1ed5
    message: "feat(speeches): wire handleDeleteSpeeches to SundayCard for type change cleanup (CR-127)"
    files_changed:
      - src/app/(tabs)/speeches.tsx
    changes:
      - id: CHG-228
        description: "Imported useDeleteSpeechesByDate from useSpeeches"
      - id: CHG-229
        description: "Created deleteSpeechesByDate instance and handleDeleteSpeeches callback"
      - id: CHG-230
        description: "Passed onDeleteSpeeches={handleDeleteSpeeches} to SundayCard"
      - id: CHG-231
        description: "Added handleDeleteSpeeches to renderItem dependency array"
    acs_covered: [AC-F070-05]

  - step: STEP-07
    cr: CR-129
    plan_ref: plans/PLAN_P020.yaml
    plan_step: STEP-07
    hash: a101989
    message: "feat(speech-slot): filter LED to exclude not_assigned and disable for terminal states (CR-129)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-232
        description: "Changed ledAllowedStatuses from conditional (assigned_invited only) to constant array of 4 statuses"
      - id: CHG-233
        description: "Added assigned_confirmed and gave_up to handleStatusPress early return"
      - id: CHG-234
        description: "Added assigned_confirmed and gave_up to StatusLED disabled condition"
    acs_covered: [AC-F071-01, AC-F071-02, AC-F071-03, AC-F071-04, AC-F071-05, AC-F071-06, AC-F071-07]

  - step: STEP-08
    cr: [CR-126, CR-127, CR-129, CR-130]
    plan_ref: plans/PLAN_P020.yaml
    plan_step: STEP-08
    hash: 118645f
    message: "test(batch10-phase1): add 84 tests for F069, F070, F071, F072"
    files_changed:
      - src/__tests__/batch10-phase1.test.ts
    tests_added: 84
    acs_covered: [AC-F069-01, AC-F069-12, AC-F070-01, AC-F070-08, AC-F071-01, AC-F071-07, AC-F072-01, AC-F072-08]
    ecs_covered: [EC-F069-01, EC-F069-03, EC-F070-01, EC-F070-04, EC-F071-01, EC-F071-02, EC-F072-01, EC-F072-02]

  - step: STEP-09
    cr: CR-129
    plan_ref: plans/PLAN_P020.yaml
    plan_step: STEP-09
    hash: f797810
    message: "fix(tests): update batch9 F062 tests for CR-129 changes to ledAllowedStatuses"
    files_changed:
      - src/__tests__/batch9-phase2.test.ts
    changes:
      - id: CHG-235
        description: "Updated 5 F062 tests to reflect F071 changes: constant ledAllowedStatuses, disabled terminal states"

batch10_phase1_test_results:
  new_tests: 84
  new_tests_passing: 84
  full_suite_tests: 3380
  full_suite_passing: 3380
  full_suite_files: 64
  regressions: 0

  # --- Batch 10, Phase 2: CR-128, CR-131, CR-132, CR-133 ---

  - step: STEP-01
    cr: CR-128
    plan_ref: plans/PLAN_P021.yaml
    plan_step: STEP-01
    hash: 71987d9
    message: "feat(speech-slot): move topic X button outside dropdown field as sibling (CR-128)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-236
        description: "Wrapped topicField Pressable and clearTopic Pressable in topicRow View container"
      - id: CHG-237
        description: "Moved X button from inside topicField Pressable to sibling in topicRow View"
      - id: CHG-238
        description: "Added topicRow style with flexDirection row, alignItems center, gap 12"
      - id: CHG-239
        description: "Moved marginTop and marginLeft from topicField to topicRow, added flex:1 to topicField"
    acs_covered: [AC-073-01, AC-073-02, AC-073-03, AC-073-04, AC-073-05]
    ecs_covered: [EC-073-01, EC-073-02, EC-073-03]

  - step: STEP-02
    cr: CR-131
    plan_ref: plans/PLAN_P021.yaml
    plan_step: STEP-02
    hash: 651fbf7
    message: "fix(agenda): simplify searchInput style to inherit from SearchInput base (CR-131)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-240
        description: "Removed borderWidth, borderRadius, paddingHorizontal, paddingVertical, fontSize, marginBottom from searchInput style"
      - id: CHG-241
        description: "Left only flex:1 in searchInput to inherit styling from SearchInput base component"
    acs_covered: [AC-074-01, AC-074-02, AC-074-03, AC-074-04]
    ecs_covered: [EC-074-01, EC-074-02]

  - step: STEP-03
    cr: CR-132
    plan_ref: plans/PLAN_P021.yaml
    plan_step: STEP-03
    hash: ce73721
    message: "fix(speeches): remove getItemLayout and increase scroll delay to 400ms (CR-132)"
    files_changed:
      - src/app/(tabs)/speeches.tsx
    changes:
      - id: CHG-242
        description: "Removed getItemLayout callback and prop from FlatList"
      - id: CHG-243
        description: "Increased setTimeout delay from 300ms to 400ms in handleToggle"
    acs_covered: [AC-075-02, AC-075-03, AC-075-04, AC-075-05]
    ecs_covered: [EC-075-04]

  - step: STEP-04
    cr: CR-132
    plan_ref: plans/PLAN_P021.yaml
    plan_step: STEP-04
    hash: 6984288
    message: "fix(agenda): remove getItemLayout, initialScrollIndex and increase scroll delay to 400ms (CR-132)"
    files_changed:
      - src/app/(tabs)/agenda.tsx
    changes:
      - id: CHG-244
        description: "Removed ESTIMATED_ITEM_HEIGHT constant, getItemLayout callback, and getItemLayout/initialScrollIndex FlatList props"
      - id: CHG-245
        description: "Increased setTimeout delay from 300ms to 400ms in handleToggle"
    acs_covered: [AC-075-01, AC-075-03, AC-075-04, AC-075-05]
    ecs_covered: [EC-075-04]

  - step: STEP-05
    cr: CR-133
    plan_ref: plans/PLAN_P021.yaml
    plan_step: STEP-05
    hash: 7399634
    message: "feat(prayer): add custom name hint text for discoverability in PrayerSelector (CR-133)"
    files_changed:
      - src/components/PrayerSelector.tsx
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-246
        description: "Added hint Text with t('agenda.customNameHint') using customNameHintText style"
      - id: CHG-247
        description: "Added customNameHintText style (fontSize 13, paddingHorizontal 16, paddingBottom 8)"
      - id: CHG-248
        description: "Added agenda.customNameHint i18n key in pt-BR, en, es"
    acs_covered: [AC-076-01, AC-076-02, AC-076-07]

  - step: STEP-06
    cr: CR-133
    plan_ref: plans/PLAN_P021.yaml
    plan_step: STEP-06
    hash: 8035a42
    message: "feat(prayer): pre-populate search field when re-editing custom prayer name (CR-133)"
    files_changed:
      - src/components/PrayerSelector.tsx
    changes:
      - id: CHG-249
        description: "Updated useEffect to pre-populate search/customName when selected.memberId === null and selected.name exists"
    acs_covered: [AC-076-03, AC-076-04, AC-076-05, AC-076-06]
    ecs_covered: [EC-076-01, EC-076-02, EC-076-03, EC-076-04]

  - step: STEP-07
    cr: [CR-128, CR-131, CR-132, CR-133]
    plan_ref: plans/PLAN_P021.yaml
    plan_step: STEP-07
    hash: ea24151
    message: "test(batch10): add tests for Phase 2 features F073-F076 (CR-128, CR-131, CR-132, CR-133)"
    files_changed:
      - src/__tests__/batch10-phase2.test.ts
    tests_added: 69
    acs_covered: [AC-073-01, AC-073-05, AC-074-01, AC-074-04, AC-075-01, AC-075-05, AC-076-01, AC-076-07]
    ecs_covered: [EC-073-01, EC-073-03, EC-074-01, EC-074-02, EC-075-04, EC-076-01, EC-076-04]

  - step: STEP-08
    cr: [CR-128, CR-131, CR-132, CR-133]
    plan_ref: plans/PLAN_P021.yaml
    plan_step: STEP-08
    hash: 0b2a117
    message: "fix(tests): update legacy tests for Phase 2 changes (F073-F076)"
    files_changed:
      - src/__tests__/batch7-f035-f039.test.ts
      - src/__tests__/batch9-phase2.test.ts
      - src/__tests__/batch9-phase3.test.ts
      - src/__tests__/batch10-phase1.test.ts
      - src/__tests__/cr004-f006-uiux-fixes.test.ts
    changes:
      - id: CHG-250
        description: "Updated batch7 PrayerSelector useEffect test for new block-style visible check"
      - id: CHG-251
        description: "Updated batch9-phase2 F060 tests: X button now sibling of topicField, marginLeft on topicRow"
      - id: CHG-252
        description: "Updated batch9-phase3 F066 tests: 300ms -> 400ms, getItemLayout removed"
      - id: CHG-253
        description: "Updated batch10-phase1 renderItem deps test boundary from getItemLayout to speechesError"
      - id: CHG-254
        description: "Updated cr004-f006 renderItem test boundary from getItemLayout to speechesError"

batch10_phase2_test_results:
  new_tests: 69
  new_tests_passing: 69
  full_suite_tests: 3449
  full_suite_passing: 3449
  full_suite_files: 65
  regressions: 0

  # --- Batch 11: CR-134, CR-135, CR-136, CR-137, CR-138 ---

  - step: STEP-01
    cr: CR-134
    plan_ref: plans/PLAN_P022.yaml
    plan_step: STEP-01
    hash: 7eb8422
    message: "feat(speeches): expand VALID_TRANSITIONS to full mesh between assigned statuses (CR-134)"
    files_changed:
      - src/hooks/useSpeeches.ts
    changes:
      - id: CHG-255
        description: "Expanded VALID_TRANSITIONS: each assigned status can transition to the other 3 assigned + not_assigned"
    acs_covered: [AC-077-03, AC-077-04, AC-077-05, AC-077-08]

  - step: STEP-02
    cr: CR-134
    plan_ref: plans/PLAN_P022.yaml
    plan_step: STEP-02
    hash: 345db12
    message: "feat(speech-slot): remove LED blocking for assigned_confirmed and gave_up (CR-134)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-256
        description: "Removed assigned_confirmed and gave_up from handleStatusPress early return"
      - id: CHG-257
        description: "Removed assigned_confirmed and gave_up from StatusLED disabled prop"
    acs_covered: [AC-077-03, AC-077-04, AC-077-05, AC-077-06, AC-077-07]

  - step: STEP-03
    cr: CR-134
    plan_ref: plans/PLAN_P022.yaml
    plan_step: STEP-03
    hash: c7f5d4d
    message: "feat(invite): dynamize status options in InviteActionDropdown excluding current status (CR-134)"
    files_changed:
      - src/components/InviteActionDropdown.tsx
    changes:
      - id: CHG-258
        description: "Added ALL_ASSIGNED_STATUSES constant and statusOptions filtered by current status"
      - id: CHG-259
        description: "Replaced 3 hardcoded Pressable with statusOptions.map() for dynamic rendering"
    acs_covered: [AC-077-01, AC-077-02]

  - step: STEP-04
    cr: CR-135
    plan_ref: plans/PLAN_P022.yaml
    plan_step: STEP-04
    hash: 5b7d8ed
    message: "feat(i18n): change customNameHint text for better discoverability (CR-135)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-260
        description: "Changed agenda.customNameHint in pt-BR to 'Para escolher um não membro, digite o nome da pessoa e adicione como nome personalizado'"
      - id: CHG-261
        description: "Changed agenda.customNameHint in en to 'To choose a non-member, type the person's name and add as a custom name'"
      - id: CHG-262
        description: "Changed agenda.customNameHint in es to 'Para elegir un no miembro, escriba el nombre de la persona y agregue como nombre personalizado'"
    acs_covered: [AC-078-01, AC-078-02, AC-078-03]

  - step: STEP-05
    cr: CR-136
    plan_ref: plans/PLAN_P022.yaml
    plan_step: STEP-05
    hash: 80fe032
    message: "feat(agenda): add viewPosition 0.5 to initial scroll for centered positioning (CR-136)"
    files_changed:
      - src/app/(tabs)/agenda.tsx
    changes:
      - id: CHG-263
        description: "Added viewPosition: 0.5 to scrollToIndex call in useEffect initial scroll"
    acs_covered: [AC-079-01]

  - step: STEP-06
    cr: CR-136
    plan_ref: plans/PLAN_P022.yaml
    plan_step: STEP-06
    hash: 7c348fa
    message: "feat(agenda): improve onScrollToIndexFailed with retry and viewPosition 0.5 (CR-136)"
    files_changed:
      - src/app/(tabs)/agenda.tsx
    changes:
      - id: CHG-264
        description: "Added setTimeout retry with scrollToIndex(viewPosition: 0.5) after initial scrollToOffset fallback"
      - id: CHG-265
        description: "Added listItems.length to useCallback dependency array"
    acs_covered: [AC-079-02, AC-079-03]

  - step: STEP-07
    cr: CR-137
    plan_ref: plans/PLAN_P022.yaml
    plan_step: STEP-07
    hash: 29ca68a
    message: "feat(actor-selector): add checkbox unicode visual for multiselect mode (CR-137)"
    files_changed:
      - src/components/ActorSelector.tsx
    changes:
      - id: CHG-266
        description: "Replaced checkmark prefix text with U+2611/U+2610 checkbox unicode in separate Text element"
      - id: CHG-267
        description: "Added flexDirection:'row' and alignItems:'center' to actorNameArea style"
      - id: CHG-268
        description: "Added checkbox style (fontSize: 20, marginRight: 8)"
    acs_covered: [AC-080-01, AC-080-02, AC-080-03]

  - step: STEP-08
    cr: CR-138
    plan_ref: plans/PLAN_P022.yaml
    plan_step: STEP-08
    hash: ee2c738
    message: "feat(actor-selector): change delete confirmation to actors.deleteConfirm i18n key (CR-138)"
    files_changed:
      - src/components/ActorSelector.tsx
    changes:
      - id: CHG-269
        description: "Changed t('members.deleteConfirm') to t('actors.deleteConfirm') in handleDelete Alert"
    acs_covered: [AC-081-01]

  - step: STEP-09
    cr: CR-138
    plan_ref: plans/PLAN_P022.yaml
    plan_step: STEP-09
    hash: 081b280
    message: "feat(i18n): add actors.deleteConfirm i18n key for actor delete confirmation (CR-138)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-270
        description: "Added actors section with deleteConfirm key in pt-BR.json"
      - id: CHG-271
        description: "Added actors section with deleteConfirm key in en.json"
      - id: CHG-272
        description: "Added actors section with deleteConfirm key in es.json"
    acs_covered: [AC-081-02, AC-081-03, AC-081-04]

  # --- CR-139 commits (Integration Tests - F082) ---

  - step: STEP-01
    cr: CR-139
    plan_ref: plans/PLAN_P023.yaml
    plan_step: STEP-01
    hash: 7328fd5
    message: "feat(auth): export AuthContext const for integration test wrapper (CR-139)"
    files_changed:
      - src/contexts/AuthContext.tsx
    changes:
      - id: CHG-273
        description: "Changed AuthContext from const to export const for TestWrapper access"
    acs_covered: []

  - step: STEP-02
    cr: CR-139
    plan_ref: plans/PLAN_P023.yaml
    plan_step: STEP-02
    hash: 52dbb00
    message: "test(integration): add shared test infrastructure with TestWrapper and mock factories (CR-139)"
    files_changed:
      - src/__tests__/integration/setup-integration.ts
    changes:
      - id: CHG-274
        description: "Created setup-integration.ts with TestWrapper, mock factories, and Supabase mock helpers"
    acs_covered: []

  - step: STEP-02b
    cr: CR-139
    plan_ref: plans/PLAN_P023.yaml
    plan_step: STEP-02
    hash: bc14ca4
    message: "refactor(integration): add renderHook/act/waitFor using react-test-renderer (CR-139)"
    files_changed:
      - src/__tests__/integration/setup-integration.ts
    changes:
      - id: CHG-275
        description: "Added renderHook, act, waitFor implementations using react-test-renderer"
    acs_covered: []

  - step: STEP-03
    cr: CR-139
    plan_ref: plans/PLAN_P023.yaml
    plan_step: STEP-03
    hash: 6f75162
    message: "test(integration): add hooks-supabase integration tests for 9 hooks with ReactQuery (CR-139)"
    files_changed:
      - src/__tests__/integration/hooks-supabase.integration.test.ts
      - package.json
      - package-lock.json
    changes:
      - id: CHG-276
        description: "25 integration tests for hooks-supabase covering AC-082-01 to AC-082-12, EC-082-01 to EC-082-06"
    acs_covered: [AC-082-01, AC-082-02, AC-082-03, AC-082-04, AC-082-05, AC-082-06, AC-082-07, AC-082-08, AC-082-09, AC-082-10, AC-082-11, AC-082-12]

  - step: STEP-04
    cr: CR-139
    plan_ref: plans/PLAN_P023.yaml
    plan_step: STEP-04
    hash: 88f2dfe
    message: "test(integration): add permissions-roles integration tests for RBAC matrix (CR-139)"
    files_changed:
      - src/__tests__/integration/permissions-roles.integration.test.ts
    changes:
      - id: CHG-277
        description: "17 integration tests for permissions matrix and auth context gating"
    acs_covered: [AC-082-13, AC-082-14]

  - step: STEP-05
    cr: CR-139
    plan_ref: plans/PLAN_P023.yaml
    plan_step: STEP-05
    hash: 5c7b01c
    message: "test(integration): add sync-realtime integration tests for offline queue and connection (CR-139)"
    files_changed:
      - src/__tests__/integration/sync-realtime.integration.test.ts
    changes:
      - id: CHG-278
        description: "22 integration tests for sync config, connection utils, and offline queue"
    acs_covered: [AC-082-15, AC-082-16, AC-082-17, AC-082-18]

  - step: STEP-06
    cr: CR-139
    plan_ref: plans/PLAN_P023.yaml
    plan_step: STEP-06
    hash: c63fc52
    message: "test(integration): add sunday-types-auto integration tests for auto-assignment rules (CR-139)"
    files_changed:
      - src/__tests__/integration/sunday-types-auto.integration.test.ts
    changes:
      - id: CHG-279
        description: "24 integration tests for sunday type auto-assignment, getSundayOfMonth, and edge cases"
    acs_covered: [AC-082-19, AC-082-20, AC-082-21, AC-082-22]

  - step: STEP-07
    cr: CR-139
    plan_ref: plans/PLAN_P023.yaml
    plan_step: STEP-07
    hash: 48562ca
    message: "test(integration): add speech-lifecycle integration tests for status transitions (CR-139)"
    files_changed:
      - src/__tests__/integration/speech-lifecycle.integration.test.ts
    changes:
      - id: CHG-280
        description: "19 integration tests for speech status transitions, assignment, and lifecycle"
    acs_covered: [AC-082-23, AC-082-24, AC-082-25, AC-082-26]

  - step: STEP-08
    cr: CR-139
    plan_ref: plans/PLAN_P023.yaml
    plan_step: STEP-08
    hash: 0781c5d
    message: "docs(tests): update TEST_CONSOLIDATED with F082 integration tests (107 new tests)"
    files_changed:
      - docs/tests/TEST_CONSOLIDATED.yaml
    changes:
      - id: CHG-281
        description: "Added 107 integration test entries for F082 and updated stats to 1182 total"
    acs_covered: []

  # --- Batch 13: CR-140 (F083), CR-144 (F087), CR-141 (F084), CR-142/CR-143 (F085) ---

  - step: S01
    cr: CR-140
    plan_ref: plans/PLAN_P024.yaml
    plan_step: S01
    hash: dba78aa
    message: "feat(i18n): rename Settings tab labels in 3 locale files (F083)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-282
        description: "Renamed settings.members to Discursantes/Speakers/Oradores"
      - id: CHG-283
        description: "Renamed settings.topics to Biblioteca de Temas/Topic Library"
      - id: CHG-284
        description: "Renamed settings.users to Usuarios do App/App Users"
      - id: CHG-285
        description: "Renamed settings.history to Historico de Uso/Usage History"
      - id: CHG-286
        description: "Renamed settings.theme to Tema Claro/Escuro/Light-Dark Theme"
      - id: CHG-287
        description: "Renamed members.title, topics.title, users.title, activityLog.title accordingly"

  - step: S02
    cr: CR-144
    plan_ref: plans/PLAN_P024.yaml
    plan_step: S02
    hash: 9b460b0
    message: "fix(sql): add SET search_path='' to 7 PostgreSQL functions (F087)"
    files_changed:
      - supabase/migrations/015_fix_function_search_path.sql
    changes:
      - id: CHG-288
        description: "Created migration 015 recreating 7 functions with SET search_path=''"
      - id: CHG-289
        description: "Added explicit schema qualifiers (public.*, auth.*) to all table references"

  - step: S03
    cr: CR-141
    plan_ref: plans/PLAN_P024.yaml
    plan_step: S03
    hash: d94ddfb
    message: "refactor(components): export SundayTypeDropdown from SundayCard (F084)"
    files_changed:
      - src/components/SundayCard.tsx
    changes:
      - id: CHG-290
        description: "Added export keyword to SundayTypeDropdownProps interface"
      - id: CHG-291
        description: "Added export keyword to SundayTypeDropdown function"

  - step: S04
    cr: CR-141
    plan_ref: plans/PLAN_P024.yaml
    plan_step: S04
    hash: fbdd828
    message: "feat(agenda): add SundayTypeDropdown to expanded agenda cards (F084)"
    files_changed:
      - src/app/(tabs)/agenda.tsx
    changes:
      - id: CHG-292
        description: "Imported SundayTypeDropdown, useSetSundayType, useRemoveSundayException, useDeleteSpeechesByDate"
      - id: CHG-293
        description: "Added speechMap, canEditType, type change handlers to AgendaTabContent"
      - id: CHG-294
        description: "Rendered SundayTypeDropdown as first element in expanded agenda card content"
      - id: CHG-295
        description: "Added speeches, typeDisabled, onTypeChange, onRemoveException, onDeleteSpeeches props to AgendaSundayCard"

  - step: S05
    cr: CR-142
    plan_ref: plans/PLAN_P024.yaml
    plan_step: S05
    hash: f4a2779
    message: "feat(activity-log): add structured log format functions (F085)"
    files_changed:
      - src/lib/activityLog.ts
    changes:
      - id: CHG-296
        description: "Added buildLogDescription() for pipe-delimited format with escaping"
      - id: CHG-297
        description: "Added parseLogDescription() for parsing back to actionType + params"
      - id: CHG-298
        description: "Added formatLogDescription() for i18n rendering with status/role/type translation"

  - step: S06
    cr: CR-142
    plan_ref: plans/PLAN_P024.yaml
    plan_step: S06
    hash: 4562690
    message: "feat(i18n): add 24 activity log event keys + actor roles (F085)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-299
        description: "Added activityLog.events section with 24 i18n keys for all action types"
      - id: CHG-300
        description: "Added activityLog.actorRoles section with 4 role translation keys"

  - step: S07
    cr: CR-143
    plan_ref: plans/PLAN_P024.yaml
    plan_step: S07
    hash: 13b8a19
    message: "refactor(hooks): replace hardcoded log descriptions with buildLogDescription (F085)"
    files_changed:
      - src/hooks/useMembers.ts
      - src/hooks/useSpeeches.ts
      - src/hooks/useTopics.ts
      - src/hooks/useActors.ts
      - src/hooks/useSundayTypes.ts
      - src/hooks/useAgenda.ts
      - src/app/(tabs)/settings/users.tsx
    changes:
      - id: CHG-301
        description: "Updated all 6 hooks and users.tsx to use buildLogDescription() instead of hardcoded strings"
      - id: CHG-302
        description: "Added missing speech:assign_theme log in useAssignTopic"
      - id: CHG-303
        description: "Added missing user:removed log in deleteUserMutation"
      - id: CHG-304
        description: "Removed unused SUNDAY_TYPE_LABELS and getSundayTypeLabel from useSundayTypes"

  - step: S08
    cr: CR-143
    plan_ref: plans/PLAN_P024.yaml
    plan_step: S08
    hash: 2fd5923
    message: "feat(history): render translated activity log descriptions (F085)"
    files_changed:
      - src/app/(tabs)/settings/history.tsx
    changes:
      - id: CHG-305
        description: "Imported formatLogDescription from activityLog.ts"
      - id: CHG-306
        description: "Replaced raw item.description with formatLogDescription(item.description, t)"

  - step: S09
    cr: CR-142
    plan_ref: plans/PLAN_P024.yaml
    plan_step: S09
    hash: 3bd264e
    message: "test(activity-log): add unit tests for structured log functions (F085)"
    files_changed:
      - src/__tests__/activityLog.test.ts
    changes:
      - id: CHG-307
        description: "Added 7 tests for buildLogDescription (params, escaping, empty, numeric)"
      - id: CHG-308
        description: "Added 8 tests for parseLogDescription (null fallback, parsing, escaping, roundtrip)"
      - id: CHG-309
        description: "Added 6 tests for formatLogDescription (fallback, translation, status, role, type)"
    tests_added: 21

  # --- Batch 14, Phase 1: CR-148 (F091), CR-149 (F092), CR-147 (F090), CR-145 (F088), CR-146 (F089) ---

  - step: S01
    cr: CR-148
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S01
    hash: 370d7a4
    message: "fix(i18n): update sunday type change confirmation dialog text (F091, CR-148)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-310
        description: "Updated sundayExceptions.changeConfirmTitle values to include question mark in 3 locales"
      - id: CHG-311
        description: "Updated sundayExceptions.changeConfirmMessage values with detailed text about assignment deletion in 3 locales"
    acs_covered: [AC-091-01, AC-091-02, AC-091-03, AC-091-04, AC-091-05]
    ecs_covered: [EC-091-01, EC-091-02, EC-091-03]

  - step: S02
    cr: CR-149
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S02
    hash: 413b83d
    message: "feat(home): make presentation mode button always visible (F092, CR-149)"
    files_changed:
      - src/app/(tabs)/index.tsx
    changes:
      - id: CHG-312
        description: "Removed useMemo import from react"
      - id: CHG-313
        description: "Removed isTodaySunday import from usePresentationMode"
      - id: CHG-314
        description: "Removed showMeetingButton useMemo and conditional rendering"
      - id: CHG-315
        description: "Rendered presentation mode button View unconditionally"
    acs_covered: [AC-092-01, AC-092-02, AC-092-03, AC-092-04, AC-092-05]
    ecs_covered: [EC-092-01, EC-092-02]

  - step: S03
    cr: CR-147
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S03
    hash: 7b0f660
    message: "fix(ui): add safe area insets and increase font sizes in OfflineBanner (F090, CR-147)"
    files_changed:
      - src/components/OfflineBanner.tsx
    changes:
      - id: CHG-316
        description: "Added useSafeAreaInsets import from react-native-safe-area-context"
      - id: CHG-317
        description: "Called useSafeAreaInsets() and applied paddingTop: insets.top + 8"
      - id: CHG-318
        description: "Changed paddingVertical: 8 to paddingBottom: 8 (paddingTop now dynamic)"
      - id: CHG-319
        description: "Changed text fontSize from 14 to 15 and subtext fontSize from 12 to 13"
    acs_covered: [AC-090-01, AC-090-02, AC-090-03, AC-090-04]
    ecs_covered: [EC-090-01, EC-090-02, EC-090-03]

  - step: S04
    cr: CR-145
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S04
    hash: 7b1a621
    message: "fix(auth): add redirectTo deep link to password reset email (F088, CR-145)"
    files_changed:
      - src/app/(auth)/forgot-password.tsx
    changes:
      - id: CHG-320
        description: "Added import * as Linking from 'expo-linking'"
      - id: CHG-321
        description: "Added redirectUrl via Linking.createURL('/(auth)/reset-password')"
      - id: CHG-322
        description: "Passed { redirectTo: redirectUrl } as second argument to resetPasswordForEmail"
    acs_covered: [AC-088-02, AC-088-04]
    ecs_covered: [EC-088-01]

  - step: S05
    cr: CR-145
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S05
    hash: 0b19da5
    message: "feat(auth): create reset-password page for deep link handling (F088, CR-145)"
    files_changed:
      - src/app/(auth)/reset-password.tsx
    changes:
      - id: CHG-323
        description: "Created reset-password.tsx with password + confirmPassword form fields"
      - id: CHG-324
        description: "Added supabase.auth.updateUser({ password }) on submit"
      - id: CHG-325
        description: "Added PASSWORD_RECOVERY event listener via onAuthStateChange"
      - id: CHG-326
        description: "Added success state with passwordUpdated message and back-to-login link"
      - id: CHG-327
        description: "Added error handling for expired/invalid tokens with resetExpired message"
    acs_covered: [AC-088-03, AC-088-04]
    ecs_covered: [EC-088-02, EC-088-03]

  - step: S06
    cr: CR-145
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S06
    hash: a24dd6e
    message: "feat(i18n): add reset password page i18n keys in 3 languages (F088, CR-145)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-328
        description: "Added auth.resetPasswordTitle, newPassword, confirmPassword, passwordMismatch, passwordUpdated, resetExpired, updatePassword keys in pt-BR"
      - id: CHG-329
        description: "Added same 7 auth keys in en"
      - id: CHG-330
        description: "Added same 7 auth keys in es"
    acs_covered: [AC-088-01, AC-088-03, AC-088-05]
    ecs_covered: [EC-088-04]

  - step: S07
    cr: CR-146
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S07
    hash: 9f2969a
    message: "feat(offline): integrate TanStack Query onlineManager with useConnection (F089, CR-146)"
    files_changed:
      - src/hooks/useConnection.ts
    changes:
      - id: CHG-331
        description: "Added import of onlineManager from @tanstack/react-query"
      - id: CHG-332
        description: "Added onlineManager.setOnline(online) call after setIsOnline(online) in existing useEffect"
    acs_covered: [AC-089-06]
    ecs_covered: [EC-089-02]

  - step: S08
    cr: CR-146
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S08
    hash: 328238d
    message: "feat(offline): configure QueryClient offline-first with silent mutation errors (F089, CR-146)"
    files_changed:
      - src/app/_layout.tsx
    changes:
      - id: CHG-333
        description: "Added onlineManager to import from @tanstack/react-query"
      - id: CHG-334
        description: "Added networkMode: 'offlineFirst' to defaultOptions.queries"
      - id: CHG-335
        description: "Added onlineManager.isOnline() check to retry function (return false when offline)"
      - id: CHG-336
        description: "Added isOffline and isNetworkError checks to MutationCache.onError to silence offline errors"
    acs_covered: [AC-089-01, AC-089-02, AC-089-04, AC-089-05]
    ecs_covered: [EC-089-01, EC-089-03]

  - step: S09
    cr: CR-146
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S09
    hash: 7e8dfc1
    message: "feat(i18n): add offline empty state message in 3 languages (F089, CR-146)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-337
        description: "Added common.offlineNoData key in pt-BR: 'Dados indisponiveis no modo offline'"
      - id: CHG-338
        description: "Added common.offlineNoData key in en: 'Data unavailable in offline mode'"
      - id: CHG-339
        description: "Added common.offlineNoData key in es: 'Datos no disponibles en modo sin conexion'"
    acs_covered: [AC-089-03]
    ecs_covered: [EC-089-01]

  - step: S10
    cr: [CR-145, CR-146, CR-147, CR-148, CR-149]
    plan_ref: plans/PLAN_P025.yaml
    plan_step: S10
    hash: 6149b9d
    message: "test(batch14): add tests for F088, F089, F090, F091, F092 (CR-145 to CR-149)"
    files_changed:
      - src/__tests__/batch14-phase1.test.ts
      - src/__tests__/batch9-phase2.test.ts
      - src/__tests__/cr004-f003-sync-offline.test.ts
      - src/__tests__/cr001-qa-extended.test.ts
    changes:
      - id: CHG-340
        description: "Created batch14-phase1.test.ts with 88 tests covering all 5 features (F088-F092)"
      - id: CHG-341
        description: "Updated batch9-phase2.test.ts changeConfirmTitle and changeConfirmMessage assertions for F091 new values"
      - id: CHG-342
        description: "Updated cr004-f003-sync-offline.test.ts paddingVertical assertion to paddingBottom for F090 change"
      - id: CHG-343
        description: "Updated cr001-qa-extended.test.ts showMeetingButton tests to reflect F092 unconditional rendering"
    tests_added: 88
    acs_covered: [AC-088-01, AC-088-05, AC-089-01, AC-089-06, AC-090-01, AC-090-04, AC-091-01, AC-091-05, AC-092-01, AC-092-05]
    ecs_covered: [EC-088-01, EC-088-04, EC-089-01, EC-089-03, EC-090-01, EC-090-03, EC-091-01, EC-091-03, EC-092-01, EC-092-02]

batch14_phase1_test_results:
  new_tests: 88
  new_tests_passing: 88
  full_suite_tests: 3997
  full_suite_passing: 3995
  full_suite_files: 73
  regressions: 0
  pre_existing_failures: 2
  pre_existing_failure_details: "batch7-f035-f039.test.ts: 2 tests about com.wardmanager.app bundle ID (pre-existing, unrelated to Batch 14)"

  # --- Batch 14, Phase 1: Review fixes ---

  - step: S11-fix
    cr: [CR-145, CR-147, CR-148, CR-149]
    plan_ref: plans/PLAN_P025.yaml
    plan_step: review-fix
    hash: 9421454
    message: "fix(i18n): remove duplicate auth keys, fix es text, update comment (R-B14-1/2/3)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
      - src/app/(tabs)/index.tsx
      - src/__tests__/batch14-phase1.test.ts
      - src/__tests__/batch9-phase2.test.ts
    changes:
      - id: CHG-344
        description: "Removed duplicate auth.confirmPassword and auth.passwordMismatch keys from 3 locale files (P1 blocker R-B14-1)"
      - id: CHG-345
        description: "Fixed es.json changeConfirmMessage: asignados/asignaciones -> designados/designaciones per SPEC (P2 R-B14-2)"
      - id: CHG-346
        description: "Updated index.tsx header comment to reflect always-visible button (P2 R-B14-3)"
      - id: CHG-347
        description: "Updated test assertions in batch14-phase1.test.ts and batch9-phase2.test.ts for designados"

  # --- Batch 14, Phase 2: CR-150 (F093), CR-151 (F094), CR-152 (F095), CR-153 (F096) ---

  - step: S01
    cr: CR-152
    plan_ref: plans/PLAN_P026.yaml
    plan_step: STEP-01
    hash: 3c09a4e
    message: "feat(db): add has_intermediate_hymn column to sunday_agendas (F095, CR-152)"
    files_changed:
      - supabase/migrations/016_add_has_intermediate_hymn.sql
      - src/types/database.ts
    changes:
      - id: CHG-348
        description: "Created migration 016 adding has_intermediate_hymn BOOLEAN NOT NULL DEFAULT true to sunday_agendas"
      - id: CHG-349
        description: "Added has_intermediate_hymn: boolean field to SundayAgenda interface after has_special_presentation"
    acs_covered: [AC-095-01]

  - step: S02
    cr: CR-150
    plan_ref: plans/PLAN_P026.yaml
    plan_step: STEP-02
    hash: 1c940f8
    message: "feat(ui): add speaker names and vertical LEDs to collapsed SundayCard (F093, CR-150)"
    files_changed:
      - src/components/SundayCard.tsx
    changes:
      - id: CHG-350
        description: "Added 3 speaker name lines (11px) in headerCenter when isSpeechesType && !expanded"
      - id: CHG-351
        description: "Changed LEDs layout from horizontal (row) to vertical (column, gap:4) when !expanded"
      - id: CHG-352
        description: "Hidden LEDs when expanded (conditioned on !expanded && isSpeechesType)"
      - id: CHG-353
        description: "Added speakerNameLine style (fontSize: 11) and ledsVertical style"
    acs_covered: [AC-093-01, AC-093-02, AC-093-03, AC-093-04, AC-093-05]
    ecs_covered: [EC-093-01, EC-093-02, EC-093-03]

  - step: S03
    cr: CR-151
    plan_ref: plans/PLAN_P026.yaml
    plan_step: STEP-03
    hash: 860f9c1
    message: "feat(agenda): add pianist and conductor fields in Welcome section (F094, CR-151)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-354
        description: "Added Pianist SelectorField with roleFilter can_music after Announcements"
      - id: CHG-355
        description: "Added Conductor SelectorField with roleFilter can_music after Pianist"
    acs_covered: [AC-094-01, AC-094-02, AC-094-03, AC-094-04, AC-094-05, AC-094-06, AC-094-07, AC-094-09]

  - step: S04
    cr: [CR-151, CR-152]
    plan_ref: plans/PLAN_P026.yaml
    plan_step: STEP-04
    hash: b6acf6f
    message: "feat(presentation): add pianist/conductor fields and conditional intermediate hymn (F094+F095, CR-151+CR-152)"
    files_changed:
      - src/hooks/usePresentationMode.ts
    changes:
      - id: CHG-356
        description: "Added pianist_name and conductor_name fields to Card 1 (Welcome) in buildPresentationCards"
      - id: CHG-357
        description: "Changed intermediate hymn from unconditional to has_intermediate_hymn !== false check"
    acs_covered: [AC-094-08, AC-095-07]

  - step: S05
    cr: CR-152
    plan_ref: plans/PLAN_P026.yaml
    plan_step: STEP-05
    hash: dac0e09
    message: "feat(agenda): add intermediate hymn toggle with DB persistence (F095, CR-152)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-358
        description: "Added ToggleField for has_intermediate_hymn in else branch of has_special_presentation"
      - id: CHG-359
        description: "Wrapped hymn selector in has_intermediate_hymn conditional rendering"
    acs_covered: [AC-095-01, AC-095-02, AC-095-03, AC-095-04, AC-095-05]
    ecs_covered: [EC-095-01, EC-095-02, EC-095-03]

  - step: S06
    cr: CR-153
    plan_ref: plans/PLAN_P026.yaml
    plan_step: STEP-06
    hash: aa55dbb
    message: "feat(hooks): add useAgendaRange hook for agenda range queries (F096, CR-153)"
    files_changed:
      - src/hooks/useAgenda.ts
    changes:
      - id: CHG-360
        description: "Added useAgendaRange hook querying sunday_agendas by date range with enabled guard"
    acs_covered: [AC-096-10]

  - step: S07
    cr: CR-153
    plan_ref: plans/PLAN_P026.yaml
    plan_step: STEP-07
    hash: dad8cd1
    message: "feat(i18n): add agenda status line keys in 3 languages (F096, CR-153)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-361
        description: "Added 8 agenda status keys (statusMissing, statusSpeakers, statusPrayers, statusHymns, statusPresiding, statusConducting, statusPianist, statusConductor) in 3 locales"
    acs_covered: [AC-096-01, AC-096-03, AC-096-05, AC-096-06]

  - step: S08
    cr: CR-153
    plan_ref: plans/PLAN_P026.yaml
    plan_step: STEP-08
    hash: 9c678ba
    message: "feat(ui): add status lines to collapsed agenda cards (F096, CR-153)"
    files_changed:
      - src/app/(tabs)/agenda.tsx
    changes:
      - id: CHG-362
        description: "Imported useAgendaRange and SundayAgenda type"
      - id: CHG-363
        description: "Called useAgendaRange and built agendaMap from results"
      - id: CHG-364
        description: "Passed agenda prop to AgendaSundayCard"
      - id: CHG-365
        description: "Added status line rendering: missing roles, speakers X/3, prayers X/2, hymns X/N with green when complete"
      - id: CHG-366
        description: "Added statusLine style (fontSize: 11) and green color #22c55e constant"
    acs_covered: [AC-096-01, AC-096-02, AC-096-03, AC-096-04, AC-096-05, AC-096-06, AC-096-07, AC-096-08, AC-096-09, AC-096-10, AC-096-11]
    ecs_covered: [EC-096-01, EC-096-02, EC-096-03, EC-096-04]

  - step: S09
    cr: [CR-150, CR-151, CR-152, CR-153]
    plan_ref: plans/PLAN_P026.yaml
    plan_step: STEP-09
    hash: 726d736
    message: "test(batch14): add 133 tests for F093-F096 (CR-150 to CR-153)"
    files_changed:
      - src/__tests__/batch14-phase2.test.ts
    tests_added: 133
    acs_covered: [AC-093-01, AC-093-07, AC-094-01, AC-094-09, AC-095-01, AC-095-07, AC-096-01, AC-096-11]
    ecs_covered: [EC-093-01, EC-093-03, EC-094-01, EC-094-03, EC-095-01, EC-095-03, EC-096-01, EC-096-04]

  - step: S10-fix
    cr: CR-150
    plan_ref: plans/PLAN_P026.yaml
    plan_step: test-fix
    hash: f605c32
    message: "fix(tests): update batch8 LED conditional tests for F093 SundayCard changes"
    files_changed:
      - src/__tests__/batch8-phase1.test.ts
    changes:
      - id: CHG-367
        description: "Updated 2 batch8-phase1 AC-F045-01 tests for F093 LED conditional pattern change (ledsVertical with !expanded guard)"

batch14_phase2_test_results:
  new_tests: 133
  new_tests_passing: 133
  full_suite_tests: 4130
  full_suite_passing: 4128
  full_suite_files: 74
  regressions: 0
  pre_existing_failures: 2
  pre_existing_failure_details: "batch7-f035-f039.test.ts: 2 tests about com.wardmanager.app bundle ID (pre-existing, unrelated to Batch 14)"

  # =============================================================================
  # Batch 15 Phase 1: F097-F100 (CR-156 to CR-163)
  # =============================================================================

  - step: S01
    cr: CR-163
    plan_ref: plans/PLAN_P027.yaml
    plan_step: S01
    hash: f694e87
    message: "fix(i18n): update selectSpeaker placeholder to Discursante in 3 locales (F098, CR-163)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-368
        description: "pt-BR speeches.selectSpeaker changed from 'Selecionar orador' to 'Selecionar Discursante'"
      - id: CHG-369
        description: "en speeches.selectSpeaker changed from 'Select speaker' to 'Select Speaker'"
      - id: CHG-370
        description: "es speeches.selectSpeaker changed from 'Seleccionar orador' to 'Seleccionar Discursante'"
    acs_covered: [AC-098-05, AC-098-06, AC-098-07]
    ecs_covered: [EC-098-01]

  - step: S02
    cr: CR-160
    plan_ref: plans/PLAN_P027.yaml
    plan_step: S02
    hash: 4169eea
    message: "feat(ui): unify speech position labels - remove position 3 special case (F098, CR-160)"
    files_changed:
      - src/components/SpeechSlot.tsx
      - src/components/SundayCard.tsx
    changes:
      - id: CHG-371
        description: "SpeechSlot.tsx getPositionLabel: removed if(position===3) branch, all positions use t('speeches.slot')"
      - id: CHG-372
        description: "SundayCard.tsx collapsed label: removed pos===3 ternary, all positions use t('speeches.slot')"
    acs_covered: [AC-098-01, AC-098-02, AC-098-03, AC-098-04, AC-098-08]
    ecs_covered: [EC-098-02]

  - step: S03
    cr: CR-161
    plan_ref: plans/PLAN_P027.yaml
    plan_step: S03
    hash: c49a8c7
    message: "feat(ui): redesign collapsed speech card with inline LEDs and increased font (F099, CR-161)"
    files_changed:
      - src/components/SundayCard.tsx
    changes:
      - id: CHG-373
        description: "Replaced headerCenter text lines + ledsVertical column with unified speechRow rows (LED inline before text)"
      - id: CHG-374
        description: "StatusLED size reduced from 14 to 10 in collapsed card"
      - id: CHG-375
        description: "speakerNameLine fontSize increased from 11 to 13"
      - id: CHG-376
        description: "Added speechRow style with flexDirection row, gap 8, marginBottom 4"
      - id: CHG-377
        description: "Empty speaker_name shows only StatusLED circle (conditional text rendering)"
      - id: CHG-378
        description: "Removed ledsVertical container from collapsed speeches"
    acs_covered: [AC-099-01, AC-099-02, AC-099-03, AC-099-04, AC-099-05, AC-099-06, AC-099-07, AC-099-08, AC-099-09, AC-099-10]
    ecs_covered: [EC-099-01, EC-099-02, EC-099-03]

  - step: S04
    cr: CR-162
    plan_ref: plans/PLAN_P027.yaml
    plan_step: S04
    hash: b1af845
    message: "feat(ui): move StatusLED to label row with status text in SpeechSlot (F100, CR-162)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-379
        description: "Label row redesigned: label text left + Pressable status section right (statusText + StatusLED size 14)"
      - id: CHG-380
        description: "Removed StatusLED from speaker row - speaker field now takes full width"
      - id: CHG-381
        description: "Removed marginLeft 28 from topicRow style - topic field aligned with speaker"
      - id: CHG-382
        description: "Added labelRow style (flexDirection row, justifyContent space-between, marginBottom 6)"
      - id: CHG-383
        description: "Added statusSection style (flexDirection row, gap 6) and statusText style (fontSize 11)"
      - id: CHG-384
        description: "Moved marginBottom 6 from label style to labelRow container"
      - id: CHG-385
        description: "Status text uses t(speechStatus.status) i18n keys for human-readable labels"
    acs_covered: [AC-100-01, AC-100-02, AC-100-03, AC-100-04, AC-100-05, AC-100-06, AC-100-07, AC-100-08, AC-100-09, AC-100-10, AC-100-11]
    ecs_covered: [EC-100-01, EC-100-02, EC-100-03]

  - step: S05
    cr: [CR-156, CR-157, CR-158, CR-159]
    plan_ref: plans/PLAN_P027.yaml
    plan_step: S05
    hash: acb9ebe
    message: "feat(presentation): directional arrows, multiline names, font toggle, section titles (F097, CR-156/157/158/159)"
    files_changed:
      - src/components/AccordionCard.tsx
      - src/hooks/usePresentationMode.ts
      - src/app/presentation.tsx
    changes:
      - id: CHG-386
        description: "AccordionCard chevron logic: cards above expanded show down-arrow, below show up-arrow, expanded hides chevron"
      - id: CHG-387
        description: "AccordionCard accepts cardTitleFontSize prop, applies to card title with fallback to 16"
      - id: CHG-388
        description: "usePresentationMode recognized_names join changed from ', ' to newline with type multiline"
      - id: CHG-389
        description: "usePresentationMode card titles changed: sectionWelcome, sectionSacrament, sectionFirstSpeeches, sectionLastSpeech"
      - id: CHG-390
        description: "usePresentationMode special meeting card 3 title kept as closingHymn (unchanged)"
      - id: CHG-391
        description: "presentation.tsx added FONT_SIZES constant with normal and large modes"
      - id: CHG-392
        description: "presentation.tsx added fontSizeMode useState toggle with Aa/AA button next to close button"
      - id: CHG-393
        description: "PresentationFieldRow accepts fontSizes prop for dynamic label and value sizing"
      - id: CHG-394
        description: "AccordionCard receives cardTitleFontSize from fontSizes.cardTitle"
      - id: CHG-395
        description: "Header title fontSize made dynamic via fontSizes.headerTitle"
    acs_covered: [AC-097-01, AC-097-02, AC-097-03, AC-097-04, AC-097-05, AC-097-06, AC-097-07, AC-097-08, AC-097-09, AC-097-10, AC-097-11, AC-097-12, AC-097-13, AC-097-14]
    ecs_covered: [EC-097-01, EC-097-02, EC-097-03, EC-097-04]

  # =============================================================================
  # Batch 15 Phase 2: F101-F102 (CR-155, CR-164)
  # =============================================================================

  - step: S01
    cr: CR-155
    plan_ref: plans/PLAN_P028.yaml
    plan_step: S01
    hash: 73d73ab
    message: "feat(edge-function): create send-reset-email with multilingual templates via Resend API (F101, CR-155)"
    files_changed:
      - supabase/functions/send-reset-email/index.ts
    changes:
      - id: CHG-396
        description: "Created Edge Function send-reset-email with CORS, email validation, user lookup via admin.listUsers, ward language lookup, generateLink recovery token, multilingual email templates (pt-BR/en/es), and Resend API integration"
    acs_covered: [AC-101-01, AC-101-02, AC-101-03, AC-101-04, AC-101-05, AC-101-09, AC-101-10, AC-101-11]
    ecs_covered: [EC-101-01, EC-101-02, EC-101-03, EC-101-04]

  - step: S02
    cr: CR-155
    plan_ref: plans/PLAN_P028.yaml
    plan_step: S02
    hash: 7a369cc
    message: "feat(auth): replace resetPasswordForEmail with Edge Function invoke (F101, CR-155)"
    files_changed:
      - src/app/(auth)/forgot-password.tsx
    changes:
      - id: CHG-397
        description: "Removed expo-linking import and Linking.createURL/resetPasswordForEmail call"
      - id: CHG-398
        description: "Added supabase.functions.invoke('send-reset-email', { body: { email: trimmedEmail } })"
    acs_covered: [AC-101-06]
    ecs_covered: [EC-101-06]

  - step: S03
    cr: CR-155
    plan_ref: plans/PLAN_P028.yaml
    plan_step: S03
    hash: 6d6bb1a
    message: "feat(auth): add deep link token handling with verifyOtp in reset-password (F101, CR-155)"
    files_changed:
      - src/app/(auth)/reset-password.tsx
    changes:
      - id: CHG-399
        description: "Imported useLocalSearchParams from expo-router and extracted token/type from URL params"
      - id: CHG-400
        description: "Added dual-path useEffect: verifyOtp with token_hash when token present, PASSWORD_RECOVERY fallback when no token"
    acs_covered: [AC-101-07, AC-101-08, AC-101-12]
    ecs_covered: [EC-101-05]

  - step: S04
    cr: CR-164
    plan_ref: plans/PLAN_P028.yaml
    plan_step: S04
    hash: 8c78046
    message: "test(batch15): fix bundleIdentifier tests and update auth tests for Edge Function flow (F102, CR-164)"
    files_changed:
      - src/__tests__/batch7-f035-f039.test.ts
      - src/__tests__/batch14-phase1.test.ts
      - src/__tests__/batch15-phase2.test.ts
    tests_added: 52
    changes:
      - id: CHG-401
        description: "Fixed 4 bundleIdentifier values from com.wardmanager.app to com.sacramentmeetingmanager.app in batch7"
      - id: CHG-402
        description: "Updated batch14-phase1 AC-088-02 tests for Edge Function invoke and EC-088-01 for no Linking import"
      - id: CHG-403
        description: "Added 3 tests to EC-088-03 for useLocalSearchParams, verifyOtp, and token extraction"
      - id: CHG-404
        description: "Created batch15-phase2.test.ts with 52 tests covering F101 Edge Function, client-side changes, and F102 bundleIdentifier fix"
    acs_covered: [AC-102-01, AC-102-02, AC-102-03, AC-102-04]
    ecs_covered: [EC-102-01]

  - step: S04-fix
    cr: CR-164
    plan_ref: plans/PLAN_P028.yaml
    plan_step: S04
    hash: 565e1db
    message: "fix(tests): update cr004-f007 forgot-password test for Edge Function flow (F102, CR-164)"
    files_changed:
      - src/__tests__/cr004-f007-auth-fixes.test.ts
    changes:
      - id: CHG-405
        description: "Updated cr004-f007 forgot-password test from resetPasswordForEmail to functions.invoke('send-reset-email')"
    acs_covered: [AC-102-03]

batch15_phase2_test_results:
  new_tests: 52
  new_tests_passing: 52
  full_suite_tests: 4401
  full_suite_passing: 4401
  full_suite_files: 76
  regressions: 0
  pre_existing_failures_fixed: 2
  pre_existing_failure_fix_details: "batch7-f035-f039.test.ts: 2 tests fixed com.wardmanager.app -> com.sacramentmeetingmanager.app"

  # =============================================================================
  # Batch 16: F103-F109 (CR-165 to CR-171)
  # =============================================================================

  - step: S01
    cr: CR-165
    plan_ref: plans/PLAN_P029.yaml
    plan_step: S01
    hash: b1f2a26
    message: "fix(ui): add paddingRight to statusSection for LED/X vertical alignment (F103, CR-165)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-406
        description: "Added paddingRight: 5 to statusSection style in SpeechSlot (ADR-074)"
    acs_covered: [AC-103-01, AC-103-02, AC-103-03, AC-103-04]
    ecs_covered: [EC-103-01]

  - step: S02
    cr: CR-166
    plan_ref: plans/PLAN_P029.yaml
    plan_step: S02
    hash: 6a0f8a6
    message: "feat(presentation): rename title to Reunião Sacramental and lock fontSize (F104, CR-166)"
    files_changed:
      - src/app/presentation.tsx
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-407
        description: "Changed presentation.tsx header title from t('home.startMeeting') to t('presentation.title') with fixed fontSize: 19"
      - id: CHG-408
        description: "Added presentation.title key in pt-BR ('Reunião Sacramental'), en ('Sacrament Meeting'), es ('Reunión Sacramental')"
    acs_covered: [AC-104-01, AC-104-02, AC-104-03, AC-104-04, AC-104-05, AC-104-06]
    ecs_covered: [EC-104-01, EC-104-02]

  - step: S03
    cr: CR-167
    plan_ref: plans/PLAN_P029.yaml
    plan_step: S03
    hash: 5651e6d
    message: "fix(i18n): correct Portuguese accents and cedilla in section headers (F105, CR-167)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-409
        description: "pt-BR sectionWelcome: 'Boas-Vindas, Anúncios e Reconhecimentos' (uppercase V, accent on u)"
      - id: CHG-410
        description: "pt-BR sectionSacrament: 'Designações e Sacramento' (cedilla and tilde)"
      - id: CHG-411
        description: "pt-BR sectionLastSpeech: 'Último Discurso' (accent on U)"
      - id: CHG-412
        description: "es sectionLastSpeech: 'Último Discurso' (accent on U)"
    acs_covered: [AC-105-01, AC-105-02, AC-105-03, AC-105-04, AC-105-05, AC-105-06, AC-105-07, AC-105-08]
    ecs_covered: [EC-105-01]

  - step: S04
    cr: CR-168
    plan_ref: plans/PLAN_P029.yaml
    plan_step: S04
    hash: 172acac
    message: "feat(ux): add hitSlop={12} to back button in 8 Settings sub-screens (F106, CR-168)"
    files_changed:
      - src/app/(tabs)/settings/members.tsx
      - src/app/(tabs)/settings/topics.tsx
      - src/app/(tabs)/settings/users.tsx
      - src/app/(tabs)/settings/history.tsx
      - src/app/(tabs)/settings/whatsapp.tsx
      - src/app/(tabs)/settings/about.tsx
      - src/app/(tabs)/settings/timezone.tsx
      - src/app/(tabs)/settings/theme.tsx
    changes:
      - id: CHG-413
        description: "Added hitSlop={12} to Pressable back button in all 8 Settings sub-screens (ADR-075)"
    acs_covered: [AC-106-01, AC-106-02, AC-106-03, AC-106-04]
    ecs_covered: [EC-106-01]

  - step: S05
    cr: CR-169
    plan_ref: plans/PLAN_P029.yaml
    plan_step: S05
    hash: 3085c3b
    message: "fix(ui): render placeholder Text for consistent collapsed card row heights (F107, CR-169)"
    files_changed:
      - src/components/SundayCard.tsx
    changes:
      - id: CHG-414
        description: "Changed null rendering to Text(' ') placeholder when no speaker name in collapsed SundayCard"
    acs_covered: [AC-107-01, AC-107-02, AC-107-03, AC-107-04, AC-107-05]
    ecs_covered: [EC-107-01, EC-107-02, EC-107-03]

  - step: S06
    cr: CR-170
    plan_ref: plans/PLAN_P029.yaml
    plan_step: S06
    hash: 93968d1
    message: "fix(presentation): remove redundant suffix from last speech label (F108, CR-170)"
    files_changed:
      - src/hooks/usePresentationMode.ts
    changes:
      - id: CHG-415
        description: "Changed last speaker label from template literal with speeches.speaker suffix to t('speeches.lastSpeech') only"
    acs_covered: [AC-108-01, AC-108-02, AC-108-03, AC-108-04]
    ecs_covered: [EC-108-01]

  - step: S07
    cr: CR-171
    plan_ref: plans/PLAN_P029.yaml
    plan_step: S07
    hash: 5473bd1
    message: "feat(agenda): add status lines for testimony/primary collapsed cards (F109, CR-171)"
    files_changed:
      - src/app/(tabs)/agenda.tsx
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-416
        description: "Added SPECIAL_MEETING_WITH_STATUS array and isSpecialWithStatus flag for testimony_meeting and primary_presentation"
      - id: CHG-417
        description: "Added collapsed status rendering for special meetings: Falta roles, exception type in yellow, prayers Y/2, hymns Z/3"
      - id: CHG-418
        description: "Refactored exceptionLabel condition to exclude isSpecialWithStatus from simple yellow-text-only path"
      - id: CHG-419
        description: "Added agenda.statusPrayersLabel key in pt-BR ('Orações'), en ('Prayers'), es ('Oraciones')"
    acs_covered: [AC-109-01, AC-109-02, AC-109-03, AC-109-04, AC-109-05, AC-109-06, AC-109-07, AC-109-08, AC-109-09, AC-109-10, AC-109-11]
    ecs_covered: [EC-109-01, EC-109-02, EC-109-03, EC-109-04]

  # --- Batch 17: CR-172, CR-173, CR-174 ---

  - step: S01
    cr: CR-172
    plan_ref: plans/PLAN_P030.yaml
    plan_step: S01
    hash: e27cf92
    message: "feat(presentation): show stake announcements field when toggle is on (F110, CR-172)"
    files_changed:
      - src/hooks/usePresentationMode.ts
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-420
        description: "Added conditional block: if (agenda?.has_stake_announcements) push field with label t('agenda.stakeAnnouncements') and value t('presentation.stakeAnnouncementsText') after baptism_confirmation and before sacrament hymn"
      - id: CHG-421
        description: "Added presentation.stakeAnnouncementsText i18n key in pt-BR ('Passar palavra à Estaca'), en ('Turn the time over to the Stake'), es ('Ceder la palabra a la Estaca')"
    acs_covered: [AC-110-01, AC-110-02, AC-110-03, AC-110-04, AC-110-05]
    ecs_covered: [EC-110-01, EC-110-02]

  - step: S02
    cr: CR-173
    plan_ref: plans/PLAN_P030.yaml
    plan_step: S02
    hash: 0be6534
    message: "fix(agenda): remove redundant suffix from last speech label in AgendaForm (F111, CR-173)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-422
        description: "Changed last speaker label from template literal '${t('speeches.lastSpeech')} - ${t('speeches.speaker')}' to t('speeches.lastSpeech') only"
    acs_covered: [AC-111-01, AC-111-02, AC-111-03, AC-111-04]
    ecs_covered: [EC-111-01]

  - step: S03
    cr: CR-174
    plan_ref: plans/PLAN_P030.yaml
    plan_step: S03
    hash: cafb271
    message: "fix(ui): restructure SpeechSlot to fixed-width right column for center alignment (F112, CR-174)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-423
        description: "Restructured layout to outerRow with leftColumn (flex:1) + rightColumn (width:36) for center-to-center alignment"
      - id: CHG-424
        description: "Moved StatusLED from statusSection in labelRow to rightColumn wrapped in statusLedWrapper Pressable"
      - id: CHG-425
        description: "Moved status text from statusSection to labelRow in its own Pressable with handleStatusPress"
      - id: CHG-426
        description: "Moved speaker X remove button from row to rightColumn speakerActionWrapper (height:38)"
      - id: CHG-427
        description: "Moved topic X clear button from topicRow to rightColumn topicActionWrapper (height:34, marginTop:6)"
      - id: CHG-428
        description: "Removed statusSection style (paddingRight:5, gap:6 -- ADR-074 superseded by ADR-076)"
      - id: CHG-429
        description: "Removed gap:12 from row and topicRow styles (X buttons moved to right column)"
    acs_covered: [AC-112-01, AC-112-02, AC-112-03, AC-112-04, AC-112-05, AC-112-06]
    ecs_covered: [EC-112-01, EC-112-02, EC-112-03, EC-112-04]

  # --- CR-175 commits (Batch 18, F113) ---

  - step: S01
    cr: CR-175
    plan_ref: plans/PLAN_P031.yaml
    plan_step: S01
    hash: b5379ef
    message: "fix(deeplink): change scheme from sacrmeetman to sacrmeetplan in app.json and create-invitation (F113, CR-175)"
    files_changed:
      - app.json
      - supabase/functions/create-invitation/index.ts
    changes:
      - id: CHG-430
        description: "Changed app.json expo.scheme from 'sacrmeetman' to 'sacrmeetplan'"
      - id: CHG-431
        description: "Changed create-invitation deepLink from sacrmeetman://invite/ to sacrmeetplan://invite/"
    acs_covered: [AC-113-01, AC-113-02, AC-113-05, AC-113-06]
    ecs_covered: [EC-113-01]

  # --- CR-176 commits (Batch 18, F114) ---

  - step: S02
    cr: CR-176
    plan_ref: plans/PLAN_P031.yaml
    plan_step: S02
    hash: cb5628a
    message: "feat(edge): create reset-redirect Edge Function and update send-reset-email to use HTTPS redirect (F114, CR-176)"
    files_changed:
      - supabase/functions/reset-redirect/index.ts
      - supabase/functions/send-reset-email/index.ts
    changes:
      - id: CHG-432
        description: "Created new reset-redirect Edge Function with CORS, GET handler, param validation, HTML response with meta refresh + JS redirect + fallback button"
      - id: CHG-433
        description: "Changed send-reset-email deepLink from sacrmeetman://reset-password to HTTPS redirect URL (https://poizgglzdjqwrhsnhkke.supabase.co/functions/v1/reset-redirect)"
    acs_covered: [AC-113-03, AC-113-04, AC-114-01, AC-114-02, AC-114-03, AC-114-04, AC-114-05, AC-114-06, AC-114-08]
    ecs_covered: [EC-113-02, EC-114-01, EC-114-02, EC-114-03, EC-114-04]

  # --- CR-177 commits (Batch 18, F115) ---

  - step: S03
    cr: CR-177
    plan_ref: plans/PLAN_P031.yaml
    plan_step: S03
    hash: c668d84
    message: "fix(ui): move StatusLED to labelRow for right-edge alignment with speaker field (F115, CR-177)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-434
        description: "Moved StatusLED from rightColumn statusLedWrapper Pressable into labelRow statusSection Pressable (leftColumn)"
      - id: CHG-435
        description: "Added statusSection style with flexDirection:'row', alignItems:'center', gap:6"
      - id: CHG-436
        description: "Replaced statusLedWrapper Pressable in rightColumn with empty statusLedPlaceholder View"
    acs_covered: [AC-115-01, AC-115-02, AC-115-03, AC-115-04, AC-115-05, AC-115-06, AC-115-07, AC-115-08]
    ecs_covered: [EC-115-01, EC-115-02, EC-115-03, EC-115-04, EC-115-05]

  # --- Batch 18 test commits ---

  - step: S04
    cr: CR-175
    plan_ref: plans/PLAN_P031.yaml
    plan_step: S04
    hash: 9b48e24
    message: "test(batch18): update existing tests from sacrmeetman to sacrmeetplan scheme (F113, CR-175)"
    files_changed:
      - src/__tests__/batch7-f035-f039.test.ts
      - src/__tests__/batch15-phase2.test.ts
    changes:
      - id: CHG-437
        description: "Updated batch7 F037 tests: all sacrmeetman assertions changed to sacrmeetplan"
      - id: CHG-438
        description: "Updated batch15 AC-101-05 test: deepLink assertion changed from sacrmeetman:// to HTTPS redirect URL"
      - id: CHG-439
        description: "Updated batch15 EC-101-05 comment: sacrmeetman:// -> sacrmeetplan://"
    acs_covered: [AC-113-04]
    ecs_covered: []

  - step: S05
    cr: [CR-175, CR-176, CR-177]
    plan_ref: plans/PLAN_P031.yaml
    plan_step: S05
    hash: 8fcc173
    message: "test(batch18): add tests for F113-F115 and update existing tests for F115 layout change (CR-175 to CR-177)"
    files_changed:
      - src/__tests__/batch18.test.ts
      - src/__tests__/batch17.test.ts
    changes:
      - id: CHG-440
        description: "Created batch18.test.ts with 83 tests covering F113 (scheme change), F114 (reset-redirect EF), F115 (StatusLED alignment)"
      - id: CHG-441
        description: "Updated batch17 F112 tests for F115 layout change: StatusLED now in leftColumn, statusSection restored, statusLedWrapper renamed to statusLedPlaceholder"
    acs_covered: [AC-113-01, AC-113-02, AC-113-03, AC-113-04, AC-113-05, AC-113-06, AC-114-01, AC-114-02, AC-114-03, AC-114-04, AC-114-05, AC-114-06, AC-114-07, AC-114-08, AC-115-01, AC-115-02, AC-115-03, AC-115-04, AC-115-05, AC-115-06, AC-115-07, AC-115-08]
    ecs_covered: [EC-113-01, EC-113-02, EC-113-03, EC-114-01, EC-114-02, EC-114-03, EC-114-04, EC-115-01, EC-115-02, EC-115-03, EC-115-04, EC-115-05]

  - step: S05b
    cr: CR-177
    plan_ref: plans/PLAN_P031.yaml
    plan_step: S05
    hash: d266438
    message: "test(batch18): update batch15-phase1 tests for F115 StatusLED layout change (CR-177)"
    files_changed:
      - src/__tests__/batch15-phase1.test.ts
    changes:
      - id: CHG-442
        description: "Updated batch15-phase1 F103 tests for F115 layout change: StatusLED now in statusSection (leftColumn), statusLedWrapper renamed to statusLedPlaceholder"
    acs_covered: [AC-115-01]
    ecs_covered: []

  # =============================================================================
  # Batch 19 - Phase 1 (CR-178, CR-180, CR-181, CR-191 / F116-F119)
  # =============================================================================

  - step: S01
    cr: CR-180
    plan_ref: plans/PLAN_P032.yaml
    plan_step: S01
    hash: 59023f2
    message: "feat(db): migration 017 to split can_music into can_pianist and can_conductor with CHECK constraint (F117, CR-180)"
    files_changed:
      - supabase/migrations/017_split_music_actor.sql
    changes:
      - id: CHG-443
        description: "Added can_pianist and can_conductor boolean columns to meeting_actors"
      - id: CHG-444
        description: "Migrated existing can_music=true data to can_pianist=true"
      - id: CHG-445
        description: "Dropped old can_music column"
      - id: CHG-446
        description: "Added chk_pianist_conductor_exclusive CHECK constraint for mutual exclusivity"
    acs_covered: [AC-117-01, AC-117-02]
    ecs_covered: []

  - step: S02
    cr: CR-181
    plan_ref: plans/PLAN_P032.yaml
    plan_step: S02
    hash: 07e499f
    message: "feat(db): migration 018 to add has_second_speech column to sunday_agendas (F118, CR-181)"
    files_changed:
      - supabase/migrations/018_add_has_second_speech.sql
    changes:
      - id: CHG-447
        description: "Added has_second_speech boolean column to sunday_agendas with DEFAULT true"
    acs_covered: [AC-118-01]
    ecs_covered: []

  - step: S03
    cr: [CR-180, CR-181]
    plan_ref: plans/PLAN_P032.yaml
    plan_step: S03
    hash: 1ee6c93
    message: "feat(types): update MeetingActor, CreateActorInput, UpdateActorInput for pianist/conductor split and SundayAgenda for has_second_speech (F117+F118, CR-180+CR-181)"
    files_changed:
      - src/types/database.ts
    changes:
      - id: CHG-448
        description: "Replaced can_music with can_pianist and can_conductor in MeetingActor"
      - id: CHG-449
        description: "Replaced can_music with can_pianist and can_conductor in CreateActorInput and UpdateActorInput"
      - id: CHG-450
        description: "Added has_second_speech: boolean to SundayAgenda"
    acs_covered: [AC-117-03, AC-117-04, AC-118-01]
    ecs_covered: []

  - step: S04
    cr: CR-178
    plan_ref: plans/PLAN_P032.yaml
    plan_step: S04
    hash: b3602d9
    message: "feat(auth): separate app/ward language control, Observer limited Settings, fix collection reactivation (F116, CR-178)"
    files_changed:
      - src/contexts/AuthContext.tsx
      - src/app/(tabs)/settings/index.tsx
      - src/app/(tabs)/_layout.tsx
    changes:
      - id: CHG-451
        description: "AuthContext: added wardLanguage state, updateAppLanguage function, language priority user_metadata > device locale > ward language"
      - id: CHG-452
        description: "Settings: split language picker into App Language (all roles) and Ward Language (Bispado/Secretario only)"
      - id: CHG-453
        description: "Settings: Observer role sees limited Settings (Language, Theme, About, Sign Out)"
      - id: CHG-454
        description: "Settings: Ward language change deactivates old language collections and activates new language collections"
      - id: CHG-455
        description: "_layout.tsx: Removed href=null for Observer on Settings tab"
    acs_covered: [AC-116-01, AC-116-02, AC-116-03, AC-116-04, AC-116-05, AC-116-06, AC-116-07, AC-116-08]
    ecs_covered: [EC-116-01, EC-116-02, EC-116-03]

  - step: S05
    cr: CR-180
    plan_ref: plans/PLAN_P032.yaml
    plan_step: S05
    hash: ae974a5
    message: "feat(actors): update useActors, ActorSelector, AgendaForm for can_pianist/can_conductor split (F117, CR-180)"
    files_changed:
      - src/hooks/useActors.ts
      - src/components/ActorSelector.tsx
      - src/components/AgendaForm.tsx
      - src/lib/activityLog.ts
    changes:
      - id: CHG-456
        description: "useActors: ActorRoleFilter type now includes can_pianist and can_conductor instead of can_music"
      - id: CHG-457
        description: "useActors: getPrimaryRole updated for pianist/conductor priority"
      - id: CHG-458
        description: "ActorSelector: CreateActorInput uses can_pianist/can_conductor based on roleFilter"
      - id: CHG-459
        description: "AgendaForm: pianist field uses can_pianist filter, conductor field uses can_conductor filter"
      - id: CHG-460
        description: "activityLog: ACTOR_ROLE_I18N_KEYS updated with pianist and conductor keys"
    acs_covered: [AC-117-05, AC-117-06, AC-117-07, AC-117-08, AC-117-09]
    ecs_covered: []

  - step: S06
    cr: CR-178
    plan_ref: plans/PLAN_P032.yaml
    plan_step: S06
    hash: edee1fc
    message: "feat(i18n): translate WhatsApp placeholders per app language, use ward language for topics/collections (F116, CR-178)"
    files_changed:
      - src/app/(tabs)/settings/whatsapp.tsx
      - src/app/(tabs)/settings/topics.tsx
      - src/hooks/useTopics.ts
    changes:
      - id: CHG-461
        description: "WhatsApp: placeholder labels displayed via i18n keys (app language), template default from ward language"
      - id: CHG-462
        description: "Topics: collections filtered by wardLanguage from AuthContext instead of getCurrentLanguage()"
      - id: CHG-463
        description: "useTopics: wardTopics label uses t('topics.wardTopics') instead of hardcoded 'Temas da Ala'"
    acs_covered: [AC-116-08, AC-116-09, AC-116-10]
    ecs_covered: []

  - step: S07
    cr: CR-181
    plan_ref: plans/PLAN_P032.yaml
    plan_step: S07
    hash: 02f6dcc
    message: "feat(speeches): add 2nd speech toggle (position 2), update collapsed card, filter invite items, presentation mode (F118, CR-181)"
    files_changed:
      - src/components/SpeechSlot.tsx
      - src/components/SundayCard.tsx
      - src/hooks/usePresentationMode.ts
      - src/app/(tabs)/speeches.tsx
      - src/components/InviteManagementSection.tsx
      - src/components/NextSundaysSection.tsx
      - src/hooks/useAgenda.ts
    changes:
      - id: CHG-464
        description: "SpeechSlot: added Switch toggle for position 2 with isSecondSpeechEnabled/onToggleSecondSpeech props"
      - id: CHG-465
        description: "SpeechSlot: position 3 uses t('speeches.lastSpeech') label"
      - id: CHG-466
        description: "SpeechSlot: disabled state for position 2 when has_second_speech=false"
      - id: CHG-467
        description: "SundayCard: collapsed view filters positions based on hasSecondSpeech, removed ordinal labels"
      - id: CHG-468
        description: "usePresentationMode: filters speech 2 from 'Primeiros Discursos' card when has_second_speech=false"
      - id: CHG-469
        description: "speeches.tsx: passes hasSecondSpeech to SundayCard, handles toggle with confirmation dialog"
      - id: CHG-470
        description: "InviteManagementSection: filters position 2 invite items when has_second_speech=false"
      - id: CHG-471
        description: "NextSundaysSection: passes hasSecondSpeech and toggle handler to SundayCard/SpeechSlot"
      - id: CHG-472
        description: "useAgenda: added useUpdateAgendaByDate hook for upserting agenda by date"
    acs_covered: [AC-118-02, AC-118-03, AC-118-04, AC-118-05, AC-118-06, AC-118-07, AC-118-08, AC-118-09, AC-118-10, AC-118-11, AC-118-12, AC-118-13, AC-118-14]
    ecs_covered: [EC-118-01, EC-118-02, EC-118-03, EC-118-04]

  - step: S08
    cr: [CR-178, CR-180, CR-181]
    plan_ref: plans/PLAN_P032.yaml
    plan_step: S08
    hash: 1c05840
    message: "feat(i18n): add keys for app/ward language, WhatsApp placeholders, speech toggle, pianist/conductor roles (F116+F117+F118, CR-178+CR-180+CR-181)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-473
        description: "Added settings.appLanguage, settings.wardLanguage, settings.whatsapp.* keys to all 3 locales"
      - id: CHG-474
        description: "Added whatsapp.placeholder* keys to all 3 locales"
      - id: CHG-475
        description: "Added speeches.secondSpeechToggleConfirm*, speeches.secondSpeechDisabledPlaceholder to all 3 locales"
      - id: CHG-476
        description: "Updated actorRoles: replaced music with pianist and conductor in all 3 locales"
    acs_covered: [AC-116-02, AC-116-03, AC-116-05, AC-116-08, AC-116-09, AC-118-03, AC-118-08, AC-118-09, AC-118-12]
    ecs_covered: []

  - step: S09
    cr: CR-191
    plan_ref: plans/PLAN_P032.yaml
    plan_step: S09
    hash: b7329ca
    message: "fix(edge): add charset=utf-8 and Cache-Control to reset-redirect response headers (F119, CR-191)"
    files_changed:
      - supabase/functions/reset-redirect/index.ts
    changes:
      - id: CHG-477
        description: "Added charset=utf-8 to Content-Type header to fix plain-text HTML rendering"
      - id: CHG-478
        description: "Added Cache-Control: no-cache, no-store, must-revalidate header"
      - id: CHG-479
        description: "Added console.log for successful redirect debugging"
      - id: CHG-480
        description: "Documented root cause investigation in code comments"
    acs_covered: [AC-119-01, AC-119-02, AC-119-03, AC-119-04, AC-119-05]
    ecs_covered: [EC-119-01, EC-119-02]

  # --- Review fixes (P0/P1) ---

  - step: S11-fix
    cr: CR-180
    plan_ref: plans/PLAN_P032.yaml
    plan_step: review-fix
    hash: ed821b6
    message: "fix(edge): replace can_music with can_pianist/can_conductor in edge functions (F117, CR-180)"
    files_changed:
      - supabase/functions/create-invitation/index.ts
      - supabase/functions/update-user-role/index.ts
      - supabase/functions/register-first-user/index.ts
    changes:
      - id: CHG-481
        description: "Replaced can_music: false with can_pianist: false, can_conductor: false in create-invitation auto-actor insert"
      - id: CHG-482
        description: "Replaced can_music: false with can_pianist: false, can_conductor: false in update-user-role auto-actor insert"
      - id: CHG-483
        description: "Replaced can_music: false with can_pianist: false, can_conductor: false in register-first-user auto-actor insert"
    acs_covered: [AC-117-01]
    ecs_covered: [EC-117-01]
    review_issues: [R19P1-1, R19P1-2, R19P1-3]

  - step: S12-fix
    cr: CR-181
    plan_ref: plans/PLAN_P032.yaml
    plan_step: review-fix
    hash: 8d7b9f5
    message: "fix(speeches): restrict 2nd speech toggle to Bispado role only (F118, CR-181)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-484
        description: "Changed Switch disabled prop from isObserver to !isBispado per EC-118-04"
    acs_covered: [AC-118-04]
    ecs_covered: [EC-118-04]
    review_issues: [R19P1-4]

  - step: S13-fix
    cr: CR-180
    plan_ref: plans/PLAN_P032.yaml
    plan_step: qa-fix
    hash: 4149fb1
    message: "test(batch19): fix stale can_music refs and add has_second_speech to test mocks (F117+F118, CR-180+CR-181)"
    files_changed:
      - src/__tests__/cr004-f008-agenda-actors.test.ts
      - src/__tests__/database-types.test.ts
      - src/__tests__/phase02-database-types.test.ts
      - src/__tests__/phase02-cross-validation.test.ts
      - src/__tests__/useActors-utils.test.ts
      - src/__tests__/usePresentationMode-utils.test.ts
      - src/__tests__/cr001-qa.test.ts
      - src/__tests__/cr001-qa-extended.test.ts
      - src/__tests__/phase04-agenda-presentation.test.ts
      - src/__tests__/integration/setup-integration.ts
    changes:
      - id: CHG-485
        description: "Updated cr004 test to expect can_pianist/can_conductor instead of can_music in edge function source"
      - id: CHG-486
        description: "Replaced can_music with can_pianist/can_conductor in all MeetingActor mock factories across 6 test files"
      - id: CHG-487
        description: "Updated CreateActorInput mocks to use can_pianist/can_conductor in phase02-database-types"
      - id: CHG-488
        description: "Updated filterActorsByRole test data to use can_pianist instead of can_music in 2 test files"
      - id: CHG-489
        description: "Added has_second_speech: true to all SundayAgenda mock factories across 7 test files"
    acs_covered: []
    ecs_covered: []
    qa_issues: [QA-021-I01, QA-021-I02]

  # --- Batch 19 Phase 2: Card UI/UX (F120-F125) ---

  - step: S14
    cr: [CR-183, CR-187]
    plan_ref: plans/PLAN_P033.yaml
    plan_step: S01
    hash: 1f47d56
    message: "feat(i18n): rename 'Proximas Designacoes' to 'Proximos Discursos' and 'Agenda' to 'Agendas' in all languages (F122+F123, CR-183+CR-187)"
    files_changed:
      - src/i18n/locales/pt-BR.json
      - src/i18n/locales/en.json
      - src/i18n/locales/es.json
    changes:
      - id: CHG-490
        description: "Changed home.nextAssignments from 'Próximas Designações' to 'Próximos Discursos' in pt-BR"
      - id: CHG-491
        description: "Changed home.nextAssignments from 'Next Assignments' to 'Upcoming Speeches' in en"
      - id: CHG-492
        description: "Changed home.nextAssignments from 'Próximas Asignaciones' to 'Próximos Discursos' in es"
      - id: CHG-493
        description: "Changed tabs.agenda and agenda.title from 'Agenda' to 'Agendas' in all 3 locales"
    acs_covered: [AC-122-01, AC-122-02, AC-122-03, AC-122-04, AC-123-01, AC-123-02, AC-123-03, AC-123-04]
    ecs_covered: []

  - step: S15
    cr: CR-192
    plan_ref: plans/PLAN_P033.yaml
    plan_step: S02
    hash: 1a7a707
    message: "fix(notifications): read projectId from Constants.expoConfig instead of passing undefined to getExpoPushTokenAsync (F125, CR-192)"
    files_changed:
      - src/hooks/useNotifications.ts
    changes:
      - id: CHG-494
        description: "Added import Constants from 'expo-constants'"
      - id: CHG-495
        description: "Extracted projectId from Constants.expoConfig?.extra?.eas?.projectId with guard clause"
      - id: CHG-496
        description: "Replaced projectId: undefined with { projectId } in getExpoPushTokenAsync call"
    acs_covered: [AC-125-01, AC-125-02, AC-125-03, AC-125-04, AC-125-05, AC-125-06, AC-125-07]
    ecs_covered: [EC-125-01, EC-125-02, EC-125-03]

  - step: S16
    cr: CR-189
    plan_ref: plans/PLAN_P033.yaml
    plan_step: S03
    hash: cd41082
    message: "fix(ui): restructure SpeechSlot to row-per-element layout for correct X button alignment (F124, CR-189, ADR-081)"
    files_changed:
      - src/components/SpeechSlot.tsx
    changes:
      - id: CHG-497
        description: "Removed two-column layout (outerRow/leftColumn/rightColumn styles and JSX)"
      - id: CHG-498
        description: "Added row-per-element layout with speakerRow, actionArea, topicActionArea styles"
      - id: CHG-499
        description: "Each row (speaker, topic) now contains field + X button as siblings in flexDirection row"
      - id: CHG-500
        description: "Removed statusLedPlaceholder, speakerActionWrapper, topicActionWrapper, row styles"
    acs_covered: [AC-124-01, AC-124-02, AC-124-03, AC-124-04, AC-124-05, AC-124-06]
    ecs_covered: [EC-124-01, EC-124-02]

  - step: S17
    cr: CR-179
    plan_ref: plans/PLAN_P033.yaml
    plan_step: S04
    hash: 52d4906
    message: "feat(agenda): add X clear buttons to all selector-type fields in AgendaForm (F120, CR-179)"
    files_changed:
      - src/components/AgendaForm.tsx
    changes:
      - id: CHG-501
        description: "Added onClear and hasValue optional props to SelectorField component"
      - id: CHG-502
        description: "Added clearButton style and updated selectorField with flexDirection row"
      - id: CHG-503
        description: "Wired onClear for presiding, conducting, pianist, conductor fields (clear name + actor_id)"
      - id: CHG-504
        description: "Wired onClear for opening_hymn_id, sacrament_hymn_id, intermediate_hymn_id, closing_hymn_id"
      - id: CHG-505
        description: "Wired onClear for opening_prayer, closing_prayer (clear name + member_id)"
      - id: CHG-506
        description: "Added recognizingContent/recognizingNames styles for recognizing field X button"
    acs_covered: [AC-120-01, AC-120-02, AC-120-03, AC-120-04, AC-120-05, AC-120-06, AC-120-07, AC-120-08, AC-120-09, AC-120-10]
    ecs_covered: [EC-120-01, EC-120-02, EC-120-03]

  - step: S18
    cr: CR-182
    plan_ref: plans/PLAN_P033.yaml
    plan_step: S05
    hash: 8405019
    message: "feat(agenda): replace editable SpeakerField with read-only row + pencil navigation to Speeches tab via expandDate param (F121, CR-182, ADR-082)"
    files_changed:
      - src/components/AgendaForm.tsx
      - src/app/(tabs)/speeches.tsx
    changes:
      - id: CHG-507
        description: "Removed TextInput from react-native imports, added useRouter from expo-router"
      - id: CHG-508
        description: "Replaced SpeakerField component with ReadOnlySpeakerRow showing name + pencil icon"
      - id: CHG-509
        description: "Pencil navigates to /(tabs)/speeches with expandDate query param"
      - id: CHG-510
        description: "Removed speakerEditRow, speakerEditInput, lastMinuteLabel styles"
      - id: CHG-511
        description: "Added useLocalSearchParams to speeches.tsx to handle expandDate param"
      - id: CHG-512
        description: "Added useEffect in speeches.tsx to expand target card and scroll to it on expandDate"
    acs_covered: [AC-121-01, AC-121-02, AC-121-03, AC-121-04, AC-121-05, AC-121-06, AC-121-07, AC-121-08]
    ecs_covered: [EC-121-01, EC-121-02, EC-121-03]

  - step: S19
    cr: [CR-179, CR-182, CR-183, CR-187, CR-189, CR-192]
    plan_ref: plans/PLAN_P033.yaml
    plan_step: S06
    hash: ab02813
    message: "test(batch19): add 85 tests for F120-F125 and fix 95 legacy test regressions from SpeechSlot/AgendaForm restructure"
    files_changed:
      - src/__tests__/batch19-phase2.test.ts
      - src/__tests__/batch14-phase2.test.ts
      - src/__tests__/batch15-phase1.test.ts
      - src/__tests__/batch16.test.ts
      - src/__tests__/batch17.test.ts
      - src/__tests__/batch18.test.ts
      - src/__tests__/batch7-f040-f044.test.ts
      - src/__tests__/batch8-phase2.test.ts
      - src/__tests__/batch9-phase2.test.ts
      - src/__tests__/cr004-f008-agenda-actors.test.ts
    tests_added: 85
    tests_fixed: 95
    changes:
      - id: CHG-513
        description: "Created batch19-phase2.test.ts with 85 tests covering F120 (13), F121 (11), F122 (4), F123 (4), F124 (8), F125 (10)"
      - id: CHG-514
        description: "Updated 9 legacy test files replacing outerRow/leftColumn/rightColumn with speakerRow/actionArea/topicActionArea"
      - id: CHG-515
        description: "Updated legacy tests replacing SpeakerField references with ReadOnlySpeakerRow"
      - id: CHG-516
        description: "Fixed batch14 EC-095-01 tests that assumed intermediate_hymn_id is never cleared"
    acs_covered: [AC-120-01, AC-120-02, AC-120-03, AC-120-04, AC-120-05, AC-120-06, AC-120-07, AC-120-08, AC-120-09, AC-120-10, AC-121-01, AC-121-02, AC-121-03, AC-121-04, AC-121-05, AC-121-06, AC-121-07, AC-121-08, AC-122-01, AC-122-02, AC-122-03, AC-122-04, AC-123-01, AC-123-02, AC-123-03, AC-123-04, AC-124-01, AC-124-02, AC-124-03, AC-124-04, AC-124-05, AC-124-06, AC-125-01, AC-125-02, AC-125-03, AC-125-04, AC-125-05, AC-125-06, AC-125-07]
    ecs_covered: [EC-120-01, EC-120-02, EC-120-03, EC-121-01, EC-121-02, EC-121-03, EC-124-01, EC-124-02, EC-125-01, EC-125-02, EC-125-03]
