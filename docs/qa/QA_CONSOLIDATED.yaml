# =============================================================================
# QA_CONSOLIDATED.yaml
# Consolidated QA results for CR-82, CR-80, CR-83, CR-84, CR-85, CR-86, CR-90,
# CR-87, CR-88, CR-89
# Updated: 2026-02-18
# =============================================================================

# #############################################################################
# CR-82: GestureDetector must be used as a descendant of GestureHandlerRootView
# #############################################################################

cr_82:
  cr_id: CR-82
  title: "GestureDetector must be used as a descendant of GestureHandlerRootView"
  type: bugfix
  spec: specs/SPEC_F001.yaml
  qa_plan: qa/QA_PLAN_001.yaml

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      QA Plan validated against SPEC. All validation_checks are testable,
      root cause analysis is confirmed, affected files identified. Plan covers
      must_pass (static + runtime) and should_pass (manual) checks.

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "1 of 1"
    commits:
      - hash: ee9d84d
        message: "fix(layout): add GestureHandlerRootView wrapper to root layout (CR-82)"
      - hash: 37e880b
        message: "test(layout): add tests for GestureHandlerRootView wrapper (CR-82)"
      - hash: fd4dc8f
        message: "docs: commit SPEC, ARCH, PLAN, CODE_LEDGER, REVIEW for CR-82"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_tests_passed: 9
    tester_tests_total: 9
    tester_suite_passed: 2456
    tester_suite_total: 2456

    must_pass_results:
      - id: MP-01
        description: "GestureHandlerRootView is imported from react-native-gesture-handler in root layout"
        status: PASSED
        evidence: |
          src/app/_layout.tsx:12 contains:
            import { GestureHandlerRootView } from 'react-native-gesture-handler';

      - id: MP-02
        description: "GestureHandlerRootView wraps the app tree (Slot or equivalent) in root layout"
        status: PASSED
        evidence: |
          src/app/_layout.tsx:108-116: GestureHandlerRootView wraps QueryClientProvider >
          I18nextProvider > ThemeProvider > InnerLayout (which contains AuthProvider >
          SyncProvider > NavigationGuard > Slot). Full app tree is a descendant.

      - id: MP-03
        description: "GestureHandlerRootView has style={{ flex: 1 }} to fill screen"
        status: PASSED
        evidence: |
          src/app/_layout.tsx:108:
            <GestureHandlerRootView style={{ flex: 1 }}>

      - id: MP-04
        description: "SwipeableCard component unchanged - no workaround in child component"
        status: PASSED
        evidence: |
          src/components/SwipeableCard.tsx is unmodified. GestureDetector is used at line 180.
          No local GestureHandlerRootView wrapper was added inside the component.
          The component imports only { Gesture, GestureDetector } from react-native-gesture-handler (line 20-22).

      - id: MP-05
        description: "No duplicate GestureHandlerRootView in nested layouts"
        status: PASSED
        evidence: |
          Grep for GestureHandlerRootView in src/ returns only 3 hits, all in src/app/_layout.tsx
          (import at line 12, opening tag at line 108, closing tag at line 116).
          Verified nested layouts:
          - src/app/(tabs)/_layout.tsx: No GestureHandlerRootView (uses Tabs from expo-router)
          - src/app/(tabs)/settings/_layout.tsx: No GestureHandlerRootView (uses Stack from expo-router)
          - src/app/(auth)/_layout.tsx: No GestureHandlerRootView (uses Stack from expo-router)

      - id: MP-06
        description: "Existing tests still pass after fix"
        status: PASSED
        evidence: |
          npx vitest run: 53 test files, 2456/2456 tests passed.
          Duration: 1.22s. Zero failures, zero skipped.
          Includes 9 new CR-82 specific tests (cr082-gesture-handler-root.test.ts) all passing.

    must_pass_total: 6
    must_pass_passed: 6
    must_pass_failed: 0

    should_pass_results:
      - id: SP-01
        description: "Members screen renders without gesture handler error"
        status: PASSED_BY_ANALYSIS
        evidence: |
          With GestureHandlerRootView at root layout (line 108), all screens rendered via Slot
          are descendants. Members screen (members.tsx:225) uses SwipeableCard > GestureDetector.
          The ancestor requirement is now satisfied. The error "GestureDetector must be used as
          a descendant of GestureHandlerRootView" will no longer be thrown.

      - id: SP-02
        description: "Topics screen renders without gesture handler error"
        status: PASSED_BY_ANALYSIS
        evidence: |
          Same reasoning as SP-01. Topics screen (topics.tsx:123) uses SwipeableCard > GestureDetector.
          GestureHandlerRootView is an ancestor via the root layout wrapper.

      - id: SP-03
        description: "Swipe gesture works on MemberRow"
        status: PASSED_BY_ANALYSIS
        evidence: |
          SwipeableCard.tsx:106-131 defines Gesture.Pan() with activeOffsetX threshold,
          onUpdate handler for translateX, and onEnd handler for snap open/close behavior.
          With gesture handler root view in place, these gestures will be recognized.

      - id: SP-04
        description: "Swipe gesture works on TopicRow"
        status: PASSED_BY_ANALYSIS
        evidence: |
          Same SwipeableCard component used by TopicRow (topics.tsx:123).
          Pan gesture behavior is identical to MemberRow.

    should_pass_total: 4
    should_pass_passed: 4
    should_pass_failed: 0

  spec_compliance:
    functional_requirements:
      - id: FR-82-01
        title: "Wrap app tree with GestureHandlerRootView"
        status: SATISFIED
        evidence: |
          AC-82-01-01: GestureHandlerRootView wraps entire provider tree at _layout.tsx:108-116.
          AC-82-01-02: Members screen SwipeableCard is descendant - no error thrown.
          AC-82-01-03: Topics screen SwipeableCard is descendant - no error thrown.
          AC-82-01-04: GestureHandlerRootView with flex:1 is transparent layout wrapper.

      - id: FR-82-02
        title: "SwipeableCard pan gesture functions correctly"
        status: SATISFIED
        evidence: |
          AC-82-02-01: SwipeableCard pan gesture uses Gesture.Pan() at line 106 with
          activeOffsetX threshold at line 108. GestureDetector wraps card at line 180.
          AC-82-02-02: Same component used by Topics screen at topics.tsx:123.
          AC-82-02-03: Single-reveal managed via activeId prop (lines 83, 86-90, 99-104).

    non_functional_requirements:
      - id: NFR-82-01
        title: "Single file change only"
        status: SATISFIED
        evidence: "Only src/app/_layout.tsx was modified for the fix. Test file added separately."

      - id: NFR-82-02
        title: "No changes to existing provider order"
        status: SATISFIED
        evidence: |
          Provider chain: ErrorBoundary > GestureHandlerRootView > QueryClientProvider >
          I18nextProvider > ThemeProvider > InnerLayout (AuthProvider > SyncProvider >
          NavigationGuard > Slot). Original order preserved, GestureHandlerRootView inserted.

      - id: NFR-82-03
        title: "No visual layout changes"
        status: SATISFIED
        evidence: "GestureHandlerRootView with style={{ flex: 1 }} fills parent. Transparent wrapper."

      - id: NFR-82-04
        title: "Web platform compatibility"
        status: SATISFIED
        evidence: "GestureHandlerRootView renders as regular View on web. No platform conditionals."

      - id: NFR-82-05
        title: "No changes to SwipeableCard component"
        status: SATISFIED
        evidence: "SwipeableCard.tsx unmodified. Fix is root-level only."

  verdict: passed
  verdict_rationale: |
    All 6 must_pass checks passed. All 4 should_pass checks passed (by code analysis).
    All functional requirements (FR-82-01, FR-82-02) satisfied.
    All non-functional requirements (NFR-82-01 through NFR-82-05) satisfied.
    Reviewer approved with 0 issues. Tester approved with 9/9 tests, 2456/2456 suite.
    Full test suite passes with zero regressions.

  issues_for_coder: []


# #############################################################################
# CR-80: Tela de Membros precisa de textos explicativos (i18n pt/en/es)
# #############################################################################

cr_80:
  cr_id: CR-80
  title: "Tela de Membros precisa de textos explicativos (i18n pt/en/es)"
  type: feature_request
  spec: specs/SPEC_F026.yaml
  qa_plan: qa/QA_PLAN_CR80.yaml

  # ===========================================================================
  # PRE VALIDATION (before coding)
  # ===========================================================================

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      QA Plan validated against SPEC_F026. All 7 must_pass and 6 should_pass
      checks are defined and testable. Current state analysis confirms no
      explanatory texts exist. i18n system supports pt-BR/en/es. Feature is
      feasible with no architectural changes needed.

  # ===========================================================================
  # POST VALIDATION (after coding + review)
  # ===========================================================================

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "1 of 1"
    commits:
      - hash: "9359348"
        message: "feat(i18n): add members.description and members.csvHelp keys in pt-BR/en/es (CR-80)"
      - hash: "84bea70"
        message: "feat(members): add description and csvHelp explanatory texts (CR-80)"
      - hash: "dbd5488"
        message: "test(members): add tests for F026 explanatory texts (CR-80)"
      - hash: "2d80bda"
        message: "docs(ledger): update CODE_LEDGER with CR-80 commits (CR-80)"
      - hash: "2250706"
        message: "docs(tests): update TEST_CONSOLIDATED (CR-80)"
      - hash: "a61ec8e"
        message: "docs(cr-80): add REVIEW for F026 (CR-80)"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_tests_passed: 46
    tester_tests_total: 46
    tester_suite_passed: 2502
    tester_suite_total: 2502

    # -------------------------------------------------------------------------
    # MUST_PASS checks
    # -------------------------------------------------------------------------

    must_pass_results:

      - id: MP-80-01
        description: "New i18n keys exist in en.json members section"
        status: PASSED
        evidence: |
          en.json members section (lines 166-167) contains:
            "description": "Add, edit and remove ward members. Swipe a member to edit or delete."
            "csvHelp": "Export saves all members as a CSV file. Import loads a CSV file and replaces the entire member list. Expected format: Name, Full Phone (with country code, e.g. +5511999999999)."
          Both keys are explanatory texts matching SPEC_F026 i18n_keys.

      - id: MP-80-02
        description: "New i18n keys exist in pt-BR.json members section with Portuguese translations"
        status: PASSED
        evidence: |
          pt-BR.json members section (lines 166-167) contains:
            "description": "Adicione, edite e remova membros da ala. Deslize um membro para editar ou excluir."
            "csvHelp": "Exportar salva todos os membros em um arquivo CSV. Importar carrega um arquivo CSV e substitui toda a lista de membros. Formato esperado: Nome, Telefone Completo (com codigo do pais, ex: +5511999999999)."
          Same keys as en.json with proper Portuguese (Brazilian) translations.

      - id: MP-80-03
        description: "New i18n keys exist in es.json members section with Spanish translations"
        status: PASSED
        evidence: |
          es.json members section (lines 166-167) contains:
            "description": "Agregue, edite y elimine miembros del barrio. Deslice un miembro para editar o eliminar."
            "csvHelp": "Exportar guarda todos los miembros en un archivo CSV. Importar carga un archivo CSV y reemplaza toda la lista de miembros. Formato esperado: Nombre, Telefono Completo (con codigo de pais, ej: +5211234567890)."
          Same keys as en.json with proper Spanish translations.

      - id: MP-80-04
        description: "All three locale files have identical key structure in members section"
        status: PASSED
        evidence: |
          All 3 locale files have exactly 23 identical keys in the "members" section:
          title, addMember, fullName, phone, countryCode, importCsv, exportCsv,
          exportFailed, importFailed, importEmpty, importErrorLine, importSuccess,
          deleteConfirm, csvHeaderName, csvHeaderPhone, csvErrorEmptyFile,
          csvErrorInvalidHeader, csvErrorInsufficientColumns, csvErrorNameRequired,
          csvErrorNoData, importReadError, description, csvHelp.
          PARITY CHECK: PASS (verified via script).

      - id: MP-80-05
        description: "Members screen uses t() for new explanatory texts"
        status: PASSED
        evidence: |
          members.tsx:548 uses t('members.description') inside a <Text> element.
          members.tsx:595 uses t('members.csvHelp') inside a <Text> element.
          No hardcoded strings for explanatory texts. Both use the i18n t() function.

      - id: MP-80-06
        description: "No i18n keys removed or renamed (backward compatibility)"
        status: PASSED
        evidence: |
          All 21 pre-existing keys in the "members" section are preserved across all 3 locales.
          Verified by script: Missing existing keys in EN: NONE, PT: NONE, ES: NONE.
          Only 2 new keys added: "description" and "csvHelp". Zero removals or renames.

      - id: MP-80-07
        description: "Existing test suite passes without regressions"
        status: PASSED
        evidence: |
          npx vitest run: 54 test files, 2502/2502 tests passed.
          Duration: 1.29s. Zero failures, zero skipped.
          Includes 46 new CR-80 specific tests (cr080-f026-members-explanatory-texts.test.ts)
          all passing.

    must_pass_total: 7
    must_pass_passed: 7
    must_pass_failed: 0

    # -------------------------------------------------------------------------
    # SHOULD_PASS checks (manual - validated via code analysis)
    # -------------------------------------------------------------------------

    should_pass_results:

      - id: SP-80-01
        description: "Explanatory texts are visible on the Members screen"
        status: PASSED_BY_ANALYSIS
        evidence: |
          members.tsx:547-549: Description text rendered as:
            <Text style={[styles.description, { color: colors.textSecondary }]}>
              {t('members.description')}
            </Text>
          Placed between the header (line 525-544) and search container (line 551-562).
          Always visible, not inside any conditional.

          members.tsx:594-596: CSV help text rendered as:
            <Text style={[styles.csvHelp, { color: colors.textSecondary }]}>
              {t('members.csvHelp')}
            </Text>
          Placed after CSV buttons (line 567-593), inside the canImport conditional block.
          Both use colors.textSecondary for styling consistency.

      - id: SP-80-02
        description: "Texts are properly translated when language is changed to Portuguese"
        status: PASSED_BY_ANALYSIS
        evidence: |
          pt-BR.json contains members.description and members.csvHelp with proper
          Portuguese translations. The i18n system (i18next) handles language switching.
          Test AC-4 verifies exact text content matches SPEC.

      - id: SP-80-03
        description: "Texts are properly translated when language is changed to Spanish"
        status: PASSED_BY_ANALYSIS
        evidence: |
          es.json contains members.description and members.csvHelp with proper
          Spanish translations. The i18n system (i18next) handles language switching.
          Test AC-6 verifies exact text content matches SPEC.

      - id: SP-80-04
        description: "Texts are properly translated when language is changed to English"
        status: PASSED_BY_ANALYSIS
        evidence: |
          en.json contains members.description and members.csvHelp with proper
          English texts. The i18n system (i18next) handles language switching.
          Test AC-5 verifies exact text content matches SPEC.

      - id: SP-80-05
        description: "Explanatory texts do not break layout on small screens"
        status: PASSED_BY_ANALYSIS
        evidence: |
          styles.description: fontSize 13, textAlign 'center', paddingHorizontal 16,
          marginBottom 8. No numberOfLines or fixed width constraints -- allows text wrapping.
          styles.csvHelp: fontSize 12, paddingHorizontal 16, marginBottom 8.
          No numberOfLines or fixed width constraints. Both texts use small font sizes
          (12-13px) appropriate for secondary/helper text on mobile screens.
          Tests EC-2 verify fontSize ranges (12-14 for description, 11-13 for csvHelp).

      - id: SP-80-06
        description: "Empty state message is specific and helpful when no members exist"
        status: PASSED_BY_ANALYSIS
        evidence: |
          The existing ListEmptyComponent still renders t('common.noResults') when the list
          is empty (members.tsx:614-622). The description text (members.description) is
          always visible above the list regardless of member count, providing context even
          when the list is empty. The csvHelp text is also visible above the list when
          canImport is true. This satisfies EC-3 (texts visible regardless of list state).

    should_pass_total: 6
    should_pass_passed: 6
    should_pass_failed: 0

  # ===========================================================================
  # SPEC COMPLIANCE
  # ===========================================================================

  spec_compliance:

    acceptance_criteria:
      - id: AC-1
        title: "Description text visible below the title"
        status: SATISFIED
        evidence: |
          members.tsx:547-549 renders t('members.description') in a Text element
          with styles.description (fontSize 13, textAlign center, paddingHorizontal 16)
          and color colors.textSecondary. Placed between header and search container.

      - id: AC-2
        title: "CSV help text visible when canImport is true"
        status: SATISFIED
        evidence: |
          members.tsx:594-596 renders t('members.csvHelp') in a Text element with
          styles.csvHelp (fontSize 12, paddingHorizontal 16) and color colors.textSecondary.
          Located inside the {canImport && (...)} conditional block, after CSV buttons.

      - id: AC-3
        title: "CSV help text hidden when canImport is false"
        status: SATISFIED
        evidence: |
          The csvHelp Text element is inside the {canImport && (...)} block (lines 565-598).
          When canImport is false, the entire block including CSV buttons and csvHelp text
          is not rendered. Only one occurrence of t('members.csvHelp') exists in the file.

      - id: AC-4
        title: "pt-BR translations correct"
        status: SATISFIED
        evidence: |
          pt-BR.json members.description = "Adicione, edite e remova membros da ala. Deslize um membro para editar ou excluir."
          pt-BR.json members.csvHelp = "Exportar salva todos os membros em um arquivo CSV. Importar carrega um arquivo CSV e substitui toda a lista de membros. Formato esperado: Nome, Telefone Completo (com codigo do pais, ex: +5511999999999)."
          Both match SPEC_F026 i18n_keys exactly.

      - id: AC-5
        title: "en translations correct"
        status: SATISFIED
        evidence: |
          en.json members.description = "Add, edit and remove ward members. Swipe a member to edit or delete."
          en.json members.csvHelp = "Export saves all members as a CSV file. Import loads a CSV file and replaces the entire member list. Expected format: Name, Full Phone (with country code, e.g. +5511999999999)."
          Both match SPEC_F026 i18n_keys exactly.

      - id: AC-6
        title: "es translations correct"
        status: SATISFIED
        evidence: |
          es.json members.description = "Agregue, edite y elimine miembros del barrio. Deslice un miembro para editar o eliminar."
          es.json members.csvHelp = "Exportar guarda todos los miembros en un archivo CSV. Importar carga un archivo CSV y reemplaza toda la lista de miembros. Formato esperado: Nombre, Telefono Completo (con codigo de pais, ej: +5211234567890)."
          Both match SPEC_F026 i18n_keys exactly.

      - id: AC-7
        title: "No regressions in existing functionality"
        status: SATISFIED
        evidence: |
          Full test suite: 54 test files, 2502/2502 tests passed, zero failures.
          CR-80 tests verify existing functionality preservation: SwipeableCard import,
          SwipeableCard rendering, CSV import/export handlers, search, add member, delete
          member, MemberEditor component all confirmed present and unchanged.

  # ===========================================================================
  # OVERALL VERDICT
  # ===========================================================================

  verdict: passed
  verdict_rationale: |
    All 7 must_pass checks passed. All 6 should_pass checks passed (by code analysis).
    All 7 acceptance criteria (AC-1 through AC-7) from SPEC_F026 satisfied.
    Reviewer approved with 0 issues (P0/P1/P2).
    Tester approved with 46/46 CR-80 tests passing, 2502/2502 full suite passing.
    i18n key parity verified across all 3 locales (en, pt-BR, es): 23 identical keys.
    All 21 pre-existing keys preserved. 2 new keys (description, csvHelp) added correctly.
    No regressions detected.

  issues_for_coder: []


# #############################################################################
# CR-90: [BUG] Delete button for members and ward topics does nothing
# #############################################################################

cr_90:
  cr_id: CR-90
  title: "[BUG] Botao de excluir para membros e temas da ala nao faz nada"
  type: bugfix
  spec: specs/SPEC_F027_F031.yaml
  qa_plan: qa/QA_PLAN_batch6_phase1.yaml

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      Bug confirmed via code analysis. Delete button in SwipeableCard does not fire
      for members or topics. Edit button works with identical pattern. Root cause
      identified as touch event interception by GestureDetector's Animated.View (zIndex: 1).
      Reproduction steps documented.

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "1 of 1"
    commits:
      - hash: 298258c
        message: "fix(swipeable): add pointerEvents box-none to fix Delete button touch (CR-90)"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_suite_passed: 2610
    tester_suite_total: 2610

    must_pass_results:
      - id: MP-90-01
        description: "Delete button in SwipeableCard fires onDelete callback when tapped"
        status: PASSED
        evidence: |
          SwipeableCard.tsx:183 now has pointerEvents="box-none" on the Animated.View.
          This allows touch events to pass through the Animated.View to the action buttons
          behind it. The handleDelete callback (line 143-147) calls onDelete?.() correctly.
          The fix ensures touch events reach the Pressable buttons in the actionsContainer.

      - id: MP-90-02
        description: "Members screen: delete button shows confirmation dialog"
        status: PASSED
        evidence: |
          members.tsx:317-346: handleDelete calls Alert.alert with t('common.confirm') and
          t('members.deleteConfirm'). The onDelete prop passes handleDelete via
          MemberRow (line 219) > SwipeableCard (line 219). With pointerEvents="box-none",
          the Pressable now receives touch events correctly.

      - id: MP-90-03
        description: "Topics screen: delete button shows confirmation dialog"
        status: PASSED
        evidence: |
          topics.tsx:268-280: handleDelete calls Alert.alert with t('common.confirm') and
          t('members.deleteConfirm'). TopicRow (line 153) passes onDelete to SwipeableCard.
          Same fix applies - pointerEvents="box-none" allows touch through.

      - id: MP-90-04
        description: "Edit button continues to work after fix"
        status: PASSED
        evidence: |
          SwipeableCard.tsx:156: Edit Pressable with onPress={handleEdit} is in the same
          actionsContainer as delete. handleEdit (line 137-141) calls onEdit?.().
          pointerEvents="box-none" does not affect edit button since it was already receiving
          touches (positioned closer to the translated card edge). Both buttons now work.

      - id: MP-90-05
        description: "SwipeableCard swipe gesture still works correctly"
        status: PASSED
        evidence: |
          GestureDetector (line 180) wraps the Animated.View. pointerEvents="box-none"
          on the Animated.View means the view itself doesn't block events, but its children
          (the inner View with backgroundColor) still receive touches normally. The
          panGesture (line 106-131) still responds to horizontal swipe on the card content.

      - id: MP-90-06
        description: "Only one card can be revealed at a time"
        status: PASSED
        evidence: |
          activeId/onReveal mechanism unchanged (lines 83, 86-90, 99-104). When a card
          is revealed, it sets activeId to its id. Other cards close via useEffect (line 86-90).
          This management is in the parent component, unaffected by the pointerEvents fix.

      - id: MP-90-07
        description: "Existing test suite passes without regressions"
        status: PASSED
        evidence: |
          npx vitest run: 55 test files, 2610/2610 tests passed.
          Duration: 1.29s. Zero failures, zero skipped.

    must_pass_total: 7
    must_pass_passed: 7
    must_pass_failed: 0

    should_pass_results:
      - id: SP-90-01
        description: "Confirming delete in dialog actually deletes the member"
        status: PASSED_BY_ANALYSIS
        evidence: |
          members.tsx:331: Alert destructive button calls deleteMember.mutate({ memberId, memberName }).
          useDeleteMember hook handles the Supabase delete operation.

      - id: SP-90-02
        description: "Confirming delete in dialog actually deletes the topic"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:275: Alert destructive button calls deleteTopic.mutate({ topicId, topicTitle }).
          useDeleteWardTopic hook handles the Supabase delete operation.

      - id: SP-90-03
        description: "Delete button visual appearance unchanged"
        status: PASSED_BY_ANALYSIS
        evidence: |
          SwipeableCard.tsx:167: deleteButton style unchanged (backgroundColor: colors.error).
          Text color remains '#FFFFFF' (line 172). Only change is pointerEvents on parent Animated.View.

    should_pass_total: 3
    should_pass_passed: 3
    should_pass_failed: 0

  verdict: passed
  verdict_rationale: |
    All 7 must_pass checks passed. All 3 should_pass checks passed (by analysis).
    Root cause was the Animated.View with zIndex:1 intercepting touch events on action buttons.
    Fix: pointerEvents="box-none" on Animated.View allows touches to pass through to
    action buttons while maintaining gesture detection on child content.
    Single-line fix in SwipeableCard.tsx. No regressions. 2610/2610 tests passing.

  issues_for_coder: []


# #############################################################################
# CR-83: Save/Cancel buttons for members and ward topics
# #############################################################################

cr_83:
  cr_id: CR-83
  title: "Membros e temas da ala: salvar somente ao clicar Salvar, adicionar botao Cancelar"
  type: feature_request
  spec: specs/SPEC_F027_F031.yaml
  qa_plan: qa/QA_PLAN_batch6_phase1.yaml

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      Current state confirmed: MemberEditor and TopicEditor save onBlur with no
      explicit Save/Cancel buttons. i18n keys common.save and common.cancel already exist.
      Feature is feasible with no architectural changes.

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "1 of 1"
    commits:
      - hash: 89b5dc9
        message: "feat(members): replace onBlur auto-save with Save/Cancel buttons (CR-83)"
      - hash: 1970e71
        message: "feat(topics): replace onBlur auto-save with Save/Cancel buttons (CR-83)"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_suite_passed: 2610
    tester_suite_total: 2610

    must_pass_results:
      - id: MP-83-01
        description: "MemberEditor does NOT save onBlur for name field"
        status: PASSED
        evidence: |
          members.tsx:77-88: Name TextInput has NO onBlur handler. Only onChangeText={setFullName}.
          The old onBlur={handleSave} has been removed.

      - id: MP-83-02
        description: "MemberEditor does NOT save onBlur for phone field"
        status: PASSED
        evidence: |
          members.tsx:98-107: Phone TextInput has NO onBlur handler. Only onChangeText={setPhone}.
          The old onBlur={handleSave} has been removed.

      - id: MP-83-03
        description: "TopicEditor does NOT save onBlur for title field"
        status: PASSED
        evidence: |
          topics.tsx:66-75: Title TextInput has NO onBlur handler. Only onChangeText={setTitle}.
          The old onBlur={handleSave} has been removed.

      - id: MP-83-04
        description: "TopicEditor does NOT save onBlur for link field"
        status: PASSED
        evidence: |
          topics.tsx:76-86: Link TextInput has NO onBlur handler. Only onChangeText={setLink}.
          The old onBlur={handleSave} has been removed.

      - id: MP-83-05
        description: "MemberEditor renders a Save button"
        status: PASSED
        evidence: |
          members.tsx:121-129: Pressable with onPress={handleSave} renders
          t('common.save') text. Style: saveButton with backgroundColor: colors.primary.

      - id: MP-83-06
        description: "MemberEditor renders a Cancel button"
        status: PASSED
        evidence: |
          members.tsx:112-120: Pressable with onPress={onCancel} renders
          t('common.cancel') text. Style: cancelButton with color: colors.textSecondary.

      - id: MP-83-07
        description: "TopicEditor renders a Save button"
        status: PASSED
        evidence: |
          topics.tsx:99-107: Pressable with onPress={handleSave} renders
          t('common.save') text. Style: saveButton with backgroundColor: colors.primary.

      - id: MP-83-08
        description: "TopicEditor renders a Cancel button"
        status: PASSED
        evidence: |
          topics.tsx:90-98: Pressable with onPress={onCancel} renders
          t('common.cancel') text. Style: cancelButton with color: colors.textSecondary.

      - id: MP-83-09
        description: "MemberEditor Save button calls onSave with data"
        status: PASSED
        evidence: |
          members.tsx:69-73: handleSave trims fullName, validates non-empty, and calls
          onSave({ full_name, country_code, phone }). Save button (line 123) calls handleSave.

      - id: MP-83-10
        description: "MemberEditor Cancel button calls onCancel"
        status: PASSED
        evidence: |
          members.tsx:114: Cancel button onPress={onCancel}. onCancel is a required prop
          in MemberEditorProps (line 50).

      - id: MP-83-11
        description: "TopicEditor Save button calls onSave with data"
        status: PASSED
        evidence: |
          topics.tsx:58-62: handleSave trims title, validates non-empty, and calls
          onSave({ title, link }). Save button (line 101) calls handleSave.

      - id: MP-83-12
        description: "TopicEditor Cancel button calls onCancel"
        status: PASSED
        evidence: |
          topics.tsx:92: Cancel button onPress={onCancel}. onCancel is a required prop
          in TopicEditorProps (line 42).

      - id: MP-83-13
        description: "TopicEditor accepts onCancel prop"
        status: PASSED
        evidence: |
          topics.tsx:42: TopicEditorProps interface includes "onCancel: () => void".
          TopicEditor destructures it at line 46: { topic, onSave, onCancel, colors }.

      - id: MP-83-14
        description: "Existing test suite passes without regressions"
        status: PASSED
        evidence: |
          npx vitest run: 55 test files, 2610/2610 tests passed.
          Zero failures, zero skipped.

    must_pass_total: 14
    must_pass_passed: 14
    must_pass_failed: 0

    should_pass_results:
      - id: SP-83-01
        description: "Save and Cancel buttons are positioned appropriately in MemberEditor"
        status: PASSED_BY_ANALYSIS
        evidence: |
          members.tsx:111: editorButtons View with flexDirection:'row', justifyContent:'flex-end',
          gap:8, marginTop:8. Cancel button first, Save button second (right-aligned).

      - id: SP-83-02
        description: "Save and Cancel buttons are positioned appropriately in TopicEditor"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:89: editorButtons View with flexDirection:'row', justifyContent:'flex-end',
          gap:8, marginTop:8. Cancel button first, Save button second (right-aligned).
          Identical layout pattern as MemberEditor.

      - id: SP-83-03
        description: "New member: Cancel discards addition without creating member"
        status: PASSED_BY_ANALYSIS
        evidence: |
          members.tsx:601: onCancel={() => setIsAdding(false)}. MemberEditor Cancel button
          calls this, which hides the editor without calling createMember.mutate.

      - id: SP-83-04
        description: "Edit member: Cancel reverts to display mode without saving changes"
        status: PASSED_BY_ANALYSIS
        evidence: |
          members.tsx:511: onCancel={() => setEditingId(null)}. MemberEditor Cancel button
          calls this, which exits edit mode without calling updateMember.mutate.

      - id: SP-83-05
        description: "New topic: Cancel discards addition without creating topic"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:339: onCancel={() => setIsAdding(false)}. TopicEditor Cancel button
          calls this, which hides the editor without calling createTopic.mutate.

      - id: SP-83-06
        description: "Edit topic: Cancel reverts to display mode without saving changes"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:353: onCancel={() => setEditingId(null)}. TopicEditor Cancel button
          calls this, which exits edit mode without calling updateTopic.mutate.

    should_pass_total: 6
    should_pass_passed: 6
    should_pass_failed: 0

  verdict: passed
  verdict_rationale: |
    All 14 must_pass checks passed. All 6 should_pass checks passed (by analysis).
    onBlur auto-save removed from all 4 TextInputs (name, phone in MemberEditor;
    title, link in TopicEditor). Save and Cancel buttons added to both editors.
    TopicEditor now accepts onCancel prop. Both editors use consistent button layout
    (flex-end, Save on right). No regressions. 2610/2610 tests passing.

  issues_for_coder: []


# #############################################################################
# CR-84: Clear (X) button for all search fields
# #############################################################################

cr_84:
  cr_id: CR-84
  title: "Adicionar botao X para limpar campo de search em todos os campos de busca do app"
  type: feature_request
  spec: specs/SPEC_F027_F031.yaml
  qa_plan: qa/QA_PLAN_batch6_phase1.yaml

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      10 search fields identified across the app. None had a clear (X) button.
      Standard UX pattern, feasible with reusable component or inline implementation.

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "1 of 1"
    commits:
      - hash: 8f2b42a
        message: "feat(components): create SearchInput component with clear X button (CR-84)"
      - hash: 27daf39
        message: "feat(settings): migrate search fields to SearchInput in 4 settings screens (CR-84)"
      - hash: ede8904
        message: "feat(components): migrate search fields to SearchInput in 6 modal/selector components (CR-84)"
      - hash: ac4b489
        message: "fix(tests): update CR-39 tests for SearchInput migration"
      - hash: 3b780d4
        message: "fix(tests): update CR-80 test for SearchInput migration"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_suite_passed: 2610
    tester_suite_total: 2610

    must_pass_results:
      - id: MP-84-01
        description: "Members screen search has clear (X) button when text present"
        status: PASSED
        evidence: |
          members.tsx:554-558: Uses <SearchInput value={search} onChangeText={setSearch} />.
          SearchInput.tsx:44-55: Renders clear button when value.length > 0.

      - id: MP-84-02
        description: "Topics screen search has clear (X) button when text present"
        status: PASSED
        evidence: |
          topics.tsx:331-335: Uses <SearchInput value={search} onChangeText={setSearch} />.

      - id: MP-84-03
        description: "History screen search has clear (X) button when text present"
        status: PASSED
        evidence: |
          history.tsx:107: Uses <SearchInput value={...} onChangeText={updateSearch} />.
          Import at line 14: import { SearchInput } from '../../../components/SearchInput'.

      - id: MP-84-04
        description: "Timezone screen search has clear (X) button when text present"
        status: PASSED
        evidence: |
          timezone.tsx:207: Uses <SearchInput value={search} onChangeText={setSearch} />.
          Import at line 16: import { SearchInput } from '../../../components/SearchInput'.

      - id: MP-84-05
        description: "HymnSelector search has clear (X) button when text present"
        status: PASSED
        evidence: |
          HymnSelector.tsx:103: Uses <SearchInput value={search} onChangeText={setSearch} />.
          Import at line 17: import { SearchInput } from './SearchInput'.

      - id: MP-84-06
        description: "MemberSelectorModal search has clear (X) button when text present"
        status: PASSED
        evidence: |
          MemberSelectorModal.tsx:63: Uses <SearchInput value={search} onChangeText={setSearch} />.
          Import at line 17: import { SearchInput } from './SearchInput'.

      - id: MP-84-07
        description: "TopicSelectorModal search has clear (X) button when text present"
        status: PASSED
        evidence: |
          TopicSelectorModal.tsx:80: Uses <SearchInput value={search} onChangeText={setSearch} />.
          Import at line 17: import { SearchInput } from './SearchInput'.

      - id: MP-84-08
        description: "PrayerSelector search has clear (X) button when text present"
        status: PASSED
        evidence: |
          PrayerSelector.tsx:114: Uses <SearchInput value={search} onChangeText={setSearch} />.
          Import at line 18: import { SearchInput } from './SearchInput'.

      - id: MP-84-09
        description: "ActorSelector search has clear (X) button when text present"
        status: PASSED
        evidence: |
          ActorSelector.tsx:199: Uses <SearchInput value={search} onChangeText={setSearch} />.
          Import at line 21: import { SearchInput } from './SearchInput'.

      - id: MP-84-10
        description: "AgendaForm search has clear (X) button when text present"
        status: PASSED
        evidence: |
          AgendaForm.tsx:702: Uses <SearchInput value={search} onChangeText={setSearch} />.
          Import at line 32: import { SearchInput } from './SearchInput'.

      - id: MP-84-11
        description: "Clear button clears search text (sets to empty string)"
        status: PASSED
        evidence: |
          SearchInput.tsx:47: onPress={() => onChangeText('')}. Calls the parent's
          onChangeText with empty string, which sets the search state to ''.

      - id: MP-84-12
        description: "Clear button is NOT visible when search field is empty"
        status: PASSED
        evidence: |
          SearchInput.tsx:44: {value.length > 0 && (<Pressable ... />)}.
          Conditional rendering: button only appears when value has text.

      - id: MP-84-13
        description: "Existing test suite passes without regressions"
        status: PASSED
        evidence: |
          npx vitest run: 55 test files, 2610/2610 tests passed.
          Zero failures, zero skipped. Includes regression fixes for CR-39 and CR-80 tests
          that were updated for SearchInput migration.

    must_pass_total: 13
    must_pass_passed: 13
    must_pass_failed: 0

    should_pass_results:
      - id: SP-84-01
        description: "X button is positioned at right side of search input"
        status: PASSED_BY_ANALYSIS
        evidence: |
          SearchInput.tsx:75-76: clearButton style has position:'absolute', right:8.
          Positioned at the right side of the input container.

      - id: SP-84-02
        description: "X button has appropriate size for touch target (>= 24px)"
        status: PASSED_BY_ANALYSIS
        evidence: |
          SearchInput.tsx:79-80: clearButton has width:24, height:24. Plus hitSlop={8}
          on the Pressable (line 48), giving an effective touch area of 40x40px.

      - id: SP-84-03
        description: "All 10 search fields use consistent X button styling"
        status: PASSED_BY_ANALYSIS
        evidence: |
          All 10 search fields use the same SearchInput component. Styling is centralized
          in SearchInput.tsx styles. Uses Unicode multiply sign (U+00D7) for the X character
          with colors.textSecondary color. Consistent across all instances.

    should_pass_total: 3
    should_pass_passed: 3
    should_pass_failed: 0

  verdict: passed
  verdict_rationale: |
    All 13 must_pass checks passed. All 3 should_pass checks passed (by analysis).
    Created reusable SearchInput component (DRY approach). All 10 search fields migrated.
    X button shows conditionally (value.length > 0), clears text on press, positioned
    at right side with 24x24 size + 8px hitSlop. Consistent styling across all instances.
    Regression fixes applied for existing CR-39 and CR-80 tests. 2610/2610 tests passing.

  issues_for_coder: []


# #############################################################################
# CR-85: Complete international country codes list
# #############################################################################

cr_85:
  cr_id: CR-85
  title: "Lista de codigos internacionais de telefone incompleta, faltam muitos paises"
  type: bugfix
  spec: specs/SPEC_F027_F031.yaml
  qa_plan: qa/QA_PLAN_batch6_phase1.yaml

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      COUNTRY_CODES array had only 21 entries. csvUtils.ts splitPhoneNumber hardcoded
      same 21 codes. User wants a more complete list of all countries.

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "1 of 1"
    commits:
      - hash: 8d0f6c4
        message: "feat(lib): create countryCodes.ts with ~200 country codes (CR-85)"
      - hash: 59eaba7
        message: "refactor(members,csv): use shared countryCodes.ts (CR-85)"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_suite_passed: 2610
    tester_suite_total: 2610

    must_pass_results:
      - id: MP-85-01
        description: "COUNTRY_CODES list has significantly more entries (>= 100 countries)"
        status: PASSED
        evidence: |
          src/lib/countryCodes.ts: 172 entries in COUNTRY_CODES array (lines 16-191).
          Far exceeds the minimum threshold of 100. Previously had 21.

      - id: MP-85-02
        description: "All major LDS-presence countries are included"
        status: PASSED
        evidence: |
          Verified all 44 key countries present: Brazil, United States, Mexico, Argentina,
          Chile, Colombia, Peru, Philippines, Guatemala, Honduras, Ecuador, Bolivia, Paraguay,
          Uruguay, Portugal, Angola, Mozambique, Cape Verde, United Kingdom, Spain, France,
          Germany, Italy, Japan, South Korea, Australia, New Zealand, Canada, India, Nigeria,
          Ghana, South Africa, Kenya, El Salvador, Costa Rica, Panama, Haiti, Cuba, Taiwan,
          Hong Kong, Singapore, Thailand, Fiji, Tonga. Zero missing.

      - id: MP-85-03
        description: "splitPhoneNumber in csvUtils.ts recognizes all new country codes"
        status: PASSED
        evidence: |
          csvUtils.ts:6-7: Now re-exports splitPhoneNumber from './countryCodes'.
          countryCodes.ts:204-216: CODE_SETS_BY_LENGTH is dynamically built from COUNTRY_CODES
          array, grouping by digit length. splitPhoneNumber (line 222-244) iterates longest
          codes first for correct matching. No hardcoded regex patterns - fully data-driven
          from the COUNTRY_CODES array. Any new entry in COUNTRY_CODES is automatically
          recognized by splitPhoneNumber.

      - id: MP-85-04
        description: "Each country entry has code, flag emoji, and label"
        status: PASSED
        evidence: |
          countryCodes.ts:6-10: CountryCode interface requires { code: string; flag: string; label: string }.
          All 172 entries follow this format. Example (line 18):
            { code: '+55', flag: '\u{1F1E7}\u{1F1F7}', label: 'Brazil (+55)' }
          Labels include country name and dial code in parentheses.

      - id: MP-85-05
        description: "No duplicate country codes in the list"
        status: PASSED
        evidence: |
          170 unique codes out of 172 entries. Only duplicates are:
          - +1: Canada and United States (valid - shared NANP code)
          - +7: Kazakhstan and Russia (valid - shared code)
          These are legitimate shared international dial codes.

      - id: MP-85-06
        description: "Existing test suite passes without regressions"
        status: PASSED
        evidence: |
          npx vitest run: 55 test files, 2610/2610 tests passed.
          Zero failures, zero skipped.

    must_pass_total: 6
    must_pass_passed: 6
    must_pass_failed: 0

    should_pass_results:
      - id: SP-85-01
        description: "Countries are sorted in a logical order"
        status: PASSED_BY_ANALYSIS
        evidence: |
          countryCodes.ts: Brazil listed first as default (line 17-18), then alphabetical
          by English country name from Afghanistan (line 20) to Zimbabwe (line 190).
          Comment at line 3 documents this: "Brazil (+55) listed first, then alphabetical
          by country name."

      - id: SP-85-02
        description: "Country code picker modal is usable with large list"
        status: PASSED_BY_ANALYSIS
        evidence: |
          members.tsx:144-164: FlatList renders COUNTRY_CODES in a scrollable modal
          with maxHeight:400 (line 792). FlatList is virtualized, so 172 items won't
          cause performance issues. Note: no search in picker, but scrolling works.

      - id: SP-85-03
        description: "Flag emojis are correct Unicode regional indicator symbols"
        status: PASSED_BY_ANALYSIS
        evidence: |
          All flags use Unicode Regional Indicator Symbol pairs (U+1F1E6 through U+1F1FF).
          Example: Brazil = '\u{1F1E7}\u{1F1F7}' = BR regional indicators.
          getFlagForCode (line 196-198) returns matching flag or globe fallback.

    should_pass_total: 3
    should_pass_passed: 3
    should_pass_failed: 0

  verdict: passed
  verdict_rationale: |
    All 6 must_pass checks passed. All 3 should_pass checks passed (by analysis).
    Expanded from 21 to 172 country codes. Extracted to shared countryCodes.ts module (DRY).
    splitPhoneNumber now data-driven from COUNTRY_CODES (no hardcoded regex patterns).
    csvUtils.ts re-exports from countryCodes.ts. All 44 key LDS-presence countries present.
    Only valid duplicates (+1 US/CA, +7 RU/KZ). Alphabetical ordering with Brazil first.
    2610/2610 tests passing.

  issues_for_coder: []


# #############################################################################
# CR-86: Confirmation dialog before Import CSV
# #############################################################################

cr_86:
  cr_id: CR-86
  title: "Dialogo de confirmacao antes de Importar CSV"
  type: feature_request
  spec: specs/SPEC_F027_F031.yaml
  qa_plan: qa/QA_PLAN_batch6_phase1.yaml

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      handleImport went directly to file picker without confirmation. Alert.alert pattern
      already used in codebase. New i18n keys needed for confirmation text.

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "1 of 1"
    commits:
      - hash: 5d65fb1
        message: "feat(i18n): add CSV import confirmation keys (CR-86)"
      - hash: 5837628
        message: "feat(members): add confirmation dialog before CSV import (CR-86)"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_suite_passed: 2610
    tester_suite_total: 2610

    must_pass_results:
      - id: MP-86-01
        description: "Import button triggers confirmation dialog before file picker"
        status: PASSED
        evidence: |
          members.tsx:488-497: handleImport calls Alert.alert with importConfirmTitle
          and importConfirmMessage. Only the confirm callback calls performImport().
          The file picker (performImport, lines 445-485) is NOT called directly anymore.

      - id: MP-86-02
        description: "Confirmation dialog warns that import replaces entire member list"
        status: PASSED
        evidence: |
          en.json:169: "importConfirmMessage": "Importing a CSV file will replace the entire
          current member list with the contents of the file. ..."
          The word "replace" and "entire" clearly warn about the destructive nature.

      - id: MP-86-03
        description: "Confirmation dialog states that assignments are not affected"
        status: PASSED
        evidence: |
          en.json:169: "...Existing speech assignments (past and present) will not be affected.
          Do you want to continue?"
          Explicitly mentions past and present assignments are unaffected.

      - id: MP-86-04
        description: "File picker only opens after user confirms"
        status: PASSED
        evidence: |
          members.tsx:494: onPress: () => performImport(). The performImport function
          (which opens DocumentPicker or web file input) is only called inside the
          confirm button's onPress callback, after the user explicitly confirms.

      - id: MP-86-05
        description: "Cancel in confirmation dialog does NOT open file picker"
        status: PASSED
        evidence: |
          members.tsx:493: { text: t('common.cancel'), style: 'cancel' }. The cancel button
          has no onPress handler, so Alert dismisses without calling performImport.

      - id: MP-86-06
        description: "i18n keys for confirmation exist in en.json"
        status: PASSED
        evidence: |
          en.json:168-169:
            "importConfirmTitle": "Import Members"
            "importConfirmMessage": "Importing a CSV file will replace the entire current
            member list with the contents of the file. Existing speech assignments (past
            and present) will not be affected. Do you want to continue?"

      - id: MP-86-07
        description: "i18n keys for confirmation exist in pt-BR.json"
        status: PASSED
        evidence: |
          pt-BR.json:168-169:
            "importConfirmTitle": "Importar Membros"
            "importConfirmMessage": "Ao importar um arquivo CSV, toda a lista de membros
            atual sera substituida pelo conteudo do arquivo. As designacoes de discursos
            existentes (passadas e presentes) nao serao afetadas. Deseja continuar?"

      - id: MP-86-08
        description: "i18n keys for confirmation exist in es.json"
        status: PASSED
        evidence: |
          es.json:168-169:
            "importConfirmTitle": "Importar Miembros"
            "importConfirmMessage": "Al importar un archivo CSV, toda la lista de miembros
            actual sera reemplazada por el contenido del archivo. Las asignaciones de
            discursos existentes (pasadas y presentes) no seran afectadas. Desea continuar?"

      - id: MP-86-09
        description: "Existing test suite passes without regressions"
        status: PASSED
        evidence: |
          npx vitest run: 55 test files, 2610/2610 tests passed.
          Zero failures, zero skipped.

    must_pass_total: 9
    must_pass_passed: 9
    must_pass_failed: 0

    should_pass_results:
      - id: SP-86-01
        description: "Confirmation dialog has appropriate title"
        status: PASSED_BY_ANALYSIS
        evidence: |
          members.tsx:490: Alert title is t('members.importConfirmTitle').
          en: "Import Members", pt: "Importar Membros", es: "Importar Miembros".
          Clear, descriptive title identifying the action.

      - id: SP-86-02
        description: "Confirmation dialog has confirm and cancel buttons"
        status: PASSED_BY_ANALYSIS
        evidence: |
          members.tsx:492-495: Alert has 2 buttons:
          1. { text: t('common.cancel'), style: 'cancel' } - dismisses dialog
          2. { text: t('common.confirm'), style: 'default', onPress: () => performImport() }
          Cancel first (iOS convention), confirm second.

      - id: SP-86-03
        description: "Translations are accurate in all 3 languages"
        status: PASSED_BY_ANALYSIS
        evidence: |
          Portuguese: "substituida", "designacoes de discursos", "nao serao afetadas" -
          natural Brazilian Portuguese.
          Spanish: "reemplazada", "asignaciones de discursos", "no seran afectadas" -
          natural Spanish. Both convey the same meaning as English accurately.

    should_pass_total: 3
    should_pass_passed: 3
    should_pass_failed: 0

  verdict: passed
  verdict_rationale: |
    All 9 must_pass checks passed. All 3 should_pass checks passed (by analysis).
    Import flow now: button press > confirmation Alert > user confirms > file picker opens.
    Dialog warns about replacing entire member list and reassures about assignments.
    New i18n keys added to all 3 locales (en, pt-BR, es) with accurate translations.
    handleImport refactored into handleImport (dialog) + performImport (file picker).
    2610/2610 tests passing.

  issues_for_coder: []


# #############################################################################
# CR-87: Replace Edit/Delete text with pencil/trash icons on swipe buttons
# #############################################################################

cr_87:
  cr_id: CR-87
  title: "Trocar texto Editar/Excluir nos botoes de swipe por icones de lapis e lixeira"
  type: feature_request
  spec: specs/SPEC_F032_F034.yaml
  qa_plan: qa/QA_PLAN_batch6_phase2.yaml

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      QA Plan validated against SPEC. SwipeableCard currently renders text labels
      on swipe action buttons. Validation checks cover icon rendering, a11y labels,
      callbacks, contrast, and test suite.

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "2 of 2"
    commits:
      - hash: 4e0fbb7
        message: "feat(swipeable): replace Edit/Delete text with Unicode icons pencil/trash (CR-87)"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_suite_passed: 2716
    tester_suite_total: 2716

    must_pass_results:

      - id: MP-87-01
        description: "Edit swipe button renders a pencil/edit icon instead of text"
        status: PASSED
        evidence: |
          SwipeableCard.tsx:160-162: Edit button renders <Text style={[styles.actionIcon, { color: colors.onPrimary }]}>{'\u270F'}</Text>.
          U+270F is the Pencil Unicode character. No text label (editLabel) is rendered
          as visible content. The old actionText style with fontSize:13 is replaced by
          actionIcon style with fontSize:20.

      - id: MP-87-02
        description: "Delete swipe button renders a trash/delete icon instead of text"
        status: PASSED
        evidence: |
          SwipeableCard.tsx:172-174: Delete button renders <Text style={[styles.actionIcon, { color: '#FFFFFF' }]}>{'\uD83D\uDDD1'}</Text>.
          This is the UTF-16 surrogate pair for U+1F5D1 (Wastebasket). No text label
          (deleteLabel) is rendered as visible content.

      - id: MP-87-03
        description: "Edit button retains accessibility label for screen readers"
        status: PASSED
        evidence: |
          SwipeableCard.tsx:158: accessibilityLabel={editLabel ?? 'Edit'}.
          The Pressable retains the descriptive text for screen readers even though
          the visible content is now an icon. When parent passes editLabel (e.g.,
          t('common.edit')), that text is used for accessibility.

      - id: MP-87-04
        description: "Delete button retains accessibility label for screen readers"
        status: PASSED
        evidence: |
          SwipeableCard.tsx:170: accessibilityLabel={deleteLabel ?? 'Delete'}.
          Same pattern as edit button. Screen readers announce "Delete" or i18n
          equivalent, not the Unicode character.

      - id: MP-87-05
        description: "Edit button still triggers onEdit callback when pressed"
        status: PASSED
        evidence: |
          SwipeableCard.tsx:156: onPress={handleEdit}. handleEdit (lines 137-141)
          calls translateX.value = withSpring(0, SPRING_CONFIG), onReveal(null),
          and onEdit?.(). No change from previous behavior.

      - id: MP-87-06
        description: "Delete button still triggers onDelete callback when pressed"
        status: PASSED
        evidence: |
          SwipeableCard.tsx:168: onPress={handleDelete}. handleDelete (lines 143-147)
          calls translateX.value = withSpring(0, SPRING_CONFIG), onReveal(null),
          and onDelete?.(). No change from previous behavior.

      - id: MP-87-07
        description: "Icon color contrasts with button background"
        status: PASSED
        evidence: |
          SwipeableCard.tsx:160: Edit icon uses color: colors.onPrimary (white on
          primary background, line 155: backgroundColor: colors.primary).
          SwipeableCard.tsx:172: Delete icon uses color: '#FFFFFF' (white on error
          background, line 167: backgroundColor: colors.error).
          Both provide high contrast.

      - id: MP-87-08
        description: "Existing test suite passes without regressions"
        status: PASSED
        evidence: |
          npx vitest run: 56 test files, 2716/2716 tests passed.
          Zero failures, zero skipped.

    must_pass_total: 8
    must_pass_passed: 8
    must_pass_failed: 0

    should_pass_results:

      - id: SP-87-01
        description: "Icons are appropriately sized for the button area"
        status: PASSED_BY_ANALYSIS
        evidence: |
          SwipeableCard.tsx:219-222: actionIcon style has fontSize: 20, textAlign: 'center'.
          Each action button has flex: 1 within the 140px-wide actionsContainer (70px each).
          fontSize 20 is well-sized for a 70px button, centered via textAlign and
          alignItems/justifyContent center on the Pressable.

      - id: SP-87-02
        description: "Icons are recognizable as edit (pencil) and delete (trash)"
        status: PASSED_BY_ANALYSIS
        evidence: |
          U+270F (Pencil) is universally recognized as an edit/pencil icon.
          U+1F5D1 (Wastebasket) is universally recognized as a delete/trash icon.
          Both are standard Unicode characters rendered natively on iOS and Android.

      - id: SP-87-03
        description: "Swipe buttons visual appearance is improved with icons vs text"
        status: PASSED_BY_ANALYSIS
        evidence: |
          Icons (20px) fit well in the 70px-wide buttons. Previously text labels could
          truncate on narrow screens or in languages with long translations (e.g.,
          "Excluir" in Portuguese). Icons are language-agnostic and visually cleaner.

    should_pass_total: 3
    should_pass_passed: 3
    should_pass_failed: 0

  spec_compliance:
    acceptance_criteria:
      - id: AC-F032-01
        title: "Icons replace text on swipe action buttons"
        status: SATISFIED
        evidence: |
          Edit button: U+270F Pencil at SwipeableCard.tsx:161.
          Delete button: U+1F5D1 Wastebasket at SwipeableCard.tsx:173.
          No text rendered inside buttons. Only icon characters.

      - id: AC-F032-02
        title: "Edit button onPress calls onEdit callback"
        status: SATISFIED
        evidence: "SwipeableCard.tsx:156 onPress={handleEdit}, handleEdit line 140 calls onEdit?.()"

      - id: AC-F032-03
        title: "Delete button onPress calls onDelete callback"
        status: SATISFIED
        evidence: "SwipeableCard.tsx:168 onPress={handleDelete}, handleDelete line 146 calls onDelete?.()"

      - id: AC-F032-04
        title: "Accessibility labels retained for screen readers"
        status: SATISFIED
        evidence: |
          Edit: accessibilityLabel={editLabel ?? 'Edit'} (line 158).
          Delete: accessibilityLabel={deleteLabel ?? 'Delete'} (line 170).

      - id: AC-F032-05
        title: "Icons visible with proper contrast and sizing"
        status: SATISFIED
        evidence: |
          Edit icon: colors.onPrimary on colors.primary bg. Delete icon: #FFFFFF on colors.error bg.
          fontSize: 20, textAlign: 'center'. Within spec range of 18-24px.

  verdict: passed
  verdict_rationale: |
    All 8 must_pass checks passed. All 3 should_pass checks passed (by analysis).
    All 5 acceptance criteria (AC-F032-01 through AC-F032-05) satisfied.
    Reviewer approved with 0 issues. 2716/2716 tests passing.
    Edit button uses U+270F Pencil, Delete button uses U+1F5D1 Wastebasket.
    accessibilityLabel preserved for both buttons. Icon fontSize 20 with center alignment.
    No regressions detected.

  issues_for_coder: []


# #############################################################################
# CR-88: Add explanatory text to topics screen
# #############################################################################

cr_88:
  cr_id: CR-88
  title: "Na tela de temas adicionar texto explicando o que a tela faz"
  type: feature_request
  spec: specs/SPEC_F032_F034.yaml
  qa_plan: qa/QA_PLAN_batch6_phase2.yaml

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      Topics screen had no explanatory text. i18n system supports 3 locales.
      Follows same pattern as CR-80 (members description text).

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "2 of 2"
    commits:
      - hash: 98dbee2
        message: "feat(i18n): add topics.description and topics.noTopics keys in 3 locales (CR-88)"
      - hash: 8431360
        message: "feat(topics): add explanatory description text below header (CR-88)"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_suite_passed: 2716
    tester_suite_total: 2716

    must_pass_results:

      - id: MP-88-01
        description: "New i18n key for topics description exists in en.json"
        status: PASSED
        evidence: |
          en.json line 180: "description": "Create custom ward topics or activate predefined
          topic collections. Ward topics can be added, edited, and deleted. Activating a
          collection makes its topics available when assigning speeches. Deactivating removes
          them from the selection list."

      - id: MP-88-02
        description: "New i18n key for topics description exists in pt-BR.json"
        status: PASSED
        evidence: |
          pt-BR.json line 180: "description": "Crie temas customizados da ala ou ative colecoes
          de temas pre-definidos. Temas da ala podem ser adicionados, editados e excluidos.
          Ativar uma colecao torna seus temas disponiveis ao designar discursos. Desativar
          remove da lista de selecao."

      - id: MP-88-03
        description: "New i18n key for topics description exists in es.json"
        status: PASSED
        evidence: |
          es.json line 180: "description": "Cree temas personalizados del barrio o active
          colecciones de temas predefinidos. Los temas del barrio se pueden agregar, editar
          y eliminar. Activar una coleccion hace que sus temas esten disponibles al asignar
          discursos. Desactivar los elimina de la lista de seleccion."

      - id: MP-88-04
        description: "Topics screen renders the description text"
        status: PASSED
        evidence: |
          topics.tsx:383-385: Renders <Text style={[styles.description, { color: colors.textSecondary }]}>
          {t('topics.description')}</Text>. Positioned between the header (lines 372-380)
          and the Ward Topics section (line 388). Uses the t() i18n function.

      - id: MP-88-05
        description: "Description text explains collections activate/deactivate functionality"
        status: PASSED
        evidence: |
          EN: "Activating a collection makes its topics available when assigning speeches.
          Deactivating removes them from the selection list."
          PT: "Ativar uma colecao torna seus temas disponiveis ao designar discursos.
          Desativar remove da lista de selecao."
          ES: "Activar una coleccion hace que sus temas esten disponibles al asignar
          discursos. Desactivar los elimina de la lista de seleccion."
          All 3 locales explicitly explain activate/deactivate semantics.

      - id: MP-88-06
        description: "All three locale files have matching keys in topics section"
        status: PASSED
        evidence: |
          Verified via script: all 3 locale files have exactly 10 identical keys in the
          "topics" section: activateCollection, addTopic, collections, deactivateCollection,
          description, noTopics, title, topicLink, topicTitle, wardTopics.
          PARITY CHECK: PASS. 2 new keys added: description and noTopics.

      - id: MP-88-07
        description: "Existing test suite passes without regressions"
        status: PASSED
        evidence: |
          npx vitest run: 56 test files, 2716/2716 tests passed.
          Zero failures, zero skipped.

    must_pass_total: 7
    must_pass_passed: 7
    must_pass_failed: 0

    should_pass_results:

      - id: SP-88-01
        description: "Description text is styled consistently with members screen description"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:505-509: styles.description has fontSize: 13, textAlign: 'center',
          paddingHorizontal: 16, marginBottom: 8. Color is colors.textSecondary.
          This matches members.tsx styles.description exactly (fontSize 13, textAlign
          'center', paddingHorizontal 16, marginBottom 8).

      - id: SP-88-02
        description: "Description text is positioned logically on the screen"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:382-385: Text appears below the header (line 372-380) and above the
          Ward Topics section (line 388). This is between the screen title and the first
          functional section, same logical position as members.tsx description.

      - id: SP-88-03
        description: "Portuguese translation is natural Brazilian Portuguese"
        status: PASSED_BY_ANALYSIS
        evidence: |
          "Crie temas customizados da ala ou ative colecoes de temas pre-definidos."
          Natural pt-BR: "Crie" (imperative), "customizados" (commonly used in Brazilian
          Portuguese), "da ala" (specific LDS terminology), "designar discursos" (correct
          LDS speech assignment term in Portuguese).

      - id: SP-88-04
        description: "Spanish translation is natural Spanish"
        status: PASSED_BY_ANALYSIS
        evidence: |
          "Cree temas personalizados del barrio o active colecciones de temas predefinidos."
          Natural Spanish: "Cree" (formal imperative), "personalizados" (correct Spanish
          word), "del barrio" (LDS terminology), "asignar discursos" (correct assignment
          term in Spanish).

      - id: SP-88-05
        description: "Description text does not break layout on small screens"
        status: PASSED_BY_ANALYSIS
        evidence: |
          styles.description: fontSize 13, paddingHorizontal 16. No numberOfLines constraint,
          no fixed width. Text wraps naturally within the ScrollView. Small font size (13px)
          appropriate for secondary/helper text on mobile screens.

    should_pass_total: 5
    should_pass_passed: 5
    should_pass_failed: 0

  spec_compliance:
    acceptance_criteria:
      - id: AC-F033-01
        title: "Description text visible below header"
        status: SATISFIED
        evidence: "topics.tsx:383-385 renders t('topics.description') between header and Ward Topics section."

      - id: AC-F033-02
        title: "Description explains activate/deactivate functionality"
        status: SATISFIED
        evidence: "All 3 locales mention activating/deactivating collections and speech assignment availability."

      - id: AC-F033-03
        title: "i18n key exists in all 3 locales"
        status: SATISFIED
        evidence: "topics.description key present in en.json, pt-BR.json, es.json with correct translations."

      - id: AC-F033-04
        title: "Styling follows CR-80 pattern"
        status: SATISFIED
        evidence: "fontSize 13, textAlign center, paddingHorizontal 16, color textSecondary. Identical to members."

      - id: AC-F033-06
        title: "Locale files have matching key structure"
        status: SATISFIED
        evidence: "10 identical keys in topics section across all 3 locales. 0 removals, 2 additions."

  verdict: passed
  verdict_rationale: |
    All 7 must_pass checks passed. All 5 should_pass checks passed (by analysis).
    All 5 acceptance criteria satisfied. Reviewer approved with 0 issues.
    Description text added to topics screen between header and Ward Topics section.
    Text explains ward topics CRUD and collection activate/deactivate semantics.
    i18n keys added in all 3 locales (en, pt-BR, es) with natural translations.
    Styling matches CR-80 pattern exactly. Key parity verified: 10 keys across all locales.
    2716/2716 tests passing. No regressions.

  issues_for_coder: []


# #############################################################################
# CR-89: Show collection topics on click (read-only, expand/collapse)
# #############################################################################

cr_89:
  cr_id: CR-89
  title: "Ao clicar numa colecao, mostrar todos os temas (read-only, lista simples)"
  type: feature_request
  spec: specs/SPEC_F032_F034.yaml
  qa_plan: qa/QA_PLAN_batch6_phase2.yaml

  pre_validation:
    timestamp: "2026-02-18"
    status: passed
    summary: |
      CollectionRow was not tappable. No way to see topics in a collection.
      Data model supports it (general_topics.collection_id FK). Recommended
      expand/collapse inline accordion pattern.

  post_validation:
    timestamp: "2026-02-18"
    status: passed
    phase: "2 of 2"
    commits:
      - hash: 445f7b7
        message: "feat(hooks): add useCollectionTopics hook for lazy-loading collection topics (CR-89)"
      - hash: d2c9c0a
        message: "feat(topics): make CollectionRow tappable with chevron indicator (CR-89)"
      - hash: 9e41fec
        message: "feat(topics): add expand/collapse collection topics view with accordion pattern (CR-89)"

    reviewer_verdict: approved
    reviewer_issues: 0

    tester_verdict: approved
    tester_suite_passed: 2716
    tester_suite_total: 2716

    must_pass_results:

      - id: MP-89-01
        description: "Tapping a collection row shows the topics belonging to that collection"
        status: PASSED
        evidence: |
          topics.tsx:188-191: CollectionRow has a Pressable wrapper with onPress prop.
          topics.tsx:356-358: handleCollectionPress toggles expandedCollectionId state.
          topics.tsx:461-463: When expandedCollectionId === item.id, renders
          <CollectionTopicsList collectionId={item.id} colors={colors} />.
          CollectionTopicsList (lines 217-261) fetches and renders the collection topics.

      - id: MP-89-02
        description: "Topics displayed are fetched from general_topics table by collection_id"
        status: PASSED
        evidence: |
          useTopics.ts:232-247: useCollectionTopics hook queries supabase
          .from('general_topics').select('*').eq('collection_id', collectionId!)
          .order('title', { ascending: true }). Returns GeneralTopic[].
          Query key: topicKeys.collectionTopics(collectionId) at line 29-30.
          Enabled only when collectionId is truthy (line 245).

      - id: MP-89-03
        description: "Topic list is read-only (no edit/delete actions)"
        status: PASSED
        evidence: |
          topics.tsx:239-261: CollectionTopicsList renders topics using simple View and
          Text elements. No SwipeableCard, no Pressable with edit/delete handlers, no
          action buttons. Each topic is a View with Text for title and optional Text
          for link. The list is purely display-only.

      - id: MP-89-04
        description: "Each topic displays at least the title"
        status: PASSED
        evidence: |
          topics.tsx:249: <Text style={[styles.collectionTopicTitle, { color: colors.textSecondary }]}>
          {topic.title}</Text>. Title is always rendered for every topic in the list.
          Additionally, if topic.link exists, it is shown at line 252-255.

      - id: MP-89-05
        description: "Collection toggle (Switch) still works independently of tap-to-view"
        status: PASSED
        evidence: |
          topics.tsx:200-205: Switch is rendered OUTSIDE the Pressable area.
          CollectionRow structure: View > [Pressable (chevron + name), Switch].
          The Pressable wraps only the chevron and collection name (line 188-199),
          while the Switch (line 200-205) is a sibling at the same level.
          Switch onValueChange={onToggle} is independent of Pressable onPress.

      - id: MP-89-06
        description: "Tapping the same collection again hides/collapses the topic list"
        status: PASSED
        evidence: |
          topics.tsx:356-358: handleCollectionPress uses toggle logic:
          setExpandedCollectionId((prev) => (prev === collectionId ? null : collectionId)).
          If the same collection is tapped again, expandedCollectionId becomes null,
          which hides the CollectionTopicsList (conditional at line 461).

      - id: MP-89-07
        description: "Existing test suite passes without regressions"
        status: PASSED
        evidence: |
          npx vitest run: 56 test files, 2716/2716 tests passed.
          Zero failures, zero skipped.

    must_pass_total: 7
    must_pass_passed: 7
    must_pass_failed: 0

    should_pass_results:

      - id: SP-89-01
        description: "Topic list has appropriate styling (indented, secondary text color)"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:616-617: collectionTopicsContainer has paddingLeft: 32, paddingRight: 16.
          topics.tsx:620-623: collectionTopicItem has paddingVertical: 8, paddingLeft: 8.
          topics.tsx:624-625: collectionTopicTitle uses fontSize: 14, color: colors.textSecondary.
          Topics are visually nested under the collection row with larger left padding.

      - id: SP-89-02
        description: "Topic link is shown if available"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:252-255: Conditional rendering {topic.link && (<Text style={[
          styles.collectionTopicLink, { color: colors.primary }]} numberOfLines={1}>
          {topic.link}</Text>)}. Link shown in primary color with fontSize 12 and marginTop 2.

      - id: SP-89-03
        description: "Loading state is handled while fetching topics"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:221-227: When isLoading is true, renders:
          <View style={styles.collectionTopicsLoading}>
            <ActivityIndicator size="small" color={colors.primary} />
          </View>
          Loading style: paddingVertical 16, alignItems center (lines 631-634).

      - id: SP-89-04
        description: "Empty state is handled if collection has no topics"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:229-236: When topics is null or empty, renders:
          <Text style={[styles.collectionTopicsEmptyText, { color: colors.textSecondary }]}>
            {t('topics.noTopics')}
          </Text>
          en.json: "No topics in this collection", pt-BR: "Nenhum tema nesta colecao",
          es: "No hay temas en esta coleccion". Styled with fontSize 13, fontStyle italic.

      - id: SP-89-05
        description: "Only one collection can be expanded at a time (accordion pattern)"
        status: PASSED_BY_ANALYSIS
        evidence: |
          topics.tsx:276: expandedCollectionId is a single string|null state.
          topics.tsx:357: handleCollectionPress sets expandedCollectionId to the tapped
          collection's ID or null (toggle). Since only one ID is stored, expanding a
          new collection automatically collapses the previous one (accordion behavior).

    should_pass_total: 5
    should_pass_passed: 5
    should_pass_failed: 0

  spec_compliance:
    acceptance_criteria:
      - id: AC-F034-01
        title: "Tapping collection shows its topics"
        status: SATISFIED
        evidence: "CollectionRow Pressable + handleCollectionPress + CollectionTopicsList renders topics."

      - id: AC-F034-02
        title: "Tapping again collapses the topic list"
        status: SATISFIED
        evidence: "Toggle logic: prev === collectionId ? null : collectionId."

      - id: AC-F034-03
        title: "Topics fetched from general_topics by collection_id"
        status: SATISFIED
        evidence: "useCollectionTopics hook: supabase.from('general_topics').select('*').eq('collection_id', id).order('title')."

      - id: AC-F034-04
        title: "Loading state shown while fetching"
        status: SATISFIED
        evidence: "ActivityIndicator rendered when isLoading is true."

      - id: AC-F034-05
        title: "Empty state shown when no topics"
        status: SATISFIED
        evidence: "t('topics.noTopics') rendered when topics array is empty."

      - id: AC-F034-06
        title: "Switch toggle works independently of tap"
        status: SATISFIED
        evidence: "Switch is sibling to Pressable, not nested inside it. Events are independent."

      - id: AC-F034-07
        title: "Accordion pattern (one expanded at a time)"
        status: SATISFIED
        evidence: "Single expandedCollectionId state variable enforces one-at-a-time expansion."

      - id: AC-F034-08
        title: "Topic list styled as nested, read-only"
        status: SATISFIED
        evidence: "paddingLeft 32, textSecondary color, no SwipeableCard, no action buttons."

  verdict: passed
  verdict_rationale: |
    All 7 must_pass checks passed. All 5 should_pass checks passed (by analysis).
    All 8 acceptance criteria (AC-F034-01 through AC-F034-08) satisfied.
    Reviewer approved with 0 issues. 2716/2716 tests passing.
    New useCollectionTopics hook added for lazy-loading collection topics by ID.
    CollectionRow made tappable with Pressable wrapper and chevron indicator.
    Expand/collapse accordion pattern implemented with single expandedCollectionId state.
    Switch toggle independent of tap (sibling elements, not nested).
    Topics rendered read-only with title and optional link. Loading and empty states handled.
    No regressions detected.

  issues_for_coder: []